CREATE TABLE usuarios (
    id SERIAL PRIMARY KEY,
    nome TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    senha TEXT NOT NULL,
    pk_kyber TEXT,
    pk_dilithium TEXT,
    ultimo_login TIMESTAMP,
    criado_em TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE arquivos (
    id SERIAL PRIMARY KEY,
    usuario_id INT NOT NULL REFERENCES usuarios(id) ON DELETE CASCADE,
    nome_arquivo TEXT NOT NULL,
    conteudo BYTEA NOT NULL,
    tamanho BIGINT NOT NULL,
    nonce BYTEA NOT NULL,
    criado_em TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE compartilhamentos (
    id SERIAL PRIMARY KEY,
    arquivo_id INT NOT NULL REFERENCES arquivos(id) ON DELETE CASCADE,
    sender_id INT NOT NULL REFERENCES usuarios(id) ON DELETE CASCADE,
    receiver_id INT NOT NULL REFERENCES usuarios(id) ON DELETE CASCADE,
    chave_encrypted TEXT NOT NULL,
    assinatura TEXT,
    criado_em TIMESTAMPTZ DEFAULT NOW(),
    status TEXT
);
CREATE INDEX idx_compartilhamentos_receiver ON compartilhamentos(receiver_id);
CREATE INDEX idx_compartilhamentos_sender ON compartilhamentos(sender_id);

-- Usu√°rios de teste
insert into usuarios (nome, email, senha, pk_kyber, pk_dilithium) values ('alice', 'alice@example.com', 'alice123', 'rTK2CrWUn1KtNvNiT-Ih2CElpoqSbUpUxGajmUtqssIeqrXP05u2Ksch_bUIrCMlKtJaOFeWPuS0nwtHcTF5chmZ2ede70PDV6hoCSTPPta482yy_UtdWmF2i8APECurZehOtOmNAquEbSRLnJhvyomtryU3q-OT1gJWYTgYr9yjghALZsR7AVYozwDI0iJpzSUecmolbmsHrtug6efNTnV-zKkeYslSmbe7uwKPquK7EPd7R_Z6x7izeNUTD6rKqwxDPQgFe5MMUAaRzKOt9vtKOHag5lJeRahJkpd2t9ENAjRszShS_Qu-elgQGFFhjiZ-U4CBlBwGg6dgyBszLJZPl2yDkIrLMAJDsVmCxhEz0lusYzVOyBYFw5HDIKOAK2yprxqZ9MF-HaqFR5ldB5O_xCAbtLROzWW9FwOAr5XGh-Br-Vp6fiGf2keJT8LMoSTLiLl8qfi__bJaFqeGRXcBYeG_HaOzs9eD2nyNCAmBQGssK4wN0hKyj_ORAWmGeSUIXViFwzkWVkusEMKOfqkoknoUrYay0sUtt5QKWmkwxVQNAkCplhI6W2xnXxXHhjQx52lvVsjOf7jIgtOVp4keJghNIDBjBtMZMYBas1wwS5VkHyLJMPozH5IwNMEI8ya2RoePNDm5_-aHX8QYFex83ezIk-yHKIiPzxKjGyopGik7d0oiFmaU2_h7WWAOHoXPArKzfYdiXMVf01tFiCqeOHJ8vQoj4gO7EdFLWOpswBpIIcR_KQjCrWBeTAoZGhMbGyKy8ooGGwlmpPCeb0IGeWIq5iAw41bLJOc7KVkbHFiOSBpz3MnA9UW9-8C60IF719dq9Ly_7jQTYJMyLYPHVXxCVeqvqJOZ_ydS2OQK-fdHMwFkIRaiQZFdbYt0jHO6Plab9oiLh4NrTYNLO0snR2u6e_QRwavEb3OOtVzKX2CslLivAnLHfNUoBXJiiUFy8aZqt8HJbTjGZCW5PMpZbsw5bKQaPREfP1EBBfh9cyfKBnJ6yQhZMiYDyMUnsyCAzpZLpQpO7cuHIet6lxGg6YifceY3cOHLs0EU5VlaOtaZ4vDF3WN6a2hr8ko6PvpWK3vFFfLL6dGS_OIZo2pnOEs3T5sISGSpFlcSBSMQCsVItVXD6YBOhYqFgHpaB-ZloSc5yzsZWJcqSXg8aYgpz0iWQSkKxped14gHf0tdlkunLYEeM0yrUtezV8Yq7bM72jJj0ji9rQd-gyB1ZgQRWnGhHjZ5wKRAVQGhQMI8hDQMeDka7bNyW_Bqw-tUZkIwLnw_ZWIqbbnFLkpvqhmnEAqSqqKvSMeCqoikG3aJPcnHvmCjTGApIucQIjAo-FloaOEI-5kNToFgK2kL8sMl7Wx49BChIOuPvfXJrJltFhh8w3m2fMSAK7t9h5Vrzom6W8qdPiGqUdZIq8kIZfSp5vfBakE5fiJRJPfN5eBGBfpqC8Jvbyh7bECjHdtxqRJmkas-ccdOqaBkzIkRNqfL3CwHl9KTAEYsGiy3mvKG6xDDMdBUvVWcyjqafuBe59mbNjU2bF27J3_uKy5cdEFWFymwFkfKyT402NUdGA0', 'IvVdJR-0TmahOuGjzGmELttd0thwP38Yzdqae76-h_3gY-YrDd9PhbirrxLW8NFF4TdeDx2QHVhVFRqOYJjzfqN_PXAl3wH963XOa9NfwBPBytzeEXcjbXbu7TStch1wUXzqv3G2NEAwpTR2dlCPemraci7n67if3rTnmZXuN1HlU_Ief41lrVfqi4ed5sLSM2iUxA2JNJ9P6w6hFZnpOUnbSusvB2lRpUW9u_dN3iSgoGDEy5Mql0bYhYDZsOfEZ5UqhmhyLwj_zEa6MqQ_QkgMusywXUdu93dgtkK5C_uxNRR4YIlS22UOy6ZMIVYaCqDCwxu3K4SALoHpEAgV-PU8vaDTSoTWZ5yKeZNZbKx8IKyyK0kada0XD8cGMF0aWgB64sfwz5A-lcCeslB3C3fxQfKaeF4XgHhD-Hp042Kmouvo2q5XvK57heWosbUnbj2y-ZEW8dD0fn7FF7HfX5sqzxCykh7AiQDvduhFOuq6ZvPd-T9nPtkudIyR-mdc0mfSNI6dAntABXoMDXcK_ym4NxGnkSBV8_eWFNA1QaZe8y1hILXwNpiyE1nIU0VhmGgVs_W6oq1Qx_1COtb8PeEqETT2cEO-ZSbLG-UywYwsa3B4IsLO4NRqo5f0q7s-4xf5-tKlBaZKNHDyBwp7_rFRHFDYNQfa2nsnPQIbV_LuLOccV70AGUV6qn5VgOIblvReeKRt3e_eQdZhNIL68Lo0iAX3dua8nnVlpQ66cmf-ifmAd2j8sqX4QfJ5M29Wt-Z8W0tgkjBNFESNSQa65gRbhTgs8gjaTttsiZXhznM6tCelEweuKSGgUIpv3Jw4B6zoMCgGEBNQ5SbsJiYX9o2in-Wv2k3UelAn7JaMwEVQ5N0iWbKRURBcWFV8NeC7Rfnp11jClTW5WUBDaW0DuyEaKl1t6imFo0YNzmksuWnRpSmAMWc35eb0XkNjGzf9Q31kU-AgVT2C2Hvw80OrB6M4txFzg0U8qvI3XU2Jmfa3XG-y81SGEqMgAD6W6nEWnikjs3h8bBU0lVfPZVjp4fysL129jMj7M1GneaUL61-y7RjlaMaE8_vRNpx3CEghrdcEuht8ipOnxC6X0Ohbg6k-gWnSRcLreoQ1gmS7S2cK3AhLTEAMPCKa3Yb51kGtjP0RU8aMqFCQyGpJ7vggQlvN0XjycxitMMVpYoIzA0KppqaJ57daFjl7a30vSp7RMqiEyU2PBIrtNm1Z3XbvgWaHUeEttHyUJpT22OVJWUe6oTGT6OmOzCzBJ5CnMNChNsmOgpLNOJ5BNLfxj16ndx-sp0zIYZThGy7dfhUwDYUReHeo-3wMtAapeDkYVlt1IGlqmRr0TnTPUiHqY8nB9sdCIMOgcPpD1aBwD4RyTPzBrW6h0ewMt5r5dCYgoXm-z-W7NcplhzjgLslHAEPsoJjx1jTiasEQP1h1IOOP8CR1SXT8Kwgs5aCSAnU4vPbTqe_CZR5eD1UaVm7Dw2hzv4r7LN5a5MZ1yvdeugFNcWpijXRD5ksAdTgTGnt2b3tQMu0GMmBwOlmGpS4Hns5Bx61iqkzZXojGbL2PZf7NLzzyrwrZRqii8OopPKLIKk4QHd-Ddma5nOSqpANaR3CM4l1xPvVc86lLicoBgxy2dJUSi-QiEqUJCG3DJvPbv-JcZS9ryw9Ap9tbeMkkT2CBu5vspsBVDGWGZY8BCmqgNsUHHg00CHwq5HBK0dT30M8_EZmSL_yuu_S47MuCCRoFIbncUEIZYrYUs0kawqcVJDpu2HtfpTBY3tQ6EIb3mMhsvBjyDNAvpQnY57K9h6L7CMguiJFeOTqKBWVvZ8pSOo3ifmMrmtTGy1BWjTfiX4ZOofMEZ_BLUj1h60ABMwycbC7QUtkoD_i0Eub3xZD4-W0OH_sGAJH25R97D-u9gk1dWF3Nj2YAGJ0BQwDH5sCRCX6u44IgOHvb-UKLlhSaN4o');
insert into usuarios (nome, email, senha, pk_kyber, pk_dilithium) values ('bob', 'bob@example.com', 'bob123', 'rTK2CrWUn1KtNvNiT-Ih2CElpoqSbUpUxGajmUtqssIeqrXP05u2Ksch_bUIrCMlKtJaOFeWPuS0nwtHcTF5chmZ2ede70PDV6hoCSTPPta482yy_UtdWmF2i8APECurZehOtOmNAquEbSRLnJhvyomtryU3q-OT1gJWYTgYr9yjghALZsR7AVYozwDI0iJpzSUecmolbmsHrtug6efNTnV-zKkeYslSmbe7uwKPquK7EPd7R_Z6x7izeNUTD6rKqwxDPQgFe5MMUAaRzKOt9vtKOHag5lJeRahJkpd2t9ENAjRszShS_Qu-elgQGFFhjiZ-U4CBlBwGg6dgyBszLJZPl2yDkIrLMAJDsVmCxhEz0lusYzVOyBYFw5HDIKOAK2yprxqZ9MF-HaqFR5ldB5O_xCAbtLROzWW9FwOAr5XGh-Br-Vp6fiGf2keJT8LMoSTLiLl8qfi__bJaFqeGRXcBYeG_HaOzs9eD2nyNCAmBQGssK4wN0hKyj_ORAWmGeSUIXViFwzkWVkusEMKOfqkoknoUrYay0sUtt5QKWmkwxVQNAkCplhI6W2xnXxXHhjQx52lvVsjOf7jIgtOVp4keJghNIDBjBtMZMYBas1wwS5VkHyLJMPozH5IwNMEI8ya2RoePNDm5_-aHX8QYFex83ezIk-yHKIiPzxKjGyopGik7d0oiFmaU2_h7WWAOHoXPArKzfYdiXMVf01tFiCqeOHJ8vQoj4gO7EdFLWOpswBpIIcR_KQjCrWBeTAoZGhMbGyKy8ooGGwlmpPCeb0IGeWIq5iAw41bLJOc7KVkbHFiOSBpz3MnA9UW9-8C60IF719dq9Ly_7jQTYJMyLYPHVXxCVeqvqJOZ_ydS2OQK-fdHMwFkIRaiQZFdbYt0jHO6Plab9oiLh4NrTYNLO0snR2u6e_QRwavEb3OOtVzKX2CslLivAnLHfNUoBXJiiUFy8aZqt8HJbTjGZCW5PMpZbsw5bKQaPREfP1EBBfh9cyfKBnJ6yQhZMiYDyMUnsyCAzpZLpQpO7cuHIet6lxGg6YifceY3cOHLs0EU5VlaOtaZ4vDF3WN6a2hr8ko6PvpWK3vFFfLL6dGS_OIZo2pnOEs3T5sISGSpFlcSBSMQCsVItVXD6YBOhYqFgHpaB-ZloSc5yzsZWJcqSXg8aYgpz0iWQSkKxped14gHf0tdlkunLYEeM0yrUtezV8Yq7bM72jJj0ji9rQd-gyB1ZgQRWnGhHjZ5wKRAVQGhQMI8hDQMeDka7bNyW_Bqw-tUZkIwLnw_ZWIqbbnFLkpvqhmnEAqSqqKvSMeCqoikG3aJPcnHvmCjTGApIucQIjAo-FloaOEI-5kNToFgK2kL8sMl7Wx49BChIOuPvfXJrJltFhh8w3m2fMSAK7t9h5Vrzom6W8qdPiGqUdZIq8kIZfSp5vfBakE5fiJRJPfN5eBGBfpqC8Jvbyh7bECjHdtxqRJmkas-ccdOqaBkzIkRNqfL3CwHl9KTAEYsGiy3mvKG6xDDMdBUvVWcyjqafuBe59mbNjU2bF27J3_uKy5cdEFWFymwFkfKyT402NUdGA0', 'IvVdJR-0TmahOuGjzGmELttd0thwP38Yzdqae76-h_3gY-YrDd9PhbirrxLW8NFF4TdeDx2QHVhVFRqOYJjzfqN_PXAl3wH963XOa9NfwBPBytzeEXcjbXbu7TStch1wUXzqv3G2NEAwpTR2dlCPemraci7n67if3rTnmZXuN1HlU_Ief41lrVfqi4ed5sLSM2iUxA2JNJ9P6w6hFZnpOUnbSusvB2lRpUW9u_dN3iSgoGDEy5Mql0bYhYDZsOfEZ5UqhmhyLwj_zEa6MqQ_QkgMusywXUdu93dgtkK5C_uxNRR4YIlS22UOy6ZMIVYaCqDCwxu3K4SALoHpEAgV-PU8vaDTSoTWZ5yKeZNZbKx8IKyyK0kada0XD8cGMF0aWgB64sfwz5A-lcCeslB3C3fxQfKaeF4XgHhD-Hp042Kmouvo2q5XvK57heWosbUnbj2y-ZEW8dD0fn7FF7HfX5sqzxCykh7AiQDvduhFOuq6ZvPd-T9nPtkudIyR-mdc0mfSNI6dAntABXoMDXcK_ym4NxGnkSBV8_eWFNA1QaZe8y1hILXwNpiyE1nIU0VhmGgVs_W6oq1Qx_1COtb8PeEqETT2cEO-ZSbLG-UywYwsa3B4IsLO4NRqo5f0q7s-4xf5-tKlBaZKNHDyBwp7_rFRHFDYNQfa2nsnPQIbV_LuLOccV70AGUV6qn5VgOIblvReeKRt3e_eQdZhNIL68Lo0iAX3dua8nnVlpQ66cmf-ifmAd2j8sqX4QfJ5M29Wt-Z8W0tgkjBNFESNSQa65gRbhTgs8gjaTttsiZXhznM6tCelEweuKSGgUIpv3Jw4B6zoMCgGEBNQ5SbsJiYX9o2in-Wv2k3UelAn7JaMwEVQ5N0iWbKRURBcWFV8NeC7Rfnp11jClTW5WUBDaW0DuyEaKl1t6imFo0YNzmksuWnRpSmAMWc35eb0XkNjGzf9Q31kU-AgVT2C2Hvw80OrB6M4txFzg0U8qvI3XU2Jmfa3XG-y81SGEqMgAD6W6nEWnikjs3h8bBU0lVfPZVjp4fysL129jMj7M1GneaUL61-y7RjlaMaE8_vRNpx3CEghrdcEuht8ipOnxC6X0Ohbg6k-gWnSRcLreoQ1gmS7S2cK3AhLTEAMPCKa3Yb51kGtjP0RU8aMqFCQyGpJ7vggQlvN0XjycxitMMVpYoIzA0KppqaJ57daFjl7a30vSp7RMqiEyU2PBIrtNm1Z3XbvgWaHUeEttHyUJpT22OVJWUe6oTGT6OmOzCzBJ5CnMNChNsmOgpLNOJ5BNLfxj16ndx-sp0zIYZThGy7dfhUwDYUReHeo-3wMtAapeDkYVlt1IGlqmRr0TnTPUiHqY8nB9sdCIMOgcPpD1aBwD4RyTPzBrW6h0ewMt5r5dCYgoXm-z-W7NcplhzjgLslHAEPsoJjx1jTiasEQP1h1IOOP8CR1SXT8Kwgs5aCSAnU4vPbTqe_CZR5eD1UaVm7Dw2hzv4r7LN5a5MZ1yvdeugFNcWpijXRD5ksAdTgTGnt2b3tQMu0GMmBwOlmGpS4Hns5Bx61iqkzZXojGbL2PZf7NLzzyrwrZRqii8OopPKLIKk4QHd-Ddma5nOSqpANaR3CM4l1xPvVc86lLicoBgxy2dJUSi-QiEqUJCG3DJvPbv-JcZS9ryw9Ap9tbeMkkT2CBu5vspsBVDGWGZY8BCmqgNsUHHg00CHwq5HBK0dT30M8_EZmSL_yuu_S47MuCCRoFIbncUEIZYrYUs0kawqcVJDpu2HtfpTBY3tQ6EIb3mMhsvBjyDNAvpQnY57K9h6L7CMguiJFeOTqKBWVvZ8pSOo3ifmMrmtTGy1BWjTfiX4ZOofMEZ_BLUj1h60ABMwycbC7QUtkoD_i0Eub3xZD4-W0OH_sGAJH25R97D-u9gk1dWF3Nj2YAGJ0BQwDH5sCRCX6u44IgOHvb-UKLlhSaN4o');