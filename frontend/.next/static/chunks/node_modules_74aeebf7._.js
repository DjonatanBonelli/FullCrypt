(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/node_modules/next/dist/compiled/buffer/index.js [app-client] (ecmascript)", ((__turbopack_context__, module, exports) => {

(function() {
    var e = {
        675: function(e, r) {
            "use strict";
            r.byteLength = byteLength;
            r.toByteArray = toByteArray;
            r.fromByteArray = fromByteArray;
            var t = [];
            var f = [];
            var n = typeof Uint8Array !== "undefined" ? Uint8Array : Array;
            var i = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
            for(var o = 0, u = i.length; o < u; ++o){
                t[o] = i[o];
                f[i.charCodeAt(o)] = o;
            }
            f["-".charCodeAt(0)] = 62;
            f["_".charCodeAt(0)] = 63;
            function getLens(e) {
                var r = e.length;
                if (r % 4 > 0) {
                    throw new Error("Invalid string. Length must be a multiple of 4");
                }
                var t = e.indexOf("=");
                if (t === -1) t = r;
                var f = t === r ? 0 : 4 - t % 4;
                return [
                    t,
                    f
                ];
            }
            function byteLength(e) {
                var r = getLens(e);
                var t = r[0];
                var f = r[1];
                return (t + f) * 3 / 4 - f;
            }
            function _byteLength(e, r, t) {
                return (r + t) * 3 / 4 - t;
            }
            function toByteArray(e) {
                var r;
                var t = getLens(e);
                var i = t[0];
                var o = t[1];
                var u = new n(_byteLength(e, i, o));
                var a = 0;
                var s = o > 0 ? i - 4 : i;
                var h;
                for(h = 0; h < s; h += 4){
                    r = f[e.charCodeAt(h)] << 18 | f[e.charCodeAt(h + 1)] << 12 | f[e.charCodeAt(h + 2)] << 6 | f[e.charCodeAt(h + 3)];
                    u[a++] = r >> 16 & 255;
                    u[a++] = r >> 8 & 255;
                    u[a++] = r & 255;
                }
                if (o === 2) {
                    r = f[e.charCodeAt(h)] << 2 | f[e.charCodeAt(h + 1)] >> 4;
                    u[a++] = r & 255;
                }
                if (o === 1) {
                    r = f[e.charCodeAt(h)] << 10 | f[e.charCodeAt(h + 1)] << 4 | f[e.charCodeAt(h + 2)] >> 2;
                    u[a++] = r >> 8 & 255;
                    u[a++] = r & 255;
                }
                return u;
            }
            function tripletToBase64(e) {
                return t[e >> 18 & 63] + t[e >> 12 & 63] + t[e >> 6 & 63] + t[e & 63];
            }
            function encodeChunk(e, r, t) {
                var f;
                var n = [];
                for(var i = r; i < t; i += 3){
                    f = (e[i] << 16 & 16711680) + (e[i + 1] << 8 & 65280) + (e[i + 2] & 255);
                    n.push(tripletToBase64(f));
                }
                return n.join("");
            }
            function fromByteArray(e) {
                var r;
                var f = e.length;
                var n = f % 3;
                var i = [];
                var o = 16383;
                for(var u = 0, a = f - n; u < a; u += o){
                    i.push(encodeChunk(e, u, u + o > a ? a : u + o));
                }
                if (n === 1) {
                    r = e[f - 1];
                    i.push(t[r >> 2] + t[r << 4 & 63] + "==");
                } else if (n === 2) {
                    r = (e[f - 2] << 8) + e[f - 1];
                    i.push(t[r >> 10] + t[r >> 4 & 63] + t[r << 2 & 63] + "=");
                }
                return i.join("");
            }
        },
        72: function(e, r, t) {
            "use strict";
            /*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */ var f = t(675);
            var n = t(783);
            var i = typeof Symbol === "function" && typeof Symbol.for === "function" ? Symbol.for("nodejs.util.inspect.custom") : null;
            r.Buffer = Buffer;
            r.SlowBuffer = SlowBuffer;
            r.INSPECT_MAX_BYTES = 50;
            var o = 2147483647;
            r.kMaxLength = o;
            Buffer.TYPED_ARRAY_SUPPORT = typedArraySupport();
            if (!Buffer.TYPED_ARRAY_SUPPORT && typeof console !== "undefined" && typeof console.error === "function") {
                console.error("This browser lacks typed array (Uint8Array) support which is required by " + "`buffer` v5.x. Use `buffer` v4.x if you require old browser support.");
            }
            function typedArraySupport() {
                try {
                    var e = new Uint8Array(1);
                    var r = {
                        foo: function() {
                            return 42;
                        }
                    };
                    Object.setPrototypeOf(r, Uint8Array.prototype);
                    Object.setPrototypeOf(e, r);
                    return e.foo() === 42;
                } catch (e) {
                    return false;
                }
            }
            Object.defineProperty(Buffer.prototype, "parent", {
                enumerable: true,
                get: function() {
                    if (!Buffer.isBuffer(this)) return undefined;
                    return this.buffer;
                }
            });
            Object.defineProperty(Buffer.prototype, "offset", {
                enumerable: true,
                get: function() {
                    if (!Buffer.isBuffer(this)) return undefined;
                    return this.byteOffset;
                }
            });
            function createBuffer(e) {
                if (e > o) {
                    throw new RangeError('The value "' + e + '" is invalid for option "size"');
                }
                var r = new Uint8Array(e);
                Object.setPrototypeOf(r, Buffer.prototype);
                return r;
            }
            function Buffer(e, r, t) {
                if (typeof e === "number") {
                    if (typeof r === "string") {
                        throw new TypeError('The "string" argument must be of type string. Received type number');
                    }
                    return allocUnsafe(e);
                }
                return from(e, r, t);
            }
            Buffer.poolSize = 8192;
            function from(e, r, t) {
                if (typeof e === "string") {
                    return fromString(e, r);
                }
                if (ArrayBuffer.isView(e)) {
                    return fromArrayLike(e);
                }
                if (e == null) {
                    throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, " + "or Array-like Object. Received type " + typeof e);
                }
                if (isInstance(e, ArrayBuffer) || e && isInstance(e.buffer, ArrayBuffer)) {
                    return fromArrayBuffer(e, r, t);
                }
                if (typeof SharedArrayBuffer !== "undefined" && (isInstance(e, SharedArrayBuffer) || e && isInstance(e.buffer, SharedArrayBuffer))) {
                    return fromArrayBuffer(e, r, t);
                }
                if (typeof e === "number") {
                    throw new TypeError('The "value" argument must not be of type number. Received type number');
                }
                var f = e.valueOf && e.valueOf();
                if (f != null && f !== e) {
                    return Buffer.from(f, r, t);
                }
                var n = fromObject(e);
                if (n) return n;
                if (typeof Symbol !== "undefined" && Symbol.toPrimitive != null && typeof e[Symbol.toPrimitive] === "function") {
                    return Buffer.from(e[Symbol.toPrimitive]("string"), r, t);
                }
                throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, " + "or Array-like Object. Received type " + typeof e);
            }
            Buffer.from = function(e, r, t) {
                return from(e, r, t);
            };
            Object.setPrototypeOf(Buffer.prototype, Uint8Array.prototype);
            Object.setPrototypeOf(Buffer, Uint8Array);
            function assertSize(e) {
                if (typeof e !== "number") {
                    throw new TypeError('"size" argument must be of type number');
                } else if (e < 0) {
                    throw new RangeError('The value "' + e + '" is invalid for option "size"');
                }
            }
            function alloc(e, r, t) {
                assertSize(e);
                if (e <= 0) {
                    return createBuffer(e);
                }
                if (r !== undefined) {
                    return typeof t === "string" ? createBuffer(e).fill(r, t) : createBuffer(e).fill(r);
                }
                return createBuffer(e);
            }
            Buffer.alloc = function(e, r, t) {
                return alloc(e, r, t);
            };
            function allocUnsafe(e) {
                assertSize(e);
                return createBuffer(e < 0 ? 0 : checked(e) | 0);
            }
            Buffer.allocUnsafe = function(e) {
                return allocUnsafe(e);
            };
            Buffer.allocUnsafeSlow = function(e) {
                return allocUnsafe(e);
            };
            function fromString(e, r) {
                if (typeof r !== "string" || r === "") {
                    r = "utf8";
                }
                if (!Buffer.isEncoding(r)) {
                    throw new TypeError("Unknown encoding: " + r);
                }
                var t = byteLength(e, r) | 0;
                var f = createBuffer(t);
                var n = f.write(e, r);
                if (n !== t) {
                    f = f.slice(0, n);
                }
                return f;
            }
            function fromArrayLike(e) {
                var r = e.length < 0 ? 0 : checked(e.length) | 0;
                var t = createBuffer(r);
                for(var f = 0; f < r; f += 1){
                    t[f] = e[f] & 255;
                }
                return t;
            }
            function fromArrayBuffer(e, r, t) {
                if (r < 0 || e.byteLength < r) {
                    throw new RangeError('"offset" is outside of buffer bounds');
                }
                if (e.byteLength < r + (t || 0)) {
                    throw new RangeError('"length" is outside of buffer bounds');
                }
                var f;
                if (r === undefined && t === undefined) {
                    f = new Uint8Array(e);
                } else if (t === undefined) {
                    f = new Uint8Array(e, r);
                } else {
                    f = new Uint8Array(e, r, t);
                }
                Object.setPrototypeOf(f, Buffer.prototype);
                return f;
            }
            function fromObject(e) {
                if (Buffer.isBuffer(e)) {
                    var r = checked(e.length) | 0;
                    var t = createBuffer(r);
                    if (t.length === 0) {
                        return t;
                    }
                    e.copy(t, 0, 0, r);
                    return t;
                }
                if (e.length !== undefined) {
                    if (typeof e.length !== "number" || numberIsNaN(e.length)) {
                        return createBuffer(0);
                    }
                    return fromArrayLike(e);
                }
                if (e.type === "Buffer" && Array.isArray(e.data)) {
                    return fromArrayLike(e.data);
                }
            }
            function checked(e) {
                if (e >= o) {
                    throw new RangeError("Attempt to allocate Buffer larger than maximum " + "size: 0x" + o.toString(16) + " bytes");
                }
                return e | 0;
            }
            function SlowBuffer(e) {
                if (+e != e) {
                    e = 0;
                }
                return Buffer.alloc(+e);
            }
            Buffer.isBuffer = function isBuffer(e) {
                return e != null && e._isBuffer === true && e !== Buffer.prototype;
            };
            Buffer.compare = function compare(e, r) {
                if (isInstance(e, Uint8Array)) e = Buffer.from(e, e.offset, e.byteLength);
                if (isInstance(r, Uint8Array)) r = Buffer.from(r, r.offset, r.byteLength);
                if (!Buffer.isBuffer(e) || !Buffer.isBuffer(r)) {
                    throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');
                }
                if (e === r) return 0;
                var t = e.length;
                var f = r.length;
                for(var n = 0, i = Math.min(t, f); n < i; ++n){
                    if (e[n] !== r[n]) {
                        t = e[n];
                        f = r[n];
                        break;
                    }
                }
                if (t < f) return -1;
                if (f < t) return 1;
                return 0;
            };
            Buffer.isEncoding = function isEncoding(e) {
                switch(String(e).toLowerCase()){
                    case "hex":
                    case "utf8":
                    case "utf-8":
                    case "ascii":
                    case "latin1":
                    case "binary":
                    case "base64":
                    case "ucs2":
                    case "ucs-2":
                    case "utf16le":
                    case "utf-16le":
                        return true;
                    default:
                        return false;
                }
            };
            Buffer.concat = function concat(e, r) {
                if (!Array.isArray(e)) {
                    throw new TypeError('"list" argument must be an Array of Buffers');
                }
                if (e.length === 0) {
                    return Buffer.alloc(0);
                }
                var t;
                if (r === undefined) {
                    r = 0;
                    for(t = 0; t < e.length; ++t){
                        r += e[t].length;
                    }
                }
                var f = Buffer.allocUnsafe(r);
                var n = 0;
                for(t = 0; t < e.length; ++t){
                    var i = e[t];
                    if (isInstance(i, Uint8Array)) {
                        i = Buffer.from(i);
                    }
                    if (!Buffer.isBuffer(i)) {
                        throw new TypeError('"list" argument must be an Array of Buffers');
                    }
                    i.copy(f, n);
                    n += i.length;
                }
                return f;
            };
            function byteLength(e, r) {
                if (Buffer.isBuffer(e)) {
                    return e.length;
                }
                if (ArrayBuffer.isView(e) || isInstance(e, ArrayBuffer)) {
                    return e.byteLength;
                }
                if (typeof e !== "string") {
                    throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. ' + "Received type " + typeof e);
                }
                var t = e.length;
                var f = arguments.length > 2 && arguments[2] === true;
                if (!f && t === 0) return 0;
                var n = false;
                for(;;){
                    switch(r){
                        case "ascii":
                        case "latin1":
                        case "binary":
                            return t;
                        case "utf8":
                        case "utf-8":
                            return utf8ToBytes(e).length;
                        case "ucs2":
                        case "ucs-2":
                        case "utf16le":
                        case "utf-16le":
                            return t * 2;
                        case "hex":
                            return t >>> 1;
                        case "base64":
                            return base64ToBytes(e).length;
                        default:
                            if (n) {
                                return f ? -1 : utf8ToBytes(e).length;
                            }
                            r = ("" + r).toLowerCase();
                            n = true;
                    }
                }
            }
            Buffer.byteLength = byteLength;
            function slowToString(e, r, t) {
                var f = false;
                if (r === undefined || r < 0) {
                    r = 0;
                }
                if (r > this.length) {
                    return "";
                }
                if (t === undefined || t > this.length) {
                    t = this.length;
                }
                if (t <= 0) {
                    return "";
                }
                t >>>= 0;
                r >>>= 0;
                if (t <= r) {
                    return "";
                }
                if (!e) e = "utf8";
                while(true){
                    switch(e){
                        case "hex":
                            return hexSlice(this, r, t);
                        case "utf8":
                        case "utf-8":
                            return utf8Slice(this, r, t);
                        case "ascii":
                            return asciiSlice(this, r, t);
                        case "latin1":
                        case "binary":
                            return latin1Slice(this, r, t);
                        case "base64":
                            return base64Slice(this, r, t);
                        case "ucs2":
                        case "ucs-2":
                        case "utf16le":
                        case "utf-16le":
                            return utf16leSlice(this, r, t);
                        default:
                            if (f) throw new TypeError("Unknown encoding: " + e);
                            e = (e + "").toLowerCase();
                            f = true;
                    }
                }
            }
            Buffer.prototype._isBuffer = true;
            function swap(e, r, t) {
                var f = e[r];
                e[r] = e[t];
                e[t] = f;
            }
            Buffer.prototype.swap16 = function swap16() {
                var e = this.length;
                if (e % 2 !== 0) {
                    throw new RangeError("Buffer size must be a multiple of 16-bits");
                }
                for(var r = 0; r < e; r += 2){
                    swap(this, r, r + 1);
                }
                return this;
            };
            Buffer.prototype.swap32 = function swap32() {
                var e = this.length;
                if (e % 4 !== 0) {
                    throw new RangeError("Buffer size must be a multiple of 32-bits");
                }
                for(var r = 0; r < e; r += 4){
                    swap(this, r, r + 3);
                    swap(this, r + 1, r + 2);
                }
                return this;
            };
            Buffer.prototype.swap64 = function swap64() {
                var e = this.length;
                if (e % 8 !== 0) {
                    throw new RangeError("Buffer size must be a multiple of 64-bits");
                }
                for(var r = 0; r < e; r += 8){
                    swap(this, r, r + 7);
                    swap(this, r + 1, r + 6);
                    swap(this, r + 2, r + 5);
                    swap(this, r + 3, r + 4);
                }
                return this;
            };
            Buffer.prototype.toString = function toString() {
                var e = this.length;
                if (e === 0) return "";
                if (arguments.length === 0) return utf8Slice(this, 0, e);
                return slowToString.apply(this, arguments);
            };
            Buffer.prototype.toLocaleString = Buffer.prototype.toString;
            Buffer.prototype.equals = function equals(e) {
                if (!Buffer.isBuffer(e)) throw new TypeError("Argument must be a Buffer");
                if (this === e) return true;
                return Buffer.compare(this, e) === 0;
            };
            Buffer.prototype.inspect = function inspect() {
                var e = "";
                var t = r.INSPECT_MAX_BYTES;
                e = this.toString("hex", 0, t).replace(/(.{2})/g, "$1 ").trim();
                if (this.length > t) e += " ... ";
                return "<Buffer " + e + ">";
            };
            if (i) {
                Buffer.prototype[i] = Buffer.prototype.inspect;
            }
            Buffer.prototype.compare = function compare(e, r, t, f, n) {
                if (isInstance(e, Uint8Array)) {
                    e = Buffer.from(e, e.offset, e.byteLength);
                }
                if (!Buffer.isBuffer(e)) {
                    throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. ' + "Received type " + typeof e);
                }
                if (r === undefined) {
                    r = 0;
                }
                if (t === undefined) {
                    t = e ? e.length : 0;
                }
                if (f === undefined) {
                    f = 0;
                }
                if (n === undefined) {
                    n = this.length;
                }
                if (r < 0 || t > e.length || f < 0 || n > this.length) {
                    throw new RangeError("out of range index");
                }
                if (f >= n && r >= t) {
                    return 0;
                }
                if (f >= n) {
                    return -1;
                }
                if (r >= t) {
                    return 1;
                }
                r >>>= 0;
                t >>>= 0;
                f >>>= 0;
                n >>>= 0;
                if (this === e) return 0;
                var i = n - f;
                var o = t - r;
                var u = Math.min(i, o);
                var a = this.slice(f, n);
                var s = e.slice(r, t);
                for(var h = 0; h < u; ++h){
                    if (a[h] !== s[h]) {
                        i = a[h];
                        o = s[h];
                        break;
                    }
                }
                if (i < o) return -1;
                if (o < i) return 1;
                return 0;
            };
            function bidirectionalIndexOf(e, r, t, f, n) {
                if (e.length === 0) return -1;
                if (typeof t === "string") {
                    f = t;
                    t = 0;
                } else if (t > 2147483647) {
                    t = 2147483647;
                } else if (t < -2147483648) {
                    t = -2147483648;
                }
                t = +t;
                if (numberIsNaN(t)) {
                    t = n ? 0 : e.length - 1;
                }
                if (t < 0) t = e.length + t;
                if (t >= e.length) {
                    if (n) return -1;
                    else t = e.length - 1;
                } else if (t < 0) {
                    if (n) t = 0;
                    else return -1;
                }
                if (typeof r === "string") {
                    r = Buffer.from(r, f);
                }
                if (Buffer.isBuffer(r)) {
                    if (r.length === 0) {
                        return -1;
                    }
                    return arrayIndexOf(e, r, t, f, n);
                } else if (typeof r === "number") {
                    r = r & 255;
                    if (typeof Uint8Array.prototype.indexOf === "function") {
                        if (n) {
                            return Uint8Array.prototype.indexOf.call(e, r, t);
                        } else {
                            return Uint8Array.prototype.lastIndexOf.call(e, r, t);
                        }
                    }
                    return arrayIndexOf(e, [
                        r
                    ], t, f, n);
                }
                throw new TypeError("val must be string, number or Buffer");
            }
            function arrayIndexOf(e, r, t, f, n) {
                var i = 1;
                var o = e.length;
                var u = r.length;
                if (f !== undefined) {
                    f = String(f).toLowerCase();
                    if (f === "ucs2" || f === "ucs-2" || f === "utf16le" || f === "utf-16le") {
                        if (e.length < 2 || r.length < 2) {
                            return -1;
                        }
                        i = 2;
                        o /= 2;
                        u /= 2;
                        t /= 2;
                    }
                }
                function read(e, r) {
                    if (i === 1) {
                        return e[r];
                    } else {
                        return e.readUInt16BE(r * i);
                    }
                }
                var a;
                if (n) {
                    var s = -1;
                    for(a = t; a < o; a++){
                        if (read(e, a) === read(r, s === -1 ? 0 : a - s)) {
                            if (s === -1) s = a;
                            if (a - s + 1 === u) return s * i;
                        } else {
                            if (s !== -1) a -= a - s;
                            s = -1;
                        }
                    }
                } else {
                    if (t + u > o) t = o - u;
                    for(a = t; a >= 0; a--){
                        var h = true;
                        for(var c = 0; c < u; c++){
                            if (read(e, a + c) !== read(r, c)) {
                                h = false;
                                break;
                            }
                        }
                        if (h) return a;
                    }
                }
                return -1;
            }
            Buffer.prototype.includes = function includes(e, r, t) {
                return this.indexOf(e, r, t) !== -1;
            };
            Buffer.prototype.indexOf = function indexOf(e, r, t) {
                return bidirectionalIndexOf(this, e, r, t, true);
            };
            Buffer.prototype.lastIndexOf = function lastIndexOf(e, r, t) {
                return bidirectionalIndexOf(this, e, r, t, false);
            };
            function hexWrite(e, r, t, f) {
                t = Number(t) || 0;
                var n = e.length - t;
                if (!f) {
                    f = n;
                } else {
                    f = Number(f);
                    if (f > n) {
                        f = n;
                    }
                }
                var i = r.length;
                if (f > i / 2) {
                    f = i / 2;
                }
                for(var o = 0; o < f; ++o){
                    var u = parseInt(r.substr(o * 2, 2), 16);
                    if (numberIsNaN(u)) return o;
                    e[t + o] = u;
                }
                return o;
            }
            function utf8Write(e, r, t, f) {
                return blitBuffer(utf8ToBytes(r, e.length - t), e, t, f);
            }
            function asciiWrite(e, r, t, f) {
                return blitBuffer(asciiToBytes(r), e, t, f);
            }
            function latin1Write(e, r, t, f) {
                return asciiWrite(e, r, t, f);
            }
            function base64Write(e, r, t, f) {
                return blitBuffer(base64ToBytes(r), e, t, f);
            }
            function ucs2Write(e, r, t, f) {
                return blitBuffer(utf16leToBytes(r, e.length - t), e, t, f);
            }
            Buffer.prototype.write = function write(e, r, t, f) {
                if (r === undefined) {
                    f = "utf8";
                    t = this.length;
                    r = 0;
                } else if (t === undefined && typeof r === "string") {
                    f = r;
                    t = this.length;
                    r = 0;
                } else if (isFinite(r)) {
                    r = r >>> 0;
                    if (isFinite(t)) {
                        t = t >>> 0;
                        if (f === undefined) f = "utf8";
                    } else {
                        f = t;
                        t = undefined;
                    }
                } else {
                    throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
                }
                var n = this.length - r;
                if (t === undefined || t > n) t = n;
                if (e.length > 0 && (t < 0 || r < 0) || r > this.length) {
                    throw new RangeError("Attempt to write outside buffer bounds");
                }
                if (!f) f = "utf8";
                var i = false;
                for(;;){
                    switch(f){
                        case "hex":
                            return hexWrite(this, e, r, t);
                        case "utf8":
                        case "utf-8":
                            return utf8Write(this, e, r, t);
                        case "ascii":
                            return asciiWrite(this, e, r, t);
                        case "latin1":
                        case "binary":
                            return latin1Write(this, e, r, t);
                        case "base64":
                            return base64Write(this, e, r, t);
                        case "ucs2":
                        case "ucs-2":
                        case "utf16le":
                        case "utf-16le":
                            return ucs2Write(this, e, r, t);
                        default:
                            if (i) throw new TypeError("Unknown encoding: " + f);
                            f = ("" + f).toLowerCase();
                            i = true;
                    }
                }
            };
            Buffer.prototype.toJSON = function toJSON() {
                return {
                    type: "Buffer",
                    data: Array.prototype.slice.call(this._arr || this, 0)
                };
            };
            function base64Slice(e, r, t) {
                if (r === 0 && t === e.length) {
                    return f.fromByteArray(e);
                } else {
                    return f.fromByteArray(e.slice(r, t));
                }
            }
            function utf8Slice(e, r, t) {
                t = Math.min(e.length, t);
                var f = [];
                var n = r;
                while(n < t){
                    var i = e[n];
                    var o = null;
                    var u = i > 239 ? 4 : i > 223 ? 3 : i > 191 ? 2 : 1;
                    if (n + u <= t) {
                        var a, s, h, c;
                        switch(u){
                            case 1:
                                if (i < 128) {
                                    o = i;
                                }
                                break;
                            case 2:
                                a = e[n + 1];
                                if ((a & 192) === 128) {
                                    c = (i & 31) << 6 | a & 63;
                                    if (c > 127) {
                                        o = c;
                                    }
                                }
                                break;
                            case 3:
                                a = e[n + 1];
                                s = e[n + 2];
                                if ((a & 192) === 128 && (s & 192) === 128) {
                                    c = (i & 15) << 12 | (a & 63) << 6 | s & 63;
                                    if (c > 2047 && (c < 55296 || c > 57343)) {
                                        o = c;
                                    }
                                }
                                break;
                            case 4:
                                a = e[n + 1];
                                s = e[n + 2];
                                h = e[n + 3];
                                if ((a & 192) === 128 && (s & 192) === 128 && (h & 192) === 128) {
                                    c = (i & 15) << 18 | (a & 63) << 12 | (s & 63) << 6 | h & 63;
                                    if (c > 65535 && c < 1114112) {
                                        o = c;
                                    }
                                }
                        }
                    }
                    if (o === null) {
                        o = 65533;
                        u = 1;
                    } else if (o > 65535) {
                        o -= 65536;
                        f.push(o >>> 10 & 1023 | 55296);
                        o = 56320 | o & 1023;
                    }
                    f.push(o);
                    n += u;
                }
                return decodeCodePointsArray(f);
            }
            var u = 4096;
            function decodeCodePointsArray(e) {
                var r = e.length;
                if (r <= u) {
                    return String.fromCharCode.apply(String, e);
                }
                var t = "";
                var f = 0;
                while(f < r){
                    t += String.fromCharCode.apply(String, e.slice(f, f += u));
                }
                return t;
            }
            function asciiSlice(e, r, t) {
                var f = "";
                t = Math.min(e.length, t);
                for(var n = r; n < t; ++n){
                    f += String.fromCharCode(e[n] & 127);
                }
                return f;
            }
            function latin1Slice(e, r, t) {
                var f = "";
                t = Math.min(e.length, t);
                for(var n = r; n < t; ++n){
                    f += String.fromCharCode(e[n]);
                }
                return f;
            }
            function hexSlice(e, r, t) {
                var f = e.length;
                if (!r || r < 0) r = 0;
                if (!t || t < 0 || t > f) t = f;
                var n = "";
                for(var i = r; i < t; ++i){
                    n += s[e[i]];
                }
                return n;
            }
            function utf16leSlice(e, r, t) {
                var f = e.slice(r, t);
                var n = "";
                for(var i = 0; i < f.length; i += 2){
                    n += String.fromCharCode(f[i] + f[i + 1] * 256);
                }
                return n;
            }
            Buffer.prototype.slice = function slice(e, r) {
                var t = this.length;
                e = ~~e;
                r = r === undefined ? t : ~~r;
                if (e < 0) {
                    e += t;
                    if (e < 0) e = 0;
                } else if (e > t) {
                    e = t;
                }
                if (r < 0) {
                    r += t;
                    if (r < 0) r = 0;
                } else if (r > t) {
                    r = t;
                }
                if (r < e) r = e;
                var f = this.subarray(e, r);
                Object.setPrototypeOf(f, Buffer.prototype);
                return f;
            };
            function checkOffset(e, r, t) {
                if (e % 1 !== 0 || e < 0) throw new RangeError("offset is not uint");
                if (e + r > t) throw new RangeError("Trying to access beyond buffer length");
            }
            Buffer.prototype.readUIntLE = function readUIntLE(e, r, t) {
                e = e >>> 0;
                r = r >>> 0;
                if (!t) checkOffset(e, r, this.length);
                var f = this[e];
                var n = 1;
                var i = 0;
                while(++i < r && (n *= 256)){
                    f += this[e + i] * n;
                }
                return f;
            };
            Buffer.prototype.readUIntBE = function readUIntBE(e, r, t) {
                e = e >>> 0;
                r = r >>> 0;
                if (!t) {
                    checkOffset(e, r, this.length);
                }
                var f = this[e + --r];
                var n = 1;
                while(r > 0 && (n *= 256)){
                    f += this[e + --r] * n;
                }
                return f;
            };
            Buffer.prototype.readUInt8 = function readUInt8(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 1, this.length);
                return this[e];
            };
            Buffer.prototype.readUInt16LE = function readUInt16LE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 2, this.length);
                return this[e] | this[e + 1] << 8;
            };
            Buffer.prototype.readUInt16BE = function readUInt16BE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 2, this.length);
                return this[e] << 8 | this[e + 1];
            };
            Buffer.prototype.readUInt32LE = function readUInt32LE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 4, this.length);
                return (this[e] | this[e + 1] << 8 | this[e + 2] << 16) + this[e + 3] * 16777216;
            };
            Buffer.prototype.readUInt32BE = function readUInt32BE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 4, this.length);
                return this[e] * 16777216 + (this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]);
            };
            Buffer.prototype.readIntLE = function readIntLE(e, r, t) {
                e = e >>> 0;
                r = r >>> 0;
                if (!t) checkOffset(e, r, this.length);
                var f = this[e];
                var n = 1;
                var i = 0;
                while(++i < r && (n *= 256)){
                    f += this[e + i] * n;
                }
                n *= 128;
                if (f >= n) f -= Math.pow(2, 8 * r);
                return f;
            };
            Buffer.prototype.readIntBE = function readIntBE(e, r, t) {
                e = e >>> 0;
                r = r >>> 0;
                if (!t) checkOffset(e, r, this.length);
                var f = r;
                var n = 1;
                var i = this[e + --f];
                while(f > 0 && (n *= 256)){
                    i += this[e + --f] * n;
                }
                n *= 128;
                if (i >= n) i -= Math.pow(2, 8 * r);
                return i;
            };
            Buffer.prototype.readInt8 = function readInt8(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 1, this.length);
                if (!(this[e] & 128)) return this[e];
                return (255 - this[e] + 1) * -1;
            };
            Buffer.prototype.readInt16LE = function readInt16LE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 2, this.length);
                var t = this[e] | this[e + 1] << 8;
                return t & 32768 ? t | 4294901760 : t;
            };
            Buffer.prototype.readInt16BE = function readInt16BE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 2, this.length);
                var t = this[e + 1] | this[e] << 8;
                return t & 32768 ? t | 4294901760 : t;
            };
            Buffer.prototype.readInt32LE = function readInt32LE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 4, this.length);
                return this[e] | this[e + 1] << 8 | this[e + 2] << 16 | this[e + 3] << 24;
            };
            Buffer.prototype.readInt32BE = function readInt32BE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 4, this.length);
                return this[e] << 24 | this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3];
            };
            Buffer.prototype.readFloatLE = function readFloatLE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 4, this.length);
                return n.read(this, e, true, 23, 4);
            };
            Buffer.prototype.readFloatBE = function readFloatBE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 4, this.length);
                return n.read(this, e, false, 23, 4);
            };
            Buffer.prototype.readDoubleLE = function readDoubleLE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 8, this.length);
                return n.read(this, e, true, 52, 8);
            };
            Buffer.prototype.readDoubleBE = function readDoubleBE(e, r) {
                e = e >>> 0;
                if (!r) checkOffset(e, 8, this.length);
                return n.read(this, e, false, 52, 8);
            };
            function checkInt(e, r, t, f, n, i) {
                if (!Buffer.isBuffer(e)) throw new TypeError('"buffer" argument must be a Buffer instance');
                if (r > n || r < i) throw new RangeError('"value" argument is out of bounds');
                if (t + f > e.length) throw new RangeError("Index out of range");
            }
            Buffer.prototype.writeUIntLE = function writeUIntLE(e, r, t, f) {
                e = +e;
                r = r >>> 0;
                t = t >>> 0;
                if (!f) {
                    var n = Math.pow(2, 8 * t) - 1;
                    checkInt(this, e, r, t, n, 0);
                }
                var i = 1;
                var o = 0;
                this[r] = e & 255;
                while(++o < t && (i *= 256)){
                    this[r + o] = e / i & 255;
                }
                return r + t;
            };
            Buffer.prototype.writeUIntBE = function writeUIntBE(e, r, t, f) {
                e = +e;
                r = r >>> 0;
                t = t >>> 0;
                if (!f) {
                    var n = Math.pow(2, 8 * t) - 1;
                    checkInt(this, e, r, t, n, 0);
                }
                var i = t - 1;
                var o = 1;
                this[r + i] = e & 255;
                while(--i >= 0 && (o *= 256)){
                    this[r + i] = e / o & 255;
                }
                return r + t;
            };
            Buffer.prototype.writeUInt8 = function writeUInt8(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 1, 255, 0);
                this[r] = e & 255;
                return r + 1;
            };
            Buffer.prototype.writeUInt16LE = function writeUInt16LE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 2, 65535, 0);
                this[r] = e & 255;
                this[r + 1] = e >>> 8;
                return r + 2;
            };
            Buffer.prototype.writeUInt16BE = function writeUInt16BE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 2, 65535, 0);
                this[r] = e >>> 8;
                this[r + 1] = e & 255;
                return r + 2;
            };
            Buffer.prototype.writeUInt32LE = function writeUInt32LE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 4, 4294967295, 0);
                this[r + 3] = e >>> 24;
                this[r + 2] = e >>> 16;
                this[r + 1] = e >>> 8;
                this[r] = e & 255;
                return r + 4;
            };
            Buffer.prototype.writeUInt32BE = function writeUInt32BE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 4, 4294967295, 0);
                this[r] = e >>> 24;
                this[r + 1] = e >>> 16;
                this[r + 2] = e >>> 8;
                this[r + 3] = e & 255;
                return r + 4;
            };
            Buffer.prototype.writeIntLE = function writeIntLE(e, r, t, f) {
                e = +e;
                r = r >>> 0;
                if (!f) {
                    var n = Math.pow(2, 8 * t - 1);
                    checkInt(this, e, r, t, n - 1, -n);
                }
                var i = 0;
                var o = 1;
                var u = 0;
                this[r] = e & 255;
                while(++i < t && (o *= 256)){
                    if (e < 0 && u === 0 && this[r + i - 1] !== 0) {
                        u = 1;
                    }
                    this[r + i] = (e / o >> 0) - u & 255;
                }
                return r + t;
            };
            Buffer.prototype.writeIntBE = function writeIntBE(e, r, t, f) {
                e = +e;
                r = r >>> 0;
                if (!f) {
                    var n = Math.pow(2, 8 * t - 1);
                    checkInt(this, e, r, t, n - 1, -n);
                }
                var i = t - 1;
                var o = 1;
                var u = 0;
                this[r + i] = e & 255;
                while(--i >= 0 && (o *= 256)){
                    if (e < 0 && u === 0 && this[r + i + 1] !== 0) {
                        u = 1;
                    }
                    this[r + i] = (e / o >> 0) - u & 255;
                }
                return r + t;
            };
            Buffer.prototype.writeInt8 = function writeInt8(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 1, 127, -128);
                if (e < 0) e = 255 + e + 1;
                this[r] = e & 255;
                return r + 1;
            };
            Buffer.prototype.writeInt16LE = function writeInt16LE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 2, 32767, -32768);
                this[r] = e & 255;
                this[r + 1] = e >>> 8;
                return r + 2;
            };
            Buffer.prototype.writeInt16BE = function writeInt16BE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 2, 32767, -32768);
                this[r] = e >>> 8;
                this[r + 1] = e & 255;
                return r + 2;
            };
            Buffer.prototype.writeInt32LE = function writeInt32LE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 4, 2147483647, -2147483648);
                this[r] = e & 255;
                this[r + 1] = e >>> 8;
                this[r + 2] = e >>> 16;
                this[r + 3] = e >>> 24;
                return r + 4;
            };
            Buffer.prototype.writeInt32BE = function writeInt32BE(e, r, t) {
                e = +e;
                r = r >>> 0;
                if (!t) checkInt(this, e, r, 4, 2147483647, -2147483648);
                if (e < 0) e = 4294967295 + e + 1;
                this[r] = e >>> 24;
                this[r + 1] = e >>> 16;
                this[r + 2] = e >>> 8;
                this[r + 3] = e & 255;
                return r + 4;
            };
            function checkIEEE754(e, r, t, f, n, i) {
                if (t + f > e.length) throw new RangeError("Index out of range");
                if (t < 0) throw new RangeError("Index out of range");
            }
            function writeFloat(e, r, t, f, i) {
                r = +r;
                t = t >>> 0;
                if (!i) {
                    checkIEEE754(e, r, t, 4, 34028234663852886e22, -34028234663852886e22);
                }
                n.write(e, r, t, f, 23, 4);
                return t + 4;
            }
            Buffer.prototype.writeFloatLE = function writeFloatLE(e, r, t) {
                return writeFloat(this, e, r, true, t);
            };
            Buffer.prototype.writeFloatBE = function writeFloatBE(e, r, t) {
                return writeFloat(this, e, r, false, t);
            };
            function writeDouble(e, r, t, f, i) {
                r = +r;
                t = t >>> 0;
                if (!i) {
                    checkIEEE754(e, r, t, 8, 17976931348623157e292, -17976931348623157e292);
                }
                n.write(e, r, t, f, 52, 8);
                return t + 8;
            }
            Buffer.prototype.writeDoubleLE = function writeDoubleLE(e, r, t) {
                return writeDouble(this, e, r, true, t);
            };
            Buffer.prototype.writeDoubleBE = function writeDoubleBE(e, r, t) {
                return writeDouble(this, e, r, false, t);
            };
            Buffer.prototype.copy = function copy(e, r, t, f) {
                if (!Buffer.isBuffer(e)) throw new TypeError("argument should be a Buffer");
                if (!t) t = 0;
                if (!f && f !== 0) f = this.length;
                if (r >= e.length) r = e.length;
                if (!r) r = 0;
                if (f > 0 && f < t) f = t;
                if (f === t) return 0;
                if (e.length === 0 || this.length === 0) return 0;
                if (r < 0) {
                    throw new RangeError("targetStart out of bounds");
                }
                if (t < 0 || t >= this.length) throw new RangeError("Index out of range");
                if (f < 0) throw new RangeError("sourceEnd out of bounds");
                if (f > this.length) f = this.length;
                if (e.length - r < f - t) {
                    f = e.length - r + t;
                }
                var n = f - t;
                if (this === e && typeof Uint8Array.prototype.copyWithin === "function") {
                    this.copyWithin(r, t, f);
                } else if (this === e && t < r && r < f) {
                    for(var i = n - 1; i >= 0; --i){
                        e[i + r] = this[i + t];
                    }
                } else {
                    Uint8Array.prototype.set.call(e, this.subarray(t, f), r);
                }
                return n;
            };
            Buffer.prototype.fill = function fill(e, r, t, f) {
                if (typeof e === "string") {
                    if (typeof r === "string") {
                        f = r;
                        r = 0;
                        t = this.length;
                    } else if (typeof t === "string") {
                        f = t;
                        t = this.length;
                    }
                    if (f !== undefined && typeof f !== "string") {
                        throw new TypeError("encoding must be a string");
                    }
                    if (typeof f === "string" && !Buffer.isEncoding(f)) {
                        throw new TypeError("Unknown encoding: " + f);
                    }
                    if (e.length === 1) {
                        var n = e.charCodeAt(0);
                        if (f === "utf8" && n < 128 || f === "latin1") {
                            e = n;
                        }
                    }
                } else if (typeof e === "number") {
                    e = e & 255;
                } else if (typeof e === "boolean") {
                    e = Number(e);
                }
                if (r < 0 || this.length < r || this.length < t) {
                    throw new RangeError("Out of range index");
                }
                if (t <= r) {
                    return this;
                }
                r = r >>> 0;
                t = t === undefined ? this.length : t >>> 0;
                if (!e) e = 0;
                var i;
                if (typeof e === "number") {
                    for(i = r; i < t; ++i){
                        this[i] = e;
                    }
                } else {
                    var o = Buffer.isBuffer(e) ? e : Buffer.from(e, f);
                    var u = o.length;
                    if (u === 0) {
                        throw new TypeError('The value "' + e + '" is invalid for argument "value"');
                    }
                    for(i = 0; i < t - r; ++i){
                        this[i + r] = o[i % u];
                    }
                }
                return this;
            };
            var a = /[^+/0-9A-Za-z-_]/g;
            function base64clean(e) {
                e = e.split("=")[0];
                e = e.trim().replace(a, "");
                if (e.length < 2) return "";
                while(e.length % 4 !== 0){
                    e = e + "=";
                }
                return e;
            }
            function utf8ToBytes(e, r) {
                r = r || Infinity;
                var t;
                var f = e.length;
                var n = null;
                var i = [];
                for(var o = 0; o < f; ++o){
                    t = e.charCodeAt(o);
                    if (t > 55295 && t < 57344) {
                        if (!n) {
                            if (t > 56319) {
                                if ((r -= 3) > -1) i.push(239, 191, 189);
                                continue;
                            } else if (o + 1 === f) {
                                if ((r -= 3) > -1) i.push(239, 191, 189);
                                continue;
                            }
                            n = t;
                            continue;
                        }
                        if (t < 56320) {
                            if ((r -= 3) > -1) i.push(239, 191, 189);
                            n = t;
                            continue;
                        }
                        t = (n - 55296 << 10 | t - 56320) + 65536;
                    } else if (n) {
                        if ((r -= 3) > -1) i.push(239, 191, 189);
                    }
                    n = null;
                    if (t < 128) {
                        if ((r -= 1) < 0) break;
                        i.push(t);
                    } else if (t < 2048) {
                        if ((r -= 2) < 0) break;
                        i.push(t >> 6 | 192, t & 63 | 128);
                    } else if (t < 65536) {
                        if ((r -= 3) < 0) break;
                        i.push(t >> 12 | 224, t >> 6 & 63 | 128, t & 63 | 128);
                    } else if (t < 1114112) {
                        if ((r -= 4) < 0) break;
                        i.push(t >> 18 | 240, t >> 12 & 63 | 128, t >> 6 & 63 | 128, t & 63 | 128);
                    } else {
                        throw new Error("Invalid code point");
                    }
                }
                return i;
            }
            function asciiToBytes(e) {
                var r = [];
                for(var t = 0; t < e.length; ++t){
                    r.push(e.charCodeAt(t) & 255);
                }
                return r;
            }
            function utf16leToBytes(e, r) {
                var t, f, n;
                var i = [];
                for(var o = 0; o < e.length; ++o){
                    if ((r -= 2) < 0) break;
                    t = e.charCodeAt(o);
                    f = t >> 8;
                    n = t % 256;
                    i.push(n);
                    i.push(f);
                }
                return i;
            }
            function base64ToBytes(e) {
                return f.toByteArray(base64clean(e));
            }
            function blitBuffer(e, r, t, f) {
                for(var n = 0; n < f; ++n){
                    if (n + t >= r.length || n >= e.length) break;
                    r[n + t] = e[n];
                }
                return n;
            }
            function isInstance(e, r) {
                return e instanceof r || e != null && e.constructor != null && e.constructor.name != null && e.constructor.name === r.name;
            }
            function numberIsNaN(e) {
                return e !== e;
            }
            var s = function() {
                var e = "0123456789abcdef";
                var r = new Array(256);
                for(var t = 0; t < 16; ++t){
                    var f = t * 16;
                    for(var n = 0; n < 16; ++n){
                        r[f + n] = e[t] + e[n];
                    }
                }
                return r;
            }();
        },
        783: function(e, r) {
            /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ r.read = function(e, r, t, f, n) {
                var i, o;
                var u = n * 8 - f - 1;
                var a = (1 << u) - 1;
                var s = a >> 1;
                var h = -7;
                var c = t ? n - 1 : 0;
                var l = t ? -1 : 1;
                var p = e[r + c];
                c += l;
                i = p & (1 << -h) - 1;
                p >>= -h;
                h += u;
                for(; h > 0; i = i * 256 + e[r + c], c += l, h -= 8){}
                o = i & (1 << -h) - 1;
                i >>= -h;
                h += f;
                for(; h > 0; o = o * 256 + e[r + c], c += l, h -= 8){}
                if (i === 0) {
                    i = 1 - s;
                } else if (i === a) {
                    return o ? NaN : (p ? -1 : 1) * Infinity;
                } else {
                    o = o + Math.pow(2, f);
                    i = i - s;
                }
                return (p ? -1 : 1) * o * Math.pow(2, i - f);
            };
            r.write = function(e, r, t, f, n, i) {
                var o, u, a;
                var s = i * 8 - n - 1;
                var h = (1 << s) - 1;
                var c = h >> 1;
                var l = n === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0;
                var p = f ? 0 : i - 1;
                var y = f ? 1 : -1;
                var g = r < 0 || r === 0 && 1 / r < 0 ? 1 : 0;
                r = Math.abs(r);
                if (isNaN(r) || r === Infinity) {
                    u = isNaN(r) ? 1 : 0;
                    o = h;
                } else {
                    o = Math.floor(Math.log(r) / Math.LN2);
                    if (r * (a = Math.pow(2, -o)) < 1) {
                        o--;
                        a *= 2;
                    }
                    if (o + c >= 1) {
                        r += l / a;
                    } else {
                        r += l * Math.pow(2, 1 - c);
                    }
                    if (r * a >= 2) {
                        o++;
                        a /= 2;
                    }
                    if (o + c >= h) {
                        u = 0;
                        o = h;
                    } else if (o + c >= 1) {
                        u = (r * a - 1) * Math.pow(2, n);
                        o = o + c;
                    } else {
                        u = r * Math.pow(2, c - 1) * Math.pow(2, n);
                        o = 0;
                    }
                }
                for(; n >= 8; e[t + p] = u & 255, p += y, u /= 256, n -= 8){}
                o = o << n | u;
                s += n;
                for(; s > 0; e[t + p] = o & 255, p += y, o /= 256, s -= 8){}
                e[t + p - y] |= g * 128;
            };
        }
    };
    var r = {};
    function __nccwpck_require__(t) {
        var f = r[t];
        if (f !== undefined) {
            return f.exports;
        }
        var n = r[t] = {
            exports: {}
        };
        var i = true;
        try {
            e[t](n, n.exports, __nccwpck_require__);
            i = false;
        } finally{
            if (i) delete r[t];
        }
        return n.exports;
    }
    if (typeof __nccwpck_require__ !== "undefined") __nccwpck_require__.ab = ("TURBOPACK compile-time value", "/ROOT/node_modules/next/dist/compiled/buffer") + "/";
    var t = __nccwpck_require__(72);
    module.exports = t;
})();
}),
"[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * The base error class of hpke-js.
 * @group Errors
 */ __turbopack_context__.s([
    "DecapError",
    ()=>DecapError,
    "DeriveKeyPairError",
    ()=>DeriveKeyPairError,
    "DeserializeError",
    ()=>DeserializeError,
    "EncapError",
    ()=>EncapError,
    "ExportError",
    ()=>ExportError,
    "HpkeError",
    ()=>HpkeError,
    "InvalidParamError",
    ()=>InvalidParamError,
    "MessageLimitReachedError",
    ()=>MessageLimitReachedError,
    "NotSupportedError",
    ()=>NotSupportedError,
    "OpenError",
    ()=>OpenError,
    "SealError",
    ()=>SealError,
    "SerializeError",
    ()=>SerializeError,
    "ValidationError",
    ()=>ValidationError
]);
class HpkeError extends Error {
    constructor(e){
        let message;
        if (e instanceof Error) {
            message = e.message;
        } else if (typeof e === "string") {
            message = e;
        } else {
            message = "";
        }
        super(message);
        this.name = this.constructor.name;
    }
}
class InvalidParamError extends HpkeError {
}
class ValidationError extends HpkeError {
}
class SerializeError extends HpkeError {
}
class DeserializeError extends HpkeError {
}
class EncapError extends HpkeError {
}
class DecapError extends HpkeError {
}
class ExportError extends HpkeError {
}
class SealError extends HpkeError {
}
class OpenError extends HpkeError {
}
class MessageLimitReachedError extends HpkeError {
}
class DeriveKeyPairError extends HpkeError {
}
class NotSupportedError extends HpkeError {
}
}),
"[project]/node_modules/@hpke/common/esm/_dnt.shims.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "dntGlobalThis",
    ()=>dntGlobalThis
]);
const dntGlobals = {};
const dntGlobalThis = createMergeProxy(globalThis, dntGlobals);
function createMergeProxy(baseObj, extObj) {
    return new Proxy(baseObj, {
        get (_target, prop, _receiver) {
            if (prop in extObj) {
                return extObj[prop];
            } else {
                return baseObj[prop];
            }
        },
        set (_target, prop, value) {
            if (prop in extObj) {
                delete extObj[prop];
            }
            baseObj[prop] = value;
            return true;
        },
        deleteProperty (_target, prop) {
            let success = false;
            if (prop in extObj) {
                delete extObj[prop];
                success = true;
            }
            if (prop in baseObj) {
                delete baseObj[prop];
                success = true;
            }
            return success;
        },
        ownKeys (_target) {
            const baseKeys = Reflect.ownKeys(baseObj);
            const extKeys = Reflect.ownKeys(extObj);
            const extKeysSet = new Set(extKeys);
            return [
                ...baseKeys.filter((k)=>!extKeysSet.has(k)),
                ...extKeys
            ];
        },
        defineProperty (_target, prop, desc) {
            if (prop in extObj) {
                delete extObj[prop];
            }
            Reflect.defineProperty(baseObj, prop, desc);
            return true;
        },
        getOwnPropertyDescriptor (_target, prop) {
            if (prop in extObj) {
                return Reflect.getOwnPropertyDescriptor(extObj, prop);
            } else {
                return Reflect.getOwnPropertyDescriptor(baseObj, prop);
            }
        },
        has (_target, prop) {
            return prop in extObj || prop in baseObj;
        }
    });
}
}),
"[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "NativeAlgorithm",
    ()=>NativeAlgorithm
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/_dnt.shims.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
;
;
async function loadSubtleCrypto() {
    if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dntGlobalThis"] !== undefined && globalThis.crypto !== undefined) {
        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.
        return globalThis.crypto.subtle;
    }
    // Node.js <= v18
    try {
        // @ts-ignore: to ignore "crypto"
        const { webcrypto } = await __turbopack_context__.A("[project]/node_modules/next/dist/compiled/crypto-browserify/index.js [app-client] (ecmascript, async loader)"); // node:crypto
        return webcrypto.subtle;
    } catch (e) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"](e);
    }
}
class NativeAlgorithm {
    async _setup() {
        if (this._api !== undefined) {
            return;
        }
        this._api = await loadSubtleCrypto();
    }
    constructor(){
        Object.defineProperty(this, "_api", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
    }
}
}),
"[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * The supported HPKE modes.
 */ __turbopack_context__.s([
    "AeadId",
    ()=>AeadId,
    "KdfId",
    ()=>KdfId,
    "KemId",
    ()=>KemId,
    "Mode",
    ()=>Mode
]);
const Mode = {
    Base: 0x00,
    Psk: 0x01,
    Auth: 0x02,
    AuthPsk: 0x03
};
const KemId = {
    NotAssigned: 0x0000,
    DhkemP256HkdfSha256: 0x0010,
    DhkemP384HkdfSha384: 0x0011,
    DhkemP521HkdfSha512: 0x0012,
    DhkemSecp256k1HkdfSha256: 0x0013,
    DhkemX25519HkdfSha256: 0x0020,
    DhkemX448HkdfSha512: 0x0021,
    HybridkemX25519Kyber768: 0x0030,
    MlKem512: 0x0040,
    MlKem768: 0x0041,
    MlKem1024: 0x0042,
    XWing: 0x647a
};
const KdfId = {
    HkdfSha256: 0x0001,
    HkdfSha384: 0x0002,
    HkdfSha512: 0x0003
};
const AeadId = {
    Aes128Gcm: 0x0001,
    Aes256Gcm: 0x0002,
    Chacha20Poly1305: 0x0003,
    ExportOnly: 0xFFFF
};
}),
"[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// The input length limit (psk, psk_id, info, exporter_context, ikm).
__turbopack_context__.s([
    "EMPTY",
    ()=>EMPTY,
    "INFO_LENGTH_LIMIT",
    ()=>INFO_LENGTH_LIMIT,
    "INPUT_LENGTH_LIMIT",
    ()=>INPUT_LENGTH_LIMIT,
    "MINIMUM_PSK_LENGTH",
    ()=>MINIMUM_PSK_LENGTH
]);
const INPUT_LENGTH_LIMIT = 8192;
const INFO_LENGTH_LIMIT = 65536;
const MINIMUM_PSK_LENGTH = 32;
const EMPTY = new Uint8Array(0);
}),
"[project]/node_modules/@hpke/common/esm/src/interfaces/kemInterface.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// b"KEM"
__turbopack_context__.s([
    "SUITE_ID_HEADER_KEM",
    ()=>SUITE_ID_HEADER_KEM
]);
const SUITE_ID_HEADER_KEM = new Uint8Array([
    75,
    69,
    77,
    0,
    0
]);
}),
"[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "base64UrlToBytes",
    ()=>base64UrlToBytes,
    "bytesToBase64Url",
    ()=>bytesToBase64Url,
    "bytesToHex",
    ()=>bytesToHex,
    "concat",
    ()=>concat,
    "hexToBytes",
    ()=>hexToBytes,
    "i2Osp",
    ()=>i2Osp,
    "isCryptoKeyPair",
    ()=>isCryptoKeyPair,
    "isDeno",
    ()=>isDeno,
    "isDenoV1",
    ()=>isDenoV1,
    "kemToKeyGenAlgorithm",
    ()=>kemToKeyGenAlgorithm,
    "loadCrypto",
    ()=>loadCrypto,
    "loadSubtleCrypto",
    ()=>loadSubtleCrypto,
    "xor",
    ()=>xor
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/_dnt.shims.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
;
;
const isDenoV1 = ()=>// deno-lint-ignore no-explicit-any
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dntGlobalThis"].process === undefined;
function isDeno() {
    var _dntShim_dntGlobalThis_process_versions, _dntShim_dntGlobalThis_process;
    // deno-lint-ignore no-explicit-any
    if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dntGlobalThis"].process === undefined) {
        return true;
    }
    // deno-lint-ignore no-explicit-any
    return ((_dntShim_dntGlobalThis_process = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dntGlobalThis"].process) === null || _dntShim_dntGlobalThis_process === void 0 ? void 0 : (_dntShim_dntGlobalThis_process_versions = _dntShim_dntGlobalThis_process.versions) === null || _dntShim_dntGlobalThis_process_versions === void 0 ? void 0 : _dntShim_dntGlobalThis_process_versions.deno) !== undefined;
}
const isCryptoKeyPair = (x)=>typeof x === "object" && x !== null && typeof x.privateKey === "object" && typeof x.publicKey === "object";
function i2Osp(n, w) {
    if (w <= 0) {
        throw new Error("i2Osp: too small size");
    }
    if (n >= 256 ** w) {
        throw new Error("i2Osp: too large integer");
    }
    const ret = new Uint8Array(w);
    for(let i = 0; i < w && n; i++){
        ret[w - (i + 1)] = n % 256;
        n = n >> 8;
    }
    return ret;
}
function concat(a, b) {
    const ret = new Uint8Array(a.length + b.length);
    ret.set(a, 0);
    ret.set(b, a.length);
    return ret;
}
function base64UrlToBytes(v) {
    const base64 = v.replace(/-/g, "+").replace(/_/g, "/");
    const byteString = atob(base64);
    const ret = new Uint8Array(byteString.length);
    for(let i = 0; i < byteString.length; i++){
        ret[i] = byteString.charCodeAt(i);
    }
    return ret;
}
function bytesToBase64Url(v) {
    return btoa(String.fromCharCode(...v)).replace(/\+/g, "-").replace(/\//g, "_").replace(/=*$/g, "");
}
function hexToBytes(v) {
    if (v.length === 0) {
        return new Uint8Array([]);
    }
    const res = v.match(/[\da-f]{2}/gi);
    if (res == null) {
        throw new Error("Not hex string.");
    }
    return new Uint8Array(res.map(function(h) {
        return parseInt(h, 16);
    }));
}
function bytesToHex(v) {
    return [
        ...v
    ].map((x)=>x.toString(16).padStart(2, "0")).join("");
}
function kemToKeyGenAlgorithm(kem) {
    switch(kem){
        case __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP256HkdfSha256:
            return {
                name: "ECDH",
                namedCurve: "P-256"
            };
        case __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP384HkdfSha384:
            return {
                name: "ECDH",
                namedCurve: "P-384"
            };
        case __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP521HkdfSha512:
            return {
                name: "ECDH",
                namedCurve: "P-521"
            };
        default:
            // case KemId.DhkemX25519HkdfSha256
            return {
                name: "X25519"
            };
    }
}
async function loadSubtleCrypto() {
    if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dntGlobalThis"] !== undefined && globalThis.crypto !== undefined) {
        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.
        return globalThis.crypto.subtle;
    }
    // Node.js <= v18
    try {
        // @ts-ignore: to ignore "crypto"
        const { webcrypto } = await __turbopack_context__.A("[project]/node_modules/next/dist/compiled/crypto-browserify/index.js [app-client] (ecmascript, async loader)"); // node:crypto
        return webcrypto.subtle;
    } catch (_e) {
        throw new Error("Failed to load SubtleCrypto");
    }
}
async function loadCrypto() {
    if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dntGlobalThis"] !== undefined && globalThis.crypto !== undefined) {
        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.
        return globalThis.crypto;
    }
    // Node.js <= v18
    try {
        // @ts-ignore: to ignore "crypto"
        const { webcrypto } = await __turbopack_context__.A("[project]/node_modules/next/dist/compiled/crypto-browserify/index.js [app-client] (ecmascript, async loader)"); // node:crypto
        return webcrypto;
    } catch (_e) {
        throw new Error("Web Cryptograph API not supported");
    }
}
function xor(a, b) {
    if (a.byteLength !== b.byteLength) {
        throw new Error("xor: different length inputs");
    }
    const buf = new Uint8Array(a.byteLength);
    for(let i = 0; i < a.byteLength; i++){
        buf[i] = a[i] ^ b[i];
    }
    return buf;
}
}),
"[project]/node_modules/@hpke/common/esm/src/kems/dhkem.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Dhkem",
    ()=>Dhkem
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$kemInterface$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/kemInterface.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
;
;
;
;
// b"eae_prk"
const LABEL_EAE_PRK = new Uint8Array([
    101,
    97,
    101,
    95,
    112,
    114,
    107
]);
// b"shared_secret"
// deno-fmt-ignore
const LABEL_SHARED_SECRET = new Uint8Array([
    115,
    104,
    97,
    114,
    101,
    100,
    95,
    115,
    101,
    99,
    114,
    101,
    116
]);
function concat3(a, b, c) {
    const ret = new Uint8Array(a.length + b.length + c.length);
    ret.set(a, 0);
    ret.set(b, a.length);
    ret.set(c, a.length + b.length);
    return ret;
}
class Dhkem {
    async serializePublicKey(key) {
        return await this._prim.serializePublicKey(key);
    }
    async deserializePublicKey(key) {
        return await this._prim.deserializePublicKey(key);
    }
    async serializePrivateKey(key) {
        return await this._prim.serializePrivateKey(key);
    }
    async deserializePrivateKey(key) {
        return await this._prim.deserializePrivateKey(key);
    }
    async importKey(format, key) {
        let isPublic = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : true;
        return await this._prim.importKey(format, key, isPublic);
    }
    async generateKeyPair() {
        return await this._prim.generateKeyPair();
    }
    async deriveKeyPair(ikm) {
        if (ikm.byteLength > __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["INPUT_LENGTH_LIMIT"]) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Too long ikm");
        }
        return await this._prim.deriveKeyPair(ikm);
    }
    async encap(params) {
        let ke;
        if (params.ekm === undefined) {
            ke = await this.generateKeyPair();
        } else if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.ekm)) {
            // params.ekm is only used for testing.
            ke = params.ekm;
        } else {
            // params.ekm is only used for testing.
            ke = await this.deriveKeyPair(params.ekm);
        }
        const enc = await this._prim.serializePublicKey(ke.publicKey);
        const pkrm = await this._prim.serializePublicKey(params.recipientPublicKey);
        try {
            let dh;
            if (params.senderKey === undefined) {
                dh = new Uint8Array(await this._prim.dh(ke.privateKey, params.recipientPublicKey));
            } else {
                const sks = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.senderKey) ? params.senderKey.privateKey : params.senderKey;
                const dh1 = new Uint8Array(await this._prim.dh(ke.privateKey, params.recipientPublicKey));
                const dh2 = new Uint8Array(await this._prim.dh(sks, params.recipientPublicKey));
                dh = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(dh1, dh2);
            }
            let kemContext;
            if (params.senderKey === undefined) {
                kemContext = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(enc), new Uint8Array(pkrm));
            } else {
                const pks = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.senderKey) ? params.senderKey.publicKey : await this._prim.derivePublicKey(params.senderKey);
                const pksm = await this._prim.serializePublicKey(pks);
                kemContext = concat3(new Uint8Array(enc), new Uint8Array(pkrm), new Uint8Array(pksm));
            }
            const sharedSecret = await this._generateSharedSecret(dh, kemContext);
            return {
                enc: enc,
                sharedSecret: sharedSecret
            };
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EncapError"](e);
        }
    }
    async decap(params) {
        const pke = await this._prim.deserializePublicKey(params.enc);
        const skr = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.recipientKey) ? params.recipientKey.privateKey : params.recipientKey;
        const pkr = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.recipientKey) ? params.recipientKey.publicKey : await this._prim.derivePublicKey(params.recipientKey);
        const pkrm = await this._prim.serializePublicKey(pkr);
        try {
            let dh;
            if (params.senderPublicKey === undefined) {
                dh = new Uint8Array(await this._prim.dh(skr, pke));
            } else {
                const dh1 = new Uint8Array(await this._prim.dh(skr, pke));
                const dh2 = new Uint8Array(await this._prim.dh(skr, params.senderPublicKey));
                dh = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(dh1, dh2);
            }
            let kemContext;
            if (params.senderPublicKey === undefined) {
                kemContext = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(params.enc), new Uint8Array(pkrm));
            } else {
                const pksm = await this._prim.serializePublicKey(params.senderPublicKey);
                kemContext = new Uint8Array(params.enc.byteLength + pkrm.byteLength + pksm.byteLength);
                kemContext.set(new Uint8Array(params.enc), 0);
                kemContext.set(new Uint8Array(pkrm), params.enc.byteLength);
                kemContext.set(new Uint8Array(pksm), params.enc.byteLength + pkrm.byteLength);
            }
            return await this._generateSharedSecret(dh, kemContext);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DecapError"](e);
        }
    }
    async _generateSharedSecret(dh, kemContext) {
        const labeledIkm = this._kdf.buildLabeledIkm(LABEL_EAE_PRK, dh);
        const labeledInfo = this._kdf.buildLabeledInfo(LABEL_SHARED_SECRET, kemContext, this.secretSize);
        return await this._kdf.extractAndExpand(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer, labeledIkm.buffer, labeledInfo.buffer, this.secretSize);
    }
    constructor(id, prim, kdf){
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_prim", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_kdf", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.id = id;
        this._prim = prim;
        this._kdf = kdf;
        const suiteId = new Uint8Array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$kemInterface$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SUITE_ID_HEADER_KEM"]);
        suiteId.set((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["i2Osp"])(this.id, 2), 3);
        this._kdf.init(suiteId);
    }
}
}),
"[project]/node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// The key usages for KEM.
__turbopack_context__.s([
    "KEM_USAGES",
    ()=>KEM_USAGES,
    "LABEL_DKP_PRK",
    ()=>LABEL_DKP_PRK,
    "LABEL_SK",
    ()=>LABEL_SK
]);
const KEM_USAGES = [
    "deriveBits"
];
const LABEL_DKP_PRK = new Uint8Array([
    100,
    107,
    112,
    95,
    112,
    114,
    107
]);
const LABEL_SK = new Uint8Array([
    115,
    107
]);
}),
"[project]/node_modules/@hpke/common/esm/src/utils/bignum.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * The minimum inplementation of bignum to derive an EC key pair.
 */ __turbopack_context__.s([
    "Bignum",
    ()=>Bignum
]);
class Bignum {
    val() {
        return this._num;
    }
    reset() {
        this._num.fill(0);
    }
    set(src) {
        if (src.length !== this._num.length) {
            throw new Error("Bignum.set: invalid argument");
        }
        this._num.set(src);
    }
    isZero() {
        for(let i = 0; i < this._num.length; i++){
            if (this._num[i] !== 0) {
                return false;
            }
        }
        return true;
    }
    lessThan(v) {
        if (v.length !== this._num.length) {
            throw new Error("Bignum.lessThan: invalid argument");
        }
        for(let i = 0; i < this._num.length; i++){
            if (this._num[i] < v[i]) {
                return true;
            }
            if (this._num[i] > v[i]) {
                return false;
            }
        }
        return false;
    }
    constructor(size){
        Object.defineProperty(this, "_num", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this._num = new Uint8Array(size);
    }
}
}),
"[project]/node_modules/@hpke/common/esm/src/kems/dhkemPrimitives/ec.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Ec",
    ()=>Ec
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$bignum$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/bignum.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
// b"candidate"
// deno-fmt-ignore
const LABEL_CANDIDATE = new Uint8Array([
    99,
    97,
    110,
    100,
    105,
    100,
    97,
    116,
    101
]);
// the order of the curve being used.
// deno-fmt-ignore
const ORDER_P_256 = new Uint8Array([
    0xff,
    0xff,
    0xff,
    0xff,
    0x00,
    0x00,
    0x00,
    0x00,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xbc,
    0xe6,
    0xfa,
    0xad,
    0xa7,
    0x17,
    0x9e,
    0x84,
    0xf3,
    0xb9,
    0xca,
    0xc2,
    0xfc,
    0x63,
    0x25,
    0x51
]);
// deno-fmt-ignore
const ORDER_P_384 = new Uint8Array([
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xc7,
    0x63,
    0x4d,
    0x81,
    0xf4,
    0x37,
    0x2d,
    0xdf,
    0x58,
    0x1a,
    0x0d,
    0xb2,
    0x48,
    0xb0,
    0xa7,
    0x7a,
    0xec,
    0xec,
    0x19,
    0x6a,
    0xcc,
    0xc5,
    0x29,
    0x73
]);
// deno-fmt-ignore
const ORDER_P_521 = new Uint8Array([
    0x01,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xff,
    0xfa,
    0x51,
    0x86,
    0x87,
    0x83,
    0xbf,
    0x2f,
    0x96,
    0x6b,
    0x7f,
    0xcc,
    0x01,
    0x48,
    0xf7,
    0x09,
    0xa5,
    0xd0,
    0x3b,
    0xb5,
    0xc9,
    0xb8,
    0x89,
    0x9c,
    0x47,
    0xae,
    0xbb,
    0x6f,
    0xb7,
    0x1e,
    0x91,
    0x38,
    0x64,
    0x09
]);
// deno-fmt-ignore
const PKCS8_ALG_ID_P_256 = new Uint8Array([
    48,
    65,
    2,
    1,
    0,
    48,
    19,
    6,
    7,
    42,
    134,
    72,
    206,
    61,
    2,
    1,
    6,
    8,
    42,
    134,
    72,
    206,
    61,
    3,
    1,
    7,
    4,
    39,
    48,
    37,
    2,
    1,
    1,
    4,
    32
]);
// deno-fmt-ignore
const PKCS8_ALG_ID_P_384 = new Uint8Array([
    48,
    78,
    2,
    1,
    0,
    48,
    16,
    6,
    7,
    42,
    134,
    72,
    206,
    61,
    2,
    1,
    6,
    5,
    43,
    129,
    4,
    0,
    34,
    4,
    55,
    48,
    53,
    2,
    1,
    1,
    4,
    48
]);
// deno-fmt-ignore
const PKCS8_ALG_ID_P_521 = new Uint8Array([
    48,
    96,
    2,
    1,
    0,
    48,
    16,
    6,
    7,
    42,
    134,
    72,
    206,
    61,
    2,
    1,
    6,
    5,
    43,
    129,
    4,
    0,
    35,
    4,
    73,
    48,
    71,
    2,
    1,
    1,
    4,
    66
]);
class Ec extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NativeAlgorithm"] {
    async serializePublicKey(key) {
        await this._setup();
        try {
            return await this._api.exportKey("raw", key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePublicKey(key) {
        await this._setup();
        try {
            return await this._importRawKey(key, true);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async serializePrivateKey(key) {
        await this._setup();
        try {
            const jwk = await this._api.exportKey("jwk", key);
            if (!("d" in jwk)) {
                throw new Error("Not private key");
            }
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64UrlToBytes"])(jwk["d"]).buffer;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePrivateKey(key) {
        await this._setup();
        try {
            return await this._importRawKey(key, false);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async importKey(format, key, isPublic) {
        await this._setup();
        try {
            if (format === "raw") {
                return await this._importRawKey(key, isPublic);
            }
            // jwk
            if (key instanceof ArrayBuffer) {
                throw new Error("Invalid jwk key format");
            }
            return await this._importJWK(key, isPublic);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async generateKeyPair() {
        await this._setup();
        try {
            return await this._api.generateKey(this._alg, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"](e);
        }
    }
    async deriveKeyPair(ikm) {
        await this._setup();
        try {
            const dkpPrk = await this._hkdf.labeledExtract(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LABEL_DKP_PRK"], new Uint8Array(ikm));
            const bn = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$bignum$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Bignum"](this._nSk);
            for(let counter = 0; bn.isZero() || !bn.lessThan(this._order); counter++){
                if (counter > 255) {
                    throw new Error("Faild to derive a key pair");
                }
                const bytes = new Uint8Array(await this._hkdf.labeledExpand(dkpPrk, LABEL_CANDIDATE, (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["i2Osp"])(counter, 1), this._nSk));
                bytes[0] = bytes[0] & this._bitmask;
                bn.set(bytes);
            }
            const sk = await this._deserializePkcs8Key(bn.val());
            bn.reset();
            return {
                privateKey: sk,
                publicKey: await this.derivePublicKey(sk)
            };
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeriveKeyPairError"](e);
        }
    }
    async derivePublicKey(key) {
        await this._setup();
        try {
            const jwk = await this._api.exportKey("jwk", key);
            delete jwk["d"];
            delete jwk["key_ops"];
            return await this._api.importKey("jwk", jwk, this._alg, true, []);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async dh(sk, pk) {
        try {
            await this._setup();
            const bits = await this._api.deriveBits({
                name: "ECDH",
                public: pk
            }, sk, this._nDh * 8);
            return bits;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async _importRawKey(key, isPublic) {
        if (isPublic && key.byteLength !== this._nPk) {
            throw new Error("Invalid public key for the ciphersuite");
        }
        if (!isPublic && key.byteLength !== this._nSk) {
            throw new Error("Invalid private key for the ciphersuite");
        }
        if (isPublic) {
            return await this._api.importKey("raw", key, this._alg, true, []);
        }
        return await this._deserializePkcs8Key(new Uint8Array(key));
    }
    async _importJWK(key, isPublic) {
        if (typeof key.crv === "undefined" || key.crv !== this._alg.namedCurve) {
            throw new Error("Invalid crv: ".concat(key.crv));
        }
        if (isPublic) {
            if (typeof key.d !== "undefined") {
                throw new Error("Invalid key: `d` should not be set");
            }
            return await this._api.importKey("jwk", key, this._alg, true, []);
        }
        if (typeof key.d === "undefined") {
            throw new Error("Invalid key: `d` not found");
        }
        return await this._api.importKey("jwk", key, this._alg, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
    }
    async _deserializePkcs8Key(k) {
        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);
        pkcs8Key.set(this._pkcs8AlgId, 0);
        pkcs8Key.set(k, this._pkcs8AlgId.length);
        return await this._api.importKey("pkcs8", pkcs8Key, this._alg, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
    }
    constructor(kem, hkdf){
        super();
        Object.defineProperty(this, "_hkdf", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_alg", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nPk", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nSk", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nDh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // EC specific arguments for deriving key pair.
        Object.defineProperty(this, "_order", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_bitmask", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_pkcs8AlgId", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this._hkdf = hkdf;
        switch(kem){
            case __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP256HkdfSha256:
                this._alg = {
                    name: "ECDH",
                    namedCurve: "P-256"
                };
                this._nPk = 65;
                this._nSk = 32;
                this._nDh = 32;
                this._order = ORDER_P_256;
                this._bitmask = 0xFF;
                this._pkcs8AlgId = PKCS8_ALG_ID_P_256;
                break;
            case __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP384HkdfSha384:
                this._alg = {
                    name: "ECDH",
                    namedCurve: "P-384"
                };
                this._nPk = 97;
                this._nSk = 48;
                this._nDh = 48;
                this._order = ORDER_P_384;
                this._bitmask = 0xFF;
                this._pkcs8AlgId = PKCS8_ALG_ID_P_384;
                break;
            default:
                // case KemId.DhkemP521HkdfSha512:
                this._alg = {
                    name: "ECDH",
                    namedCurve: "P-521"
                };
                this._nPk = 133;
                this._nSk = 66;
                this._nDh = 66;
                this._order = ORDER_P_521;
                this._bitmask = 0x01;
                this._pkcs8AlgId = PKCS8_ALG_ID_P_521;
                break;
        }
    }
}
}),
"[project]/node_modules/@hpke/common/esm/src/xCryptoKey.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "XCryptoKey",
    ()=>XCryptoKey
]);
class XCryptoKey {
    constructor(name, key, type, usages = []){
        Object.defineProperty(this, "key", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "type", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "extractable", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: true
        });
        Object.defineProperty(this, "algorithm", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "usages", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.key = key;
        this.type = type;
        this.algorithm = {
            name: name
        };
        this.usages = usages;
        if (type === "public") {
            this.usages = [];
        }
    }
}
}),
"[project]/node_modules/@hpke/common/esm/src/kems/hybridkem.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Hybridkem",
    ()=>Hybridkem
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$kemInterface$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/kemInterface.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/xCryptoKey.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
class Hybridkem {
    async serializePublicKey(key) {
        try {
            return await this._serializePublicKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePublicKey(key) {
        try {
            return await this._deserializePublicKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async serializePrivateKey(key) {
        try {
            return await this._serializePrivateKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePrivateKey(key) {
        try {
            return await this._deserializePrivateKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async generateKeyPair() {
        const kpA = await this._a.generateKeyPair();
        const kpB = await this._b.generateKeyPair();
        const pkA = await this._a.serializePublicKey(kpA.publicKey);
        const skA = await this._a.serializePrivateKey(kpA.privateKey);
        const pkB = await this._b.serializePublicKey(kpB.publicKey);
        const skB = await this._b.serializePrivateKey(kpB.privateKey);
        return {
            publicKey: await this.deserializePublicKey((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(pkA), new Uint8Array(pkB)).buffer),
            privateKey: await this.deserializePrivateKey((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(skA), new Uint8Array(skB)).buffer)
        };
    }
    async deriveKeyPair(ikm) {
        const dkpPrk = await this._kdf.labeledExtract(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LABEL_DKP_PRK"], new Uint8Array(ikm));
        const seed = new Uint8Array(await this._kdf.labeledExpand(dkpPrk, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LABEL_SK"], __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"], 32 + 64));
        const seed1 = seed.slice(0, 32);
        const seed2 = seed.slice(32, 96);
        const kpA = await this._a.deriveKeyPair(seed1.buffer);
        const kpB = await this._b.deriveKeyPair(seed2.buffer);
        const pkA = await this._a.serializePublicKey(kpA.publicKey);
        const skA = await this._a.serializePrivateKey(kpA.privateKey);
        const pkB = await this._b.serializePublicKey(kpB.publicKey);
        const skB = await this._b.serializePrivateKey(kpB.privateKey);
        return {
            publicKey: await this.deserializePublicKey((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(pkA), new Uint8Array(pkB)).buffer),
            privateKey: await this.deserializePrivateKey((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(skA), new Uint8Array(skB)).buffer)
        };
    }
    async importKey(format, key) {
        let isPublic = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : true;
        if (format !== "raw") {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"]("'jwk' is not supported");
        }
        if (!(key instanceof ArrayBuffer)) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Invalid type of key");
        }
        if (isPublic) {
            return await this.deserializePublicKey(key);
        }
        return await this.deserializePrivateKey(key);
    }
    async encap(params) {
        let ekmA = undefined;
        let ekmB = undefined;
        if (params.ekm !== undefined && !(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.ekm)) {
            if (params.ekm.byteLength !== 64) {
                throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("ekm must be 64 bytes in length");
            }
            ekmA = params.ekm.slice(0, 32);
            ekmB = params.ekm.slice(32);
        }
        const pkR = new Uint8Array(await this.serializePublicKey(params.recipientPublicKey));
        const pkRA = await this._a.deserializePublicKey(pkR.slice(0, this._a.publicKeySize).buffer);
        const pkRB = await this._b.deserializePublicKey(pkR.slice(this._a.publicKeySize).buffer);
        const resA = await this._a.encap({
            recipientPublicKey: pkRA,
            ekm: ekmA
        });
        const resB = await this._b.encap({
            recipientPublicKey: pkRB,
            ekm: ekmB
        });
        return {
            sharedSecret: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(resA.sharedSecret), new Uint8Array(resB.sharedSecret)).buffer,
            enc: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(resA.enc), new Uint8Array(resB.enc)).buffer
        };
    }
    async decap(params) {
        const sk = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.recipientKey) ? params.recipientKey.privateKey : params.recipientKey;
        const skR = new Uint8Array(await this.serializePrivateKey(sk));
        const skRA = await this._a.deserializePrivateKey(skR.slice(0, this._a.privateKeySize).buffer);
        const skRB = await this._b.deserializePrivateKey(skR.slice(this._a.privateKeySize).buffer);
        const ssA = await this._a.decap({
            recipientKey: skRA,
            enc: params.enc.slice(0, this._a.encSize)
        });
        const ssB = await this._b.decap({
            recipientKey: skRB,
            enc: params.enc.slice(this._a.encSize)
        });
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(new Uint8Array(ssA), new Uint8Array(ssB)).buffer;
    }
    _serializePublicKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.type !== "public") {
                reject(new Error("Not public key"));
            }
            if (k.algorithm.name !== this.name) {
                reject(new Error("Invalid algorithm name: ".concat(k.algorithm.name)));
            }
            if (k.key.byteLength !== this.publicKeySize) {
                reject(new Error("Invalid key length: ".concat(k.key.byteLength)));
            }
            resolve(k.key.buffer);
        });
    }
    _deserializePublicKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.byteLength !== this.publicKeySize) {
                reject(new Error("Invalid key length: ".concat(k.byteLength)));
            }
            resolve(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["XCryptoKey"](this.name, new Uint8Array(k), "public"));
        });
    }
    _serializePrivateKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.type !== "private") {
                reject(new Error("Not private key"));
            }
            if (k.algorithm.name !== this.name) {
                reject(new Error("Invalid algorithm name: ".concat(k.algorithm.name)));
            }
            if (k.key.byteLength !== this.privateKeySize) {
                reject(new Error("Invalid key length: ".concat(k.key.byteLength)));
            }
            resolve(k.key.buffer);
        });
    }
    _deserializePrivateKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.byteLength !== this.privateKeySize) {
                reject(new Error("Invalid key length: ".concat(k.byteLength)));
            }
            resolve(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["XCryptoKey"](this.name, new Uint8Array(k), "private", [
                "deriveBits"
            ]));
        });
    }
    constructor(id, a, b, kdf){
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].NotAssigned
        });
        Object.defineProperty(this, "name", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: ""
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_a", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_b", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_kdf", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.id = id;
        this._a = a;
        this._b = b;
        this._kdf = kdf;
        const suiteId = new Uint8Array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$kemInterface$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SUITE_ID_HEADER_KEM"]);
        suiteId.set((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["i2Osp"])(this.id, 2), 3);
        this._kdf.init(suiteId);
    }
}
}),
"[project]/node_modules/@hpke/common/esm/src/kdfs/hkdf.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "HkdfNative",
    ()=>HkdfNative,
    "HkdfSha256Native",
    ()=>HkdfSha256Native,
    "HkdfSha384Native",
    ()=>HkdfSha384Native,
    "HkdfSha512Native",
    ()=>HkdfSha512Native
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)");
;
;
;
;
// b"HPKE-v1"
const HPKE_VERSION = new Uint8Array([
    72,
    80,
    75,
    69,
    45,
    118,
    49
]);
class HkdfNative extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NativeAlgorithm"] {
    init(suiteId) {
        this._suiteId = suiteId;
    }
    buildLabeledIkm(label, ikm) {
        this._checkInit();
        const ret = new Uint8Array(7 + this._suiteId.byteLength + label.byteLength + ikm.byteLength);
        ret.set(HPKE_VERSION, 0);
        ret.set(this._suiteId, 7);
        ret.set(label, 7 + this._suiteId.byteLength);
        ret.set(ikm, 7 + this._suiteId.byteLength + label.byteLength);
        return ret;
    }
    buildLabeledInfo(label, info, len) {
        this._checkInit();
        const ret = new Uint8Array(9 + this._suiteId.byteLength + label.byteLength + info.byteLength);
        ret.set(new Uint8Array([
            0,
            len
        ]), 0);
        ret.set(HPKE_VERSION, 2);
        ret.set(this._suiteId, 9);
        ret.set(label, 9 + this._suiteId.byteLength);
        ret.set(info, 9 + this._suiteId.byteLength + label.byteLength);
        return ret;
    }
    async extract(salt, ikm) {
        await this._setup();
        if (salt.byteLength === 0) {
            salt = new ArrayBuffer(this.hashSize);
        }
        if (salt.byteLength !== this.hashSize) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("The salt length must be the same as the hashSize");
        }
        const key = await this._api.importKey("raw", salt, this.algHash, false, [
            "sign"
        ]);
        return await this._api.sign("HMAC", key, ikm);
    }
    async expand(prk, info, len) {
        await this._setup();
        const key = await this._api.importKey("raw", prk, this.algHash, false, [
            "sign"
        ]);
        const okm = new ArrayBuffer(len);
        const p = new Uint8Array(okm);
        let prev = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"];
        const mid = new Uint8Array(info);
        const tail = new Uint8Array(1);
        if (len > 255 * this.hashSize) {
            throw new Error("Entropy limit reached");
        }
        const tmp = new Uint8Array(this.hashSize + mid.length + 1);
        for(let i = 1, cur = 0; cur < p.length; i++){
            tail[0] = i;
            tmp.set(prev, 0);
            tmp.set(mid, prev.length);
            tmp.set(tail, prev.length + mid.length);
            prev = new Uint8Array(await this._api.sign("HMAC", key, tmp.slice(0, prev.length + mid.length + 1)));
            if (p.length - cur >= prev.length) {
                p.set(prev, cur);
                cur += prev.length;
            } else {
                p.set(prev.slice(0, p.length - cur), cur);
                cur += p.length - cur;
            }
        }
        return okm;
    }
    async extractAndExpand(salt, ikm, info, len) {
        await this._setup();
        const baseKey = await this._api.importKey("raw", ikm, "HKDF", false, [
            "deriveBits"
        ]);
        return await this._api.deriveBits({
            name: "HKDF",
            hash: this.algHash.hash,
            salt: salt,
            info: info
        }, baseKey, len * 8);
    }
    async labeledExtract(salt, label, ikm) {
        return await this.extract(salt, this.buildLabeledIkm(label, ikm).buffer);
    }
    async labeledExpand(prk, label, info, len) {
        return await this.expand(prk, this.buildLabeledInfo(label, info, len).buffer, len);
    }
    _checkInit() {
        if (this._suiteId === __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"]) {
            throw new Error("Not initialized. Call init()");
        }
    }
    constructor(){
        super();
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KdfId"].HkdfSha256
        });
        Object.defineProperty(this, "hashSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_suiteId", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"]
        });
        Object.defineProperty(this, "algHash", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {
                name: "HMAC",
                hash: "SHA-256",
                length: 256
            }
        });
    }
}
class HkdfSha256Native extends HkdfNative {
    constructor(){
        super(...arguments);
        /** KdfId.HkdfSha256 (0x0001) */ Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KdfId"].HkdfSha256
        });
        /** 32 */ Object.defineProperty(this, "hashSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        /** The parameters for Web Cryptography API */ Object.defineProperty(this, "algHash", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {
                name: "HMAC",
                hash: "SHA-256",
                length: 256
            }
        });
    }
}
class HkdfSha384Native extends HkdfNative {
    constructor(){
        super(...arguments);
        /** KdfId.HkdfSha384 (0x0002) */ Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KdfId"].HkdfSha384
        });
        /** 48 */ Object.defineProperty(this, "hashSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 48
        });
        /** The parameters for Web Cryptography API */ Object.defineProperty(this, "algHash", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {
                name: "HMAC",
                hash: "SHA-384",
                length: 384
            }
        });
    }
}
class HkdfSha512Native extends HkdfNative {
    constructor(){
        super(...arguments);
        /** KdfId.HkdfSha512 (0x0003) */ Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KdfId"].HkdfSha512
        });
        /** 64 */ Object.defineProperty(this, "hashSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 64
        });
        /** The parameters for Web Cryptography API */ Object.defineProperty(this, "algHash", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {
                name: "HMAC",
                hash: "SHA-512",
                length: 512
            }
        });
    }
}
}),
"[project]/node_modules/@hpke/common/esm/src/interfaces/aeadEncryptionContext.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// The key usages for AEAD.
__turbopack_context__.s([
    "AEAD_USAGES",
    ()=>AEAD_USAGES
]);
const AEAD_USAGES = [
    "encrypt",
    "decrypt"
];
}),
"[project]/node_modules/@hpke/common/esm/src/utils/noble.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// deno-lint-ignore-file no-explicit-any
/**
 * This file is based on noble-curves (https://github.com/paulmillr/noble-curves).
 *
 * noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-curves/blob/b9d49d2b41d550571a0c5be443ecb62109fa3373/src/utils.ts
 */ /**
 * Hex, bytes and number utilities.
 * @module
 */ __turbopack_context__.s([
    "aInRange",
    ()=>aInRange,
    "abytes",
    ()=>abytes,
    "aexists",
    ()=>aexists,
    "ahash",
    ()=>ahash,
    "anumber",
    ()=>anumber,
    "aoutput",
    ()=>aoutput,
    "asciiToBytes",
    ()=>asciiToBytes,
    "bytesToHex",
    ()=>bytesToHex,
    "bytesToNumberBE",
    ()=>bytesToNumberBE,
    "bytesToNumberLE",
    ()=>bytesToNumberLE,
    "bytesToUtf8",
    ()=>bytesToUtf8,
    "clean",
    ()=>clean,
    "concatBytes",
    ()=>concatBytes,
    "copyBytes",
    ()=>copyBytes,
    "createHasher",
    ()=>createHasher,
    "createView",
    ()=>createView,
    "hexToBytes",
    ()=>hexToBytes,
    "hexToNumber",
    ()=>hexToNumber,
    "inRange",
    ()=>inRange,
    "isBytes",
    ()=>isBytes,
    "numberToBytesBE",
    ()=>numberToBytesBE,
    "numberToBytesLE",
    ()=>numberToBytesLE,
    "numberToHexUnpadded",
    ()=>numberToHexUnpadded,
    "oidNist",
    ()=>oidNist,
    "randomBytesAsync",
    ()=>randomBytesAsync,
    "rotr",
    ()=>rotr,
    "utf8ToBytes",
    ()=>utf8ToBytes,
    "validateObject",
    ()=>validateObject
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
;
const _0n = /* @__PURE__ */ BigInt(0);
function isBytes(a) {
    return a instanceof Uint8Array || ArrayBuffer.isView(a) && a.constructor.name === "Uint8Array";
}
function abytes(value, length) {
    let title = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : "";
    const bytes = isBytes(value);
    const len = value === null || value === void 0 ? void 0 : value.length;
    const needsLen = length !== undefined;
    if (!bytes || needsLen && len !== length) {
        const prefix = title && '"'.concat(title, '" ');
        const ofLen = needsLen ? " of length ".concat(length) : "";
        const got = bytes ? "length=".concat(len) : "type=".concat(typeof value);
        throw new Error(prefix + "expected Uint8Array" + ofLen + ", got " + got);
    }
    return value;
}
function ahash(h) {
    if (typeof h !== "function" || typeof h.create !== "function") {
        throw new Error("Hash must wrapped by utils.createHasher");
    }
    anumber(h.outputLen);
    anumber(h.blockLen);
}
function aexists(instance) {
    let checkFinished = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;
    if (instance.destroyed) throw new Error("Hash instance has been destroyed");
    if (checkFinished && instance.finished) {
        throw new Error("Hash#digest() has already been called");
    }
}
function aoutput(out, instance) {
    abytes(out, undefined, "digestInto() output");
    const min = instance.outputLen;
    if (out.length < min) {
        throw new Error('"digestInto() output" expected to be of length >=' + min);
    }
}
function anumber(n) {
    if (!Number.isSafeInteger(n) || n < 0) {
        throw new Error("positive integer expected, got " + n);
    }
}
// Used in weierstrass, der
function abignumer(n) {
    if (typeof n === "bigint") {
        if (!isPosBig(n)) throw new Error("positive bigint expected, got " + n);
    } else anumber(n);
    return n;
}
function clean() {
    for(var _len = arguments.length, arrays = new Array(_len), _key = 0; _key < _len; _key++){
        arrays[_key] = arguments[_key];
    }
    for(let i = 0; i < arrays.length; i++){
        arrays[i].fill(0);
    }
}
function createView(arr) {
    return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);
}
function rotr(word, shift) {
    return word << 32 - shift | word >>> shift;
}
// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex
const hasHexBuiltin = /* @__PURE__ */ (()=>// @ts-ignore: to use toHex
    typeof Uint8Array.from([]).toHex === "function" && // @ts-ignore: to use fromHex
    typeof Uint8Array.fromHex === "function")();
// Array where index 0xf0 (240) is mapped to string 'f0'
const hexes = /* @__PURE__ */ Array.from({
    length: 256
}, (_, i)=>i.toString(16).padStart(2, "0"));
function bytesToHex(bytes) {
    abytes(bytes);
    // @ts-ignore: to use toHex
    if (hasHexBuiltin) return bytes.toHex();
    // pre-caching improves the speed 6x
    let hex = "";
    for(let i = 0; i < bytes.length; i++){
        hex += hexes[bytes[i]];
    }
    return hex;
}
// We use optimized technique to convert hex string to byte array
const asciis = {
    _0: 48,
    _9: 57,
    A: 65,
    F: 70,
    a: 97,
    f: 102
};
function asciiToBase16(ch) {
    if (ch >= asciis._0 && ch <= asciis._9) return ch - asciis._0; // '2' => 50-48
    if (ch >= asciis.A && ch <= asciis.F) return ch - (asciis.A - 10); // 'B' => 66-(65-10)
    if (ch >= asciis.a && ch <= asciis.f) return ch - (asciis.a - 10); // 'b' => 98-(97-10)
    return;
}
function hexToBytes(hex) {
    if (typeof hex !== "string") {
        throw new Error("hex string expected, got " + typeof hex);
    }
    // @ts-ignore: to use fromHex
    if (hasHexBuiltin) return Uint8Array.fromHex(hex);
    const hl = hex.length;
    const al = hl / 2;
    if (hl % 2) {
        throw new Error("hex string expected, got unpadded hex of length " + hl);
    }
    const array = new Uint8Array(al);
    for(let ai = 0, hi = 0; ai < al; ai++, hi += 2){
        const n1 = asciiToBase16(hex.charCodeAt(hi));
        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));
        if (n1 === undefined || n2 === undefined) {
            const char = hex[hi] + hex[hi + 1];
            throw new Error('hex string expected, got non-hex character "' + char + '" at index ' + hi);
        }
        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163
    }
    return array;
}
function utf8ToBytes(str) {
    if (typeof str !== "string") throw new Error("string expected");
    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809
}
function bytesToUtf8(bytes) {
    return new TextDecoder().decode(bytes);
}
function numberToHexUnpadded(num) {
    const hex = abignumer(num).toString(16);
    return hex.length & 1 ? "0" + hex : hex;
}
function hexToNumber(hex) {
    if (typeof hex !== "string") {
        throw new Error("hex string expected, got " + typeof hex);
    }
    return hex === "" ? _0n : BigInt("0x" + hex); // Big Endian
}
function bytesToNumberBE(bytes) {
    return hexToNumber(bytesToHex(bytes));
}
function bytesToNumberLE(bytes) {
    return hexToNumber(bytesToHex(copyBytes(abytes(bytes)).reverse()));
}
function numberToBytesBE(n, len) {
    anumber(len);
    n = abignumer(n);
    const res = hexToBytes(n.toString(16).padStart(len * 2, "0"));
    if (res.length !== len) throw new Error("number too large");
    return res;
}
function numberToBytesLE(n, len) {
    return numberToBytesBE(n, len).reverse();
}
function copyBytes(bytes) {
    return Uint8Array.from(bytes);
}
function concatBytes() {
    for(var _len = arguments.length, arrays = new Array(_len), _key = 0; _key < _len; _key++){
        arrays[_key] = arguments[_key];
    }
    let sum = 0;
    for(let i = 0; i < arrays.length; i++){
        const a = arrays[i];
        abytes(a);
        sum += a.length;
    }
    const res = new Uint8Array(sum);
    for(let i = 0, pad = 0; i < arrays.length; i++){
        const a = arrays[i];
        res.set(a, pad);
        pad += a.length;
    }
    return res;
}
function asciiToBytes(ascii) {
    return Uint8Array.from(ascii, (c, i)=>{
        const charCode = c.charCodeAt(0);
        if (c.length !== 1 || charCode > 127) {
            throw new Error('string contains non-ASCII character "'.concat(ascii[i], '" with code ').concat(charCode, " at position ").concat(i));
        }
        return charCode;
    });
}
// Is positive bigint
const isPosBig = (n)=>typeof n === "bigint" && _0n <= n;
function inRange(n, min, max) {
    return isPosBig(n) && isPosBig(min) && isPosBig(max) && min <= n && n < max;
}
function aInRange(title, n, min, max) {
    // Why min <= n < max and not a (min < n < max) OR b (min <= n <= max)?
    // consider P=256n, min=0n, max=P
    // - a for min=0 would require -1:          `inRange('x', x, -1n, P)`
    // - b would commonly require subtraction:  `inRange('x', x, 0n, P - 1n)`
    // - our way is the cleanest:               `inRange('x', x, 0n, P)
    if (!inRange(n, min, max)) {
        throw new Error("expected valid " + title + ": " + min + " <= n < " + max + ", got " + n);
    }
}
function validateObject(object) {
    let fields = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, optFields = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
    if (!object || typeof object !== "object") {
        throw new Error("expected valid options object");
    }
    function checkField(fieldName, expectedType, isOpt) {
        const val = object[fieldName];
        if (isOpt && val === undefined) return;
        const current = typeof val;
        if (current !== expectedType || val === null) {
            throw new Error('param "'.concat(fieldName, '" is invalid: expected ').concat(expectedType, ", got ").concat(current));
        }
    }
    const iter = (f, isOpt)=>Object.entries(f).forEach((param)=>{
            let [k, v] = param;
            return checkField(k, v, isOpt);
        });
    iter(fields, false);
    iter(optFields, true);
}
function createHasher(hashCons) {
    let info = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    const hashC = (msg, opts)=>hashCons(opts).update(msg).digest();
    const tmp = hashCons(undefined);
    hashC.outputLen = tmp.outputLen;
    hashC.blockLen = tmp.blockLen;
    hashC.create = (opts)=>hashCons(opts);
    Object.assign(hashC, info);
    return Object.freeze(hashC);
}
async function randomBytesAsync() {
    let bytesLength = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 32;
    const api = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["loadCrypto"])();
    const rnd = new Uint8Array(bytesLength);
    api.getRandomValues(rnd);
    return rnd;
}
const oidNist = (suffix)=>({
        oid: Uint8Array.from([
            0x06,
            0x09,
            0x60,
            0x86,
            0x48,
            0x01,
            0x65,
            0x03,
            0x04,
            0x02,
            suffix
        ])
    });
}),
"[project]/node_modules/@hpke/common/esm/src/hash/hmac.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// deno-lint-ignore-file no-explicit-any
/**
 * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).
 *
 * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-hashes/blob/2e0c00e1aa134082ba1380bf3afb8b1641f60fed/src/hmac.ts
 */ /**
 * HMAC: RFC2104 message authentication code.
 * @module
 */ __turbopack_context__.s([
    "_HMAC",
    ()=>_HMAC,
    "hmac",
    ()=>hmac
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/noble.js [app-client] (ecmascript)");
;
class _HMAC {
    update(buf) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aexists"])(this);
        this.iHash.update(buf);
        return this;
    }
    digestInto(out) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aexists"])(this);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(out, this.outputLen, "output");
        this.finished = true;
        this.iHash.digestInto(out);
        this.oHash.update(out);
        this.oHash.digestInto(out);
        this.destroy();
    }
    digest() {
        const out = new Uint8Array(this.oHash.outputLen);
        this.digestInto(out);
        return out;
    }
    _cloneInto(to) {
        // Create new instance without calling constructor since key already in state and we don't know it.
        to || (to = Object.create(Object.getPrototypeOf(this), {}));
        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;
        to = to;
        to.finished = finished;
        to.destroyed = destroyed;
        to.blockLen = blockLen;
        to.outputLen = outputLen;
        to.oHash = oHash._cloneInto(to.oHash);
        to.iHash = iHash._cloneInto(to.iHash);
        return to;
    }
    clone() {
        return this._cloneInto();
    }
    destroy() {
        this.destroyed = true;
        this.oHash.destroy();
        this.iHash.destroy();
    }
    constructor(hash, key){
        Object.defineProperty(this, "oHash", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "iHash", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "blockLen", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "outputLen", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "finished", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "destroyed", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["ahash"])(hash);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(key, undefined, "key");
        this.iHash = hash.create();
        if (typeof this.iHash.update !== "function") {
            throw new Error("Expected instance of class which extends utils.Hash");
        }
        this.blockLen = this.iHash.blockLen;
        this.outputLen = this.iHash.outputLen;
        const blockLen = this.blockLen;
        const pad = new Uint8Array(blockLen);
        // blockLen can be bigger than outputLen
        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);
        for(let i = 0; i < pad.length; i++)pad[i] ^= 0x36;
        this.iHash.update(pad);
        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone
        this.oHash = hash.create();
        // Undo internal XOR && apply outer XOR
        for(let i = 0; i < pad.length; i++)pad[i] ^= 0x36 ^ 0x5c;
        this.oHash.update(pad);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(pad);
    }
}
const hmac = (hash, key, message)=>new _HMAC(hash, key).update(message).digest();
hmac.create = (hash, key)=>new _HMAC(hash, key);
}),
"[project]/node_modules/@hpke/common/esm/src/hash/md.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// deno-lint-ignore-file no-explicit-any
/**
 * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).
 *
 * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-hashes/blob/2e0c00e1aa134082ba1380bf3afb8b1641f60fed/src/_md.ts
 */ /**
 * Internal Merkle-Damgard hash utils.
 * @module
 */ __turbopack_context__.s([
    "Chi",
    ()=>Chi,
    "HashMD",
    ()=>HashMD,
    "Maj",
    ()=>Maj,
    "SHA256_IV",
    ()=>SHA256_IV,
    "SHA384_IV",
    ()=>SHA384_IV,
    "SHA512_IV",
    ()=>SHA512_IV
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/noble.js [app-client] (ecmascript)");
;
function Chi(a, b, c) {
    return a & b ^ ~a & c;
}
function Maj(a, b, c) {
    return a & b ^ a & c ^ b & c;
}
class HashMD {
    update(data) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aexists"])(this);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(data);
        const { view, buffer, blockLen } = this;
        const len = data.length;
        for(let pos = 0; pos < len;){
            const take = Math.min(blockLen - this.pos, len - pos);
            // Fast path: we have at least one block in input, cast it to view and process
            if (take === blockLen) {
                const dataView = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createView"])(data);
                for(; blockLen <= len - pos; pos += blockLen){
                    this.process(dataView, pos);
                }
                continue;
            }
            buffer.set(data.subarray(pos, pos + take), this.pos);
            this.pos += take;
            pos += take;
            if (this.pos === blockLen) {
                this.process(view, 0);
                this.pos = 0;
            }
        }
        this.length += data.length;
        this.roundClean();
        return this;
    }
    digestInto(out) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aexists"])(this);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aoutput"])(out, this);
        this.finished = true;
        // Padding
        // We can avoid allocation of buffer for padding completely if it
        // was previously not allocated here. But it won't change performance.
        const { buffer, view, blockLen, isLE } = this;
        let { pos } = this;
        // append the bit '1' to the message
        buffer[pos++] = 0b10000000;
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(this.buffer.subarray(pos));
        // we have less than padOffset left in buffer, so we cannot put length in
        // current block, need process it and pad again
        if (this.padOffset > blockLen - pos) {
            this.process(view, 0);
            pos = 0;
        }
        // Pad until full block byte with zeros
        for(let i = pos; i < blockLen; i++)buffer[i] = 0;
        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that
        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.
        // So we just write lowest 64 bits of that value.
        view.setBigUint64(blockLen - 8, BigInt(this.length * 8), isLE);
        this.process(view, 0);
        const oview = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createView"])(out);
        const len = this.outputLen;
        // NOTE: we do division by 4 later, which must be fused in single op with modulo by JIT
        if (len % 4) throw new Error("_sha2: outputLen must be aligned to 32bit");
        const outLen = len / 4;
        const state = this.get();
        if (outLen > state.length) {
            throw new Error("_sha2: outputLen bigger than state");
        }
        for(let i = 0; i < outLen; i++)oview.setUint32(4 * i, state[i], isLE);
    }
    digest() {
        const { buffer, outputLen } = this;
        this.digestInto(buffer);
        const res = buffer.slice(0, outputLen);
        this.destroy();
        return res;
    }
    _cloneInto(to) {
        to || (to = new this.constructor());
        to.set(...this.get());
        const { blockLen, buffer, length, finished, destroyed, pos } = this;
        to.destroyed = destroyed;
        to.finished = finished;
        to.length = length;
        to.pos = pos;
        if (length % blockLen) to.buffer.set(buffer);
        return to;
    }
    clone() {
        return this._cloneInto();
    }
    constructor(blockLen, outputLen, padOffset, isLE){
        Object.defineProperty(this, "blockLen", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "outputLen", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "padOffset", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "isLE", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // For partial updates less than block size
        Object.defineProperty(this, "buffer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "view", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "finished", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "length", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "pos", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "destroyed", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        this.blockLen = blockLen;
        this.outputLen = outputLen;
        this.padOffset = padOffset;
        this.isLE = isLE;
        this.buffer = new Uint8Array(blockLen);
        this.view = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createView"])(this.buffer);
    }
}
const SHA256_IV = /* @__PURE__ */ Uint32Array.from([
    0x6a09e667,
    0xbb67ae85,
    0x3c6ef372,
    0xa54ff53a,
    0x510e527f,
    0x9b05688c,
    0x1f83d9ab,
    0x5be0cd19
]);
const SHA384_IV = /* @__PURE__ */ Uint32Array.from([
    0xcbbb9d5d,
    0xc1059ed8,
    0x629a292a,
    0x367cd507,
    0x9159015a,
    0x3070dd17,
    0x152fecd8,
    0xf70e5939,
    0x67332667,
    0xffc00b31,
    0x8eb44a87,
    0x68581511,
    0xdb0c2e0d,
    0x64f98fa7,
    0x47b5481d,
    0xbefa4fa4
]);
const SHA512_IV = /* @__PURE__ */ Uint32Array.from([
    0x6a09e667,
    0xf3bcc908,
    0xbb67ae85,
    0x84caa73b,
    0x3c6ef372,
    0xfe94f82b,
    0xa54ff53a,
    0x5f1d36f1,
    0x510e527f,
    0xade682d1,
    0x9b05688c,
    0x2b3e6c1f,
    0x1f83d9ab,
    0xfb41bd6b,
    0x5be0cd19,
    0x137e2179
]);
}),
"[project]/node_modules/@hpke/common/esm/src/hash/u64.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).
 *
 * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-hashes/blob/2e0c00e1aa134082ba1380bf3afb8b1641f60fed/src/_u64.ts
 */ /**
 * Internal helpers for u64. BigUint64Array is too slow as per 2025, so we implement it using Uint32Array.
 * @todo re-check https://issues.chromium.org/issues/42212588
 * @module
 */ __turbopack_context__.s([
    "add",
    ()=>add,
    "add3H",
    ()=>add3H,
    "add3L",
    ()=>add3L,
    "add4H",
    ()=>add4H,
    "add4L",
    ()=>add4L,
    "add5H",
    ()=>add5H,
    "add5L",
    ()=>add5L,
    "default",
    ()=>__TURBOPACK__default__export__,
    "fromBig",
    ()=>fromBig,
    "rotlBH",
    ()=>rotlBH,
    "rotlBL",
    ()=>rotlBL,
    "rotlSH",
    ()=>rotlSH,
    "rotlSL",
    ()=>rotlSL,
    "rotr32H",
    ()=>rotr32H,
    "rotr32L",
    ()=>rotr32L,
    "rotrBH",
    ()=>rotrBH,
    "rotrBL",
    ()=>rotrBL,
    "rotrSH",
    ()=>rotrSH,
    "rotrSL",
    ()=>rotrSL,
    "shrSH",
    ()=>shrSH,
    "shrSL",
    ()=>shrSL,
    "split",
    ()=>split,
    "toBig",
    ()=>toBig
]);
const U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);
const _32n = /* @__PURE__ */ BigInt(32);
function fromBig(n) {
    let le = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;
    if (le) {
        return {
            h: Number(n & U32_MASK64),
            l: Number(n >> _32n & U32_MASK64)
        };
    }
    return {
        h: Number(n >> _32n & U32_MASK64) | 0,
        l: Number(n & U32_MASK64) | 0
    };
}
function split(lst) {
    let le = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;
    const len = lst.length;
    const Ah = new Uint32Array(len);
    const Al = new Uint32Array(len);
    for(let i = 0; i < len; i++){
        const { h, l } = fromBig(lst[i], le);
        [Ah[i], Al[i]] = [
            h,
            l
        ];
    }
    return [
        Ah,
        Al
    ];
}
const toBig = (h, l)=>BigInt(h >>> 0) << _32n | BigInt(l >>> 0);
// for Shift in [0, 32)
const shrSH = (h, _l, s)=>h >>> s;
const shrSL = (h, l, s)=>h << 32 - s | l >>> s;
// Right rotate for Shift in [1, 32)
const rotrSH = (h, l, s)=>h >>> s | l << 32 - s;
const rotrSL = (h, l, s)=>h << 32 - s | l >>> s;
// Right rotate for Shift in (32, 64), NOTE: 32 is special case.
const rotrBH = (h, l, s)=>h << 64 - s | l >>> s - 32;
const rotrBL = (h, l, s)=>h >>> s - 32 | l << 64 - s;
// Right rotate for shift===32 (just swaps l&h)
const rotr32H = (_h, l)=>l;
const rotr32L = (h, _l)=>h;
// Left rotate for Shift in [1, 32)
const rotlSH = (h, l, s)=>h << s | l >>> 32 - s;
const rotlSL = (h, l, s)=>l << s | h >>> 32 - s;
// Left rotate for Shift in (32, 64), NOTE: 32 is special case.
const rotlBH = (h, l, s)=>l << s - 32 | h >>> 64 - s;
const rotlBL = (h, l, s)=>h << s - 32 | l >>> 64 - s;
// JS uses 32-bit signed integers for bitwise operations which means we cannot
// simple take carry out of low bit sum by shift, we need to use division.
function add(Ah, Al, Bh, Bl) {
    const l = (Al >>> 0) + (Bl >>> 0);
    return {
        h: Ah + Bh + (l / 2 ** 32 | 0) | 0,
        l: l | 0
    };
}
// Addition with more than 2 elements
const add3L = (Al, Bl, Cl)=>(Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);
const add3H = (low, Ah, Bh, Ch)=>Ah + Bh + Ch + (low / 2 ** 32 | 0) | 0;
const add4L = (Al, Bl, Cl, Dl)=>(Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);
const add4H = (low, Ah, Bh, Ch, Dh)=>Ah + Bh + Ch + Dh + (low / 2 ** 32 | 0) | 0;
const add5L = (Al, Bl, Cl, Dl, El)=>(Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);
const add5H = (low, Ah, Bh, Ch, Dh, Eh)=>Ah + Bh + Ch + Dh + Eh + (low / 2 ** 32 | 0) | 0;
;
// prettier-ignore
const u64 = {
    fromBig,
    split,
    toBig,
    shrSH,
    shrSL,
    rotrSH,
    rotrSL,
    rotrBH,
    rotrBL,
    rotr32H,
    rotr32L,
    rotlSH,
    rotlSL,
    rotlBH,
    rotlBL,
    add,
    add3L,
    add3H,
    add4L,
    add4H,
    add5H,
    add5L
};
const __TURBOPACK__default__export__ = u64;
}),
"[project]/node_modules/@hpke/common/esm/src/hash/sha2.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).
 *
 * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-hashes/blob/2e0c00e1aa134082ba1380bf3afb8b1641f60fed/src/sha2.ts
 */ /**
 * SHA2 hash function. A.k.a. sha256, sha384, sha512, sha512_224, sha512_256.
 * SHA256 is the fastest hash implementable in JS, even faster than Blake3.
 * Check out [RFC 4634](https://www.rfc-editor.org/rfc/rfc4634) and
 * [FIPS 180-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf).
 * @module
 */ __turbopack_context__.s([
    "_SHA256",
    ()=>_SHA256,
    "_SHA384",
    ()=>_SHA384,
    "_SHA512",
    ()=>_SHA512,
    "sha256",
    ()=>sha256,
    "sha384",
    ()=>sha384,
    "sha512",
    ()=>sha512
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/hash/md.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/hash/u64.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/noble.js [app-client] (ecmascript)");
;
;
;
/**
 * Round constants:
 * First 32 bits of fractional parts of the cube roots of the first 64 primes 2..311)
 */ // prettier-ignore
const SHA256_K = /* @__PURE__ */ Uint32Array.from([
    0x428a2f98,
    0x71374491,
    0xb5c0fbcf,
    0xe9b5dba5,
    0x3956c25b,
    0x59f111f1,
    0x923f82a4,
    0xab1c5ed5,
    0xd807aa98,
    0x12835b01,
    0x243185be,
    0x550c7dc3,
    0x72be5d74,
    0x80deb1fe,
    0x9bdc06a7,
    0xc19bf174,
    0xe49b69c1,
    0xefbe4786,
    0x0fc19dc6,
    0x240ca1cc,
    0x2de92c6f,
    0x4a7484aa,
    0x5cb0a9dc,
    0x76f988da,
    0x983e5152,
    0xa831c66d,
    0xb00327c8,
    0xbf597fc7,
    0xc6e00bf3,
    0xd5a79147,
    0x06ca6351,
    0x14292967,
    0x27b70a85,
    0x2e1b2138,
    0x4d2c6dfc,
    0x53380d13,
    0x650a7354,
    0x766a0abb,
    0x81c2c92e,
    0x92722c85,
    0xa2bfe8a1,
    0xa81a664b,
    0xc24b8b70,
    0xc76c51a3,
    0xd192e819,
    0xd6990624,
    0xf40e3585,
    0x106aa070,
    0x19a4c116,
    0x1e376c08,
    0x2748774c,
    0x34b0bcb5,
    0x391c0cb3,
    0x4ed8aa4a,
    0x5b9cca4f,
    0x682e6ff3,
    0x748f82ee,
    0x78a5636f,
    0x84c87814,
    0x8cc70208,
    0x90befffa,
    0xa4506ceb,
    0xbef9a3f7,
    0xc67178f2
]);
/** Reusable temporary buffer. "W" comes straight from spec. */ const SHA256_W = /* @__PURE__ */ new Uint32Array(64);
/** Internal 32-byte base SHA2 hash class. */ class SHA2_32B extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HashMD"] {
    get() {
        const { A, B, C, D, E, F, G, H } = this;
        return [
            A,
            B,
            C,
            D,
            E,
            F,
            G,
            H
        ];
    }
    // prettier-ignore
    set(A, B, C, D, E, F, G, H) {
        this.A = A | 0;
        this.B = B | 0;
        this.C = C | 0;
        this.D = D | 0;
        this.E = E | 0;
        this.F = F | 0;
        this.G = G | 0;
        this.H = H | 0;
    }
    process(view, offset) {
        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array
        for(let i = 0; i < 16; i++, offset += 4){
            SHA256_W[i] = view.getUint32(offset, false);
        }
        for(let i = 16; i < 64; i++){
            const W15 = SHA256_W[i - 15];
            const W2 = SHA256_W[i - 2];
            const s0 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(W15, 7) ^ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(W15, 18) ^ W15 >>> 3;
            const s1 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(W2, 17) ^ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(W2, 19) ^ W2 >>> 10;
            SHA256_W[i] = s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16] | 0;
        }
        // Compression function main loop, 64 rounds
        let { A, B, C, D, E, F, G, H } = this;
        for(let i = 0; i < 64; i++){
            const sigma1 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(E, 6) ^ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(E, 11) ^ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(E, 25);
            const T1 = H + sigma1 + (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Chi"])(E, F, G) + SHA256_K[i] + SHA256_W[i] | 0;
            const sigma0 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(A, 2) ^ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(A, 13) ^ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotr"])(A, 22);
            const T2 = sigma0 + (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Maj"])(A, B, C) | 0;
            H = G;
            G = F;
            F = E;
            E = D + T1 | 0;
            D = C;
            C = B;
            B = A;
            A = T1 + T2 | 0;
        }
        // Add the compressed chunk to the current hash value
        A = A + this.A | 0;
        B = B + this.B | 0;
        C = C + this.C | 0;
        D = D + this.D | 0;
        E = E + this.E | 0;
        F = F + this.F | 0;
        G = G + this.G | 0;
        H = H + this.H | 0;
        this.set(A, B, C, D, E, F, G, H);
    }
    roundClean() {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(SHA256_W);
    }
    destroy() {
        this.set(0, 0, 0, 0, 0, 0, 0, 0);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(this.buffer);
    }
    constructor(outputLen){
        super(64, outputLen, 8, false);
    }
}
class _SHA256 extends SHA2_32B {
    constructor(){
        super(32);
        // We cannot use array here since array allows indexing by variable
        // which means optimizer/compiler cannot use registers.
        Object.defineProperty(this, "A", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][0] | 0
        });
        Object.defineProperty(this, "B", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][1] | 0
        });
        Object.defineProperty(this, "C", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][2] | 0
        });
        Object.defineProperty(this, "D", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][3] | 0
        });
        Object.defineProperty(this, "E", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][4] | 0
        });
        Object.defineProperty(this, "F", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][5] | 0
        });
        Object.defineProperty(this, "G", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][6] | 0
        });
        Object.defineProperty(this, "H", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA256_IV"][7] | 0
        });
    }
}
// SHA2-512 is slower than sha256 in js because u64 operations are slow.
// Round contants
// First 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409
// prettier-ignore
const K512 = /* @__PURE__ */ (()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["split"]([
        "0x428a2f98d728ae22",
        "0x7137449123ef65cd",
        "0xb5c0fbcfec4d3b2f",
        "0xe9b5dba58189dbbc",
        "0x3956c25bf348b538",
        "0x59f111f1b605d019",
        "0x923f82a4af194f9b",
        "0xab1c5ed5da6d8118",
        "0xd807aa98a3030242",
        "0x12835b0145706fbe",
        "0x243185be4ee4b28c",
        "0x550c7dc3d5ffb4e2",
        "0x72be5d74f27b896f",
        "0x80deb1fe3b1696b1",
        "0x9bdc06a725c71235",
        "0xc19bf174cf692694",
        "0xe49b69c19ef14ad2",
        "0xefbe4786384f25e3",
        "0x0fc19dc68b8cd5b5",
        "0x240ca1cc77ac9c65",
        "0x2de92c6f592b0275",
        "0x4a7484aa6ea6e483",
        "0x5cb0a9dcbd41fbd4",
        "0x76f988da831153b5",
        "0x983e5152ee66dfab",
        "0xa831c66d2db43210",
        "0xb00327c898fb213f",
        "0xbf597fc7beef0ee4",
        "0xc6e00bf33da88fc2",
        "0xd5a79147930aa725",
        "0x06ca6351e003826f",
        "0x142929670a0e6e70",
        "0x27b70a8546d22ffc",
        "0x2e1b21385c26c926",
        "0x4d2c6dfc5ac42aed",
        "0x53380d139d95b3df",
        "0x650a73548baf63de",
        "0x766a0abb3c77b2a8",
        "0x81c2c92e47edaee6",
        "0x92722c851482353b",
        "0xa2bfe8a14cf10364",
        "0xa81a664bbc423001",
        "0xc24b8b70d0f89791",
        "0xc76c51a30654be30",
        "0xd192e819d6ef5218",
        "0xd69906245565a910",
        "0xf40e35855771202a",
        "0x106aa07032bbd1b8",
        "0x19a4c116b8d2d0c8",
        "0x1e376c085141ab53",
        "0x2748774cdf8eeb99",
        "0x34b0bcb5e19b48a8",
        "0x391c0cb3c5c95a63",
        "0x4ed8aa4ae3418acb",
        "0x5b9cca4f7763e373",
        "0x682e6ff3d6b2b8a3",
        "0x748f82ee5defb2fc",
        "0x78a5636f43172f60",
        "0x84c87814a1f0ab72",
        "0x8cc702081a6439ec",
        "0x90befffa23631e28",
        "0xa4506cebde82bde9",
        "0xbef9a3f7b2c67915",
        "0xc67178f2e372532b",
        "0xca273eceea26619c",
        "0xd186b8c721c0c207",
        "0xeada7dd6cde0eb1e",
        "0xf57d4f7fee6ed178",
        "0x06f067aa72176fba",
        "0x0a637dc5a2c898a6",
        "0x113f9804bef90dae",
        "0x1b710b35131c471b",
        "0x28db77f523047d84",
        "0x32caab7b40c72493",
        "0x3c9ebe0a15c9bebc",
        "0x431d67c49c100d4c",
        "0x4cc5d4becb3e42b6",
        "0x597f299cfc657e2a",
        "0x5fcb6fab3ad6faec",
        "0x6c44198c4a475817"
    ].map((n)=>BigInt(n))))();
const SHA512_Kh = /* @__PURE__ */ (()=>K512[0])();
const SHA512_Kl = /* @__PURE__ */ (()=>K512[1])();
// Reusable temporary buffers
const SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);
const SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);
/** Internal 64-byte base SHA2 hash class. */ class SHA2_64B extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HashMD"] {
    // prettier-ignore
    get() {
        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;
        return [
            Ah,
            Al,
            Bh,
            Bl,
            Ch,
            Cl,
            Dh,
            Dl,
            Eh,
            El,
            Fh,
            Fl,
            Gh,
            Gl,
            Hh,
            Hl
        ];
    }
    // prettier-ignore
    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {
        this.Ah = Ah | 0;
        this.Al = Al | 0;
        this.Bh = Bh | 0;
        this.Bl = Bl | 0;
        this.Ch = Ch | 0;
        this.Cl = Cl | 0;
        this.Dh = Dh | 0;
        this.Dl = Dl | 0;
        this.Eh = Eh | 0;
        this.El = El | 0;
        this.Fh = Fh | 0;
        this.Fl = Fl | 0;
        this.Gh = Gh | 0;
        this.Gl = Gl | 0;
        this.Hh = Hh | 0;
        this.Hl = Hl | 0;
    }
    process(view, offset) {
        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array
        for(let i = 0; i < 16; i++, offset += 4){
            SHA512_W_H[i] = view.getUint32(offset);
            SHA512_W_L[i] = view.getUint32(offset += 4);
        }
        for(let i = 16; i < 80; i++){
            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)
            const W15h = SHA512_W_H[i - 15] | 0;
            const W15l = SHA512_W_L[i - 15] | 0;
            const s0h = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSH"](W15h, W15l, 1) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSH"](W15h, W15l, 8) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["shrSH"](W15h, W15l, 7);
            const s0l = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSL"](W15h, W15l, 1) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSL"](W15h, W15l, 8) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["shrSL"](W15h, W15l, 7);
            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)
            const W2h = SHA512_W_H[i - 2] | 0;
            const W2l = SHA512_W_L[i - 2] | 0;
            const s1h = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSH"](W2h, W2l, 19) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBH"](W2h, W2l, 61) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["shrSH"](W2h, W2l, 6);
            const s1l = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSL"](W2h, W2l, 19) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBL"](W2h, W2l, 61) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["shrSL"](W2h, W2l, 6);
            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];
            const SUMl = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add4L"](s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);
            const SUMh = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add4H"](SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);
            SHA512_W_H[i] = SUMh | 0;
            SHA512_W_L[i] = SUMl | 0;
        }
        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;
        // Compression function main loop, 80 rounds
        for(let i = 0; i < 80; i++){
            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)
            const sigma1h = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSH"](Eh, El, 14) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSH"](Eh, El, 18) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBH"](Eh, El, 41);
            const sigma1l = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSL"](Eh, El, 14) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSL"](Eh, El, 18) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBL"](Eh, El, 41);
            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;
            const CHIh = Eh & Fh ^ ~Eh & Gh;
            const CHIl = El & Fl ^ ~El & Gl;
            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]
            // prettier-ignore
            const T1ll = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add5L"](Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);
            const T1h = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add5H"](T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);
            const T1l = T1ll | 0;
            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)
            const sigma0h = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSH"](Ah, Al, 28) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBH"](Ah, Al, 34) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBH"](Ah, Al, 39);
            const sigma0l = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrSL"](Ah, Al, 28) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBL"](Ah, Al, 34) ^ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotrBL"](Ah, Al, 39);
            const MAJh = Ah & Bh ^ Ah & Ch ^ Bh & Ch;
            const MAJl = Al & Bl ^ Al & Cl ^ Bl & Cl;
            Hh = Gh | 0;
            Hl = Gl | 0;
            Gh = Fh | 0;
            Gl = Fl | 0;
            Fh = Eh | 0;
            Fl = El | 0;
            ({ h: Eh, l: El } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](Dh | 0, Dl | 0, T1h | 0, T1l | 0));
            Dh = Ch | 0;
            Dl = Cl | 0;
            Ch = Bh | 0;
            Cl = Bl | 0;
            Bh = Ah | 0;
            Bl = Al | 0;
            const All = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add3L"](T1l, sigma0l, MAJl);
            Ah = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add3H"](All, T1h, sigma0h, MAJh);
            Al = All | 0;
        }
        // Add the compressed chunk to the current hash value
        ({ h: Ah, l: Al } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));
        ({ h: Bh, l: Bl } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));
        ({ h: Ch, l: Cl } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));
        ({ h: Dh, l: Dl } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));
        ({ h: Eh, l: El } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Eh | 0, this.El | 0, Eh | 0, El | 0));
        ({ h: Fh, l: Fl } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));
        ({ h: Gh, l: Gl } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));
        ({ h: Hh, l: Hl } = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["add"](this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));
        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);
    }
    roundClean() {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(SHA512_W_H, SHA512_W_L);
    }
    destroy() {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(this.buffer);
        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
    }
    constructor(outputLen){
        super(128, outputLen, 16, false);
    }
}
class _SHA512 extends SHA2_64B {
    constructor(){
        super(64);
        Object.defineProperty(this, "Ah", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][0] | 0
        });
        Object.defineProperty(this, "Al", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][1] | 0
        });
        Object.defineProperty(this, "Bh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][2] | 0
        });
        Object.defineProperty(this, "Bl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][3] | 0
        });
        Object.defineProperty(this, "Ch", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][4] | 0
        });
        Object.defineProperty(this, "Cl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][5] | 0
        });
        Object.defineProperty(this, "Dh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][6] | 0
        });
        Object.defineProperty(this, "Dl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][7] | 0
        });
        Object.defineProperty(this, "Eh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][8] | 0
        });
        Object.defineProperty(this, "El", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][9] | 0
        });
        Object.defineProperty(this, "Fh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][10] | 0
        });
        Object.defineProperty(this, "Fl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][11] | 0
        });
        Object.defineProperty(this, "Gh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][12] | 0
        });
        Object.defineProperty(this, "Gl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][13] | 0
        });
        Object.defineProperty(this, "Hh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][14] | 0
        });
        Object.defineProperty(this, "Hl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA512_IV"][15] | 0
        });
    }
}
class _SHA384 extends SHA2_64B {
    constructor(){
        super(48);
        Object.defineProperty(this, "Ah", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][0] | 0
        });
        Object.defineProperty(this, "Al", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][1] | 0
        });
        Object.defineProperty(this, "Bh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][2] | 0
        });
        Object.defineProperty(this, "Bl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][3] | 0
        });
        Object.defineProperty(this, "Ch", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][4] | 0
        });
        Object.defineProperty(this, "Cl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][5] | 0
        });
        Object.defineProperty(this, "Dh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][6] | 0
        });
        Object.defineProperty(this, "Dl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][7] | 0
        });
        Object.defineProperty(this, "Eh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][8] | 0
        });
        Object.defineProperty(this, "El", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][9] | 0
        });
        Object.defineProperty(this, "Fh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][10] | 0
        });
        Object.defineProperty(this, "Fl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][11] | 0
        });
        Object.defineProperty(this, "Gh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][12] | 0
        });
        Object.defineProperty(this, "Gl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][13] | 0
        });
        Object.defineProperty(this, "Hh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][14] | 0
        });
        Object.defineProperty(this, "Hl", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$md$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SHA384_IV"][15] | 0
        });
    }
}
const sha256 = /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createHasher"])(()=>new _SHA256(), /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["oidNist"])(0x01));
const sha512 = /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createHasher"])(()=>new _SHA512(), /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["oidNist"])(0x03));
const sha384 = /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createHasher"])(()=>new _SHA384(), /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["oidNist"])(0x02));
}),
"[project]/node_modules/@hpke/common/esm/src/curve/modular.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This file is based on noble-curves (https://github.com/paulmillr/noble-curves).
 *
 * noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-curves/blob/b9d49d2b41d550571a0c5be443ecb62109fa3373/src/abstract/modular.ts
 */ /**
 * Utils for modular division and fields.
 * Field over 11 is a finite (Galois) field is integer number operations `mod 11`.
 * There is no division: it is replaced by modular multiplicative inverse.
 * @module
 */ /*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */ // Numbers aren't used in x25519 / x448 builds
// prettier-ignore
__turbopack_context__.s([
    "mod",
    ()=>mod,
    "pow2",
    ()=>pow2
]);
const _0n = /* @__PURE__ */ BigInt(0);
function mod(a, b) {
    const result = a % b;
    return result >= _0n ? result : b + result;
}
function pow2(x, power, modulo) {
    let res = x;
    while(power-- > _0n){
        res *= res;
        res %= modulo;
    }
    return res;
}
}),
"[project]/node_modules/@hpke/common/esm/src/curve/curve.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This file is based on noble-curves (https://github.com/paulmillr/noble-curves).
 *
 * noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-curves/blob/b9d49d2b41d550571a0c5be443ecb62109fa3373/src/abstract/curve.ts
 */ __turbopack_context__.s([
    "createKeygen",
    ()=>createKeygen
]);
function createKeygen(// deno-lint-ignore ban-types
randomSecretKey, getPublicKey) {
    return function keygen(seed) {
        const secretKey = randomSecretKey(seed);
        return {
            secretKey,
            publicKey: getPublicKey(secretKey)
        };
    };
}
}),
"[project]/node_modules/@hpke/common/esm/src/curve/montgomery.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This file is based on noble-curves (https://github.com/paulmillr/noble-curves).
 *
 * noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-curves/blob/b9d49d2b41d550571a0c5be443ecb62109fa3373/src/abstract/montgomery.ts
 */ /**
 * Montgomery curve methods. It's not really whole montgomery curve,
 * just bunch of very specific methods for X25519 / X448 from
 * [RFC 7748](https://www.rfc-editor.org/rfc/rfc7748)
 * @module
 */ /*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */ __turbopack_context__.s([
    "montgomery",
    ()=>montgomery
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/noble.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$curve$2f$curve$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/curve/curve.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$curve$2f$modular$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/curve/modular.js [app-client] (ecmascript)");
;
;
;
const _0n = BigInt(0);
const _1n = BigInt(1);
const _2n = BigInt(2);
function validateOpts(curve) {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["validateObject"])(curve, {
        adjustScalarBytes: "function",
        powPminus2: "function"
    });
    return Object.freeze({
        ...curve
    });
}
function montgomery(curveDef) {
    const CURVE = validateOpts(curveDef);
    const { P, type, adjustScalarBytes, powPminus2, randomBytes: rand } = CURVE;
    const is25519 = type === "x25519";
    if (!is25519 && type !== "x448") throw new Error("invalid type");
    const randomBytes_ = rand || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["randomBytesAsync"];
    const montgomeryBits = is25519 ? 255 : 448;
    const fieldLen = is25519 ? 32 : 56;
    const Gu = is25519 ? BigInt(9) : BigInt(5);
    // RFC 7748 #5:
    // The constant a24 is (486662 - 2) / 4 = 121665 for curve25519/X25519 and
    // (156326 - 2) / 4 = 39081 for curve448/X448
    // const a = is25519 ? 156326n : 486662n;
    const a24 = is25519 ? BigInt(121665) : BigInt(39081);
    // RFC: x25519 "the resulting integer is of the form 2^254 plus
    // eight times a value between 0 and 2^251 - 1 (inclusive)"
    // x448: "2^447 plus four times a value between 0 and 2^445 - 1 (inclusive)"
    const minScalar = is25519 ? _2n ** BigInt(254) : _2n ** BigInt(447);
    const maxAdded = is25519 ? BigInt(8) * _2n ** BigInt(251) - _1n : BigInt(4) * _2n ** BigInt(445) - _1n;
    const maxScalar = minScalar + maxAdded + _1n; // (inclusive)
    const modP = (n)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$curve$2f$modular$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["mod"])(n, P);
    const GuBytes = encodeU(Gu);
    function encodeU(u) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["numberToBytesLE"])(modP(u), fieldLen);
    }
    function decodeU(u) {
        const _u = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["copyBytes"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(u, fieldLen, "uCoordinate"));
        // RFC: When receiving such an array, implementations of X25519
        // (but not X448) MUST mask the most significant bit in the final byte.
        if (is25519) _u[31] &= 127; // 0b0111_1111
        // RFC: Implementations MUST accept non-canonical values and process them as
        // if they had been reduced modulo the field prime.  The non-canonical
        // values are 2^255 - 19 through 2^255 - 1 for X25519 and 2^448 - 2^224
        // - 1 through 2^448 - 1 for X448.
        return modP((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["bytesToNumberLE"])(_u));
    }
    function decodeScalar(scalar) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["bytesToNumberLE"])(adjustScalarBytes((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["copyBytes"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(scalar, fieldLen, "scalar"))));
    }
    function scalarMult(scalar, u) {
        const pu = montgomeryLadder(decodeU(u), decodeScalar(scalar));
        // Some public keys are useless, of low-order. Curve author doesn't think
        // it needs to be validated, but we do it nonetheless.
        // https://cr.yp.to/ecdh.html#validate
        if (pu === _0n) throw new Error("invalid private or public key received");
        return encodeU(pu);
    }
    // Computes public key from private. By doing scalar multiplication of base point.
    function scalarMultBase(scalar) {
        return scalarMult(scalar, GuBytes);
    }
    const getPublicKey = scalarMultBase;
    const getSharedSecret = scalarMult;
    // cswap from RFC7748 "example code"
    function cswap(swap, x_2, x_3) {
        // dummy = mask(swap) AND (x_2 XOR x_3)
        // Where mask(swap) is the all-1 or all-0 word of the same length as x_2
        // and x_3, computed, e.g., as mask(swap) = 0 - swap.
        const dummy = modP(swap * (x_2 - x_3));
        x_2 = modP(x_2 - dummy); // x_2 = x_2 XOR dummy
        x_3 = modP(x_3 + dummy); // x_3 = x_3 XOR dummy
        return {
            x_2,
            x_3
        };
    }
    /**
     * Montgomery x-only multiplication ladder.
     * @param pointU u coordinate (x) on Montgomery Curve 25519
     * @param scalar by which the point would be multiplied
     * @returns new Point on Montgomery curve
     */ function montgomeryLadder(u, scalar) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aInRange"])("u", u, _0n, P);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aInRange"])("scalar", scalar, minScalar, maxScalar);
        const k = scalar;
        const x_1 = u;
        let x_2 = _1n;
        let z_2 = _0n;
        let x_3 = u;
        let z_3 = _1n;
        let swap = _0n;
        for(let t = BigInt(montgomeryBits - 1); t >= _0n; t--){
            const k_t = k >> t & _1n;
            swap ^= k_t;
            ({ x_2, x_3 } = cswap(swap, x_2, x_3));
            ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));
            swap = k_t;
            const A = x_2 + z_2;
            const AA = modP(A * A);
            const B = x_2 - z_2;
            const BB = modP(B * B);
            const E = AA - BB;
            const C = x_3 + z_3;
            const D = x_3 - z_3;
            const DA = modP(D * A);
            const CB = modP(C * B);
            const dacb = DA + CB;
            const da_cb = DA - CB;
            x_3 = modP(dacb * dacb);
            z_3 = modP(x_1 * modP(da_cb * da_cb));
            x_2 = modP(AA * BB);
            z_2 = modP(E * (AA + modP(a24 * E)));
        }
        ({ x_2, x_3 } = cswap(swap, x_2, x_3));
        ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));
        const z2 = powPminus2(z_2); // `Fp.pow(x, P - _2n)` is much slower equivalent
        return modP(x_2 * z2); // Return x_2 * (z_2^(p - 2))
    }
    const lengths = {
        secretKey: fieldLen,
        publicKey: fieldLen,
        seed: fieldLen
    };
    const randomSecretKey = async (seed)=>{
        if (seed === undefined) {
            seed = await randomBytes_(fieldLen);
        }
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$noble$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(seed, lengths.seed, "seed");
        return seed;
    };
    const utils = {
        randomSecretKey
    };
    return Object.freeze({
        keygen: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$curve$2f$curve$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createKeygen"])(randomSecretKey, getPublicKey),
        getSharedSecret,
        getPublicKey,
        scalarMult,
        scalarMultBase,
        utils,
        GuBytes: GuBytes.slice(),
        lengths
    });
}
}),
"[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kems/dhkem.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$ec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kems/dhkemPrimitives/ec.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$hybridkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kems/hybridkem.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/xCryptoKey.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kdfs/hkdf.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$aeadEncryptionContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/aeadEncryptionContext.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$kemInterface$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/kemInterface.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$hmac$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/hash/hmac.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$hash$2f$sha2$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/hash/sha2.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$curve$2f$modular$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/curve/modular.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$curve$2f$montgomery$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/curve/montgomery.js [app-client] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
;
}),
"[project]/node_modules/@hpke/core/esm/src/aeads/aesGcm.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Aes128Gcm",
    ()=>Aes128Gcm,
    "Aes256Gcm",
    ()=>Aes256Gcm,
    "AesGcmContext",
    ()=>AesGcmContext
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$aeadEncryptionContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/aeadEncryptionContext.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)");
;
class AesGcmContext extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NativeAlgorithm"] {
    async seal(iv, data, aad) {
        await this._setupKey();
        const alg = {
            name: "AES-GCM",
            iv: iv,
            additionalData: aad
        };
        const ct = await this._api.encrypt(alg, this._key, data);
        return ct;
    }
    async open(iv, data, aad) {
        await this._setupKey();
        const alg = {
            name: "AES-GCM",
            iv: iv,
            additionalData: aad
        };
        const pt = await this._api.decrypt(alg, this._key, data);
        return pt;
    }
    async _setupKey() {
        if (this._key !== undefined) {
            return;
        }
        await this._setup();
        const key = await this._importKey(this._rawKey);
        new Uint8Array(this._rawKey).fill(0);
        this._key = key;
        return;
    }
    async _importKey(key) {
        return await this._api.importKey("raw", key, {
            name: "AES-GCM"
        }, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$aeadEncryptionContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AEAD_USAGES"]);
    }
    constructor(key){
        super();
        Object.defineProperty(this, "_rawKey", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_key", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
        this._rawKey = key;
    }
}
class Aes128Gcm {
    createEncryptionContext(key) {
        return new AesGcmContext(key);
    }
    constructor(){
        /** AeadId.Aes128Gcm (0x0001) */ Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AeadId"].Aes128Gcm
        });
        /** 16 */ Object.defineProperty(this, "keySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 16
        });
        /** 12 */ Object.defineProperty(this, "nonceSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 12
        });
        /** 16 */ Object.defineProperty(this, "tagSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 16
        });
    }
}
class Aes256Gcm extends Aes128Gcm {
    constructor(){
        super(...arguments);
        /** AeadId.Aes256Gcm (0x0002) */ Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AeadId"].Aes256Gcm
        });
        /** 32 */ Object.defineProperty(this, "keySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        /** 12 */ Object.defineProperty(this, "nonceSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 12
        });
        /** 16 */ Object.defineProperty(this, "tagSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 16
        });
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/aeads/exportOnly.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ExportOnly",
    ()=>ExportOnly
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
;
class ExportOnly {
    createEncryptionContext(_key) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"]("Export only");
    }
    constructor(){
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AeadId"].ExportOnly
        });
        Object.defineProperty(this, "keySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "nonceSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "tagSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/utils/emitNotSupported.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "emitNotSupported",
    ()=>emitNotSupported
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
;
function emitNotSupported() {
    return new Promise((_resolve, reject)=>{
        reject(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"]("Not supported"));
    });
}
}),
"[project]/node_modules/@hpke/core/esm/src/exporterContext.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ExporterContextImpl",
    ()=>ExporterContextImpl,
    "RecipientExporterContextImpl",
    ()=>RecipientExporterContextImpl,
    "SenderExporterContextImpl",
    ()=>SenderExporterContextImpl
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$utils$2f$emitNotSupported$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/utils/emitNotSupported.js [app-client] (ecmascript)");
;
;
// b"sec"
const LABEL_SEC = new Uint8Array([
    115,
    101,
    99
]);
class ExporterContextImpl {
    async seal(_data, _aad) {
        return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$utils$2f$emitNotSupported$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["emitNotSupported"])();
    }
    async open(_data, _aad) {
        return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$utils$2f$emitNotSupported$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["emitNotSupported"])();
    }
    async export(exporterContext, len) {
        if (exporterContext.byteLength > __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["INPUT_LENGTH_LIMIT"]) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Too long exporter context");
        }
        try {
            return await this._kdf.labeledExpand(this.exporterSecret, LABEL_SEC, new Uint8Array(exporterContext), len);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["ExportError"](e);
        }
    }
    constructor(api, kdf, exporterSecret){
        Object.defineProperty(this, "_api", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "exporterSecret", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_kdf", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this._api = api;
        this._kdf = kdf;
        this.exporterSecret = exporterSecret;
    }
}
class RecipientExporterContextImpl extends ExporterContextImpl {
}
class SenderExporterContextImpl extends ExporterContextImpl {
    constructor(api, kdf, exporterSecret, enc){
        super(api, kdf, exporterSecret);
        Object.defineProperty(this, "enc", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.enc = enc;
        return;
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/encryptionContext.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "EncryptionContextImpl",
    ()=>EncryptionContextImpl
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$exporterContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/exporterContext.js [app-client] (ecmascript)");
;
;
class EncryptionContextImpl extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$exporterContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["ExporterContextImpl"] {
    computeNonce(k) {
        const seqBytes = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["i2Osp"])(k.seq, k.baseNonce.byteLength);
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["xor"])(k.baseNonce, seqBytes).buffer;
    }
    incrementSeq(k) {
        // if (this.seq >= (1 << (8 * this.baseNonce.byteLength)) - 1) {
        if (k.seq > Number.MAX_SAFE_INTEGER) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MessageLimitReachedError"]("Message limit reached");
        }
        k.seq += 1;
        return;
    }
    constructor(api, kdf, params){
        super(api, kdf, params.exporterSecret);
        // AEAD id.
        Object.defineProperty(this, "_aead", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // The length in bytes of a key for the algorithm.
        Object.defineProperty(this, "_nK", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // The length in bytes of a nonce for the algorithm.
        Object.defineProperty(this, "_nN", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // The length in bytes of an authentication tag for the algorithm.
        Object.defineProperty(this, "_nT", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // The end-to-end encryption key information.
        Object.defineProperty(this, "_ctx", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        if (params.key === undefined || params.baseNonce === undefined || params.seq === undefined) {
            throw new Error("Required parameters are missing");
        }
        this._aead = params.aead;
        this._nK = this._aead.keySize;
        this._nN = this._aead.nonceSize;
        this._nT = this._aead.tagSize;
        const key = this._aead.createEncryptionContext(params.key);
        this._ctx = {
            key: key,
            baseNonce: params.baseNonce,
            seq: params.seq
        };
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/recipientContext.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "RecipientContextImpl",
    ()=>RecipientContextImpl
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$encryptionContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/encryptionContext.js [app-client] (ecmascript)");
;
;
class RecipientContextImpl extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$encryptionContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EncryptionContextImpl"] {
    async open(data) {
        let aad = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer;
        let pt;
        try {
            pt = await this._ctx.key.open(this.computeNonce(this._ctx), data, aad);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["OpenError"](e);
        }
        this.incrementSeq(this._ctx);
        return pt;
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/senderContext.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "SenderContextImpl",
    ()=>SenderContextImpl
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$encryptionContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/encryptionContext.js [app-client] (ecmascript)");
;
;
class SenderContextImpl extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$encryptionContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EncryptionContextImpl"] {
    async seal(data) {
        let aad = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer;
        let ct;
        try {
            ct = await this._ctx.key.seal(this.computeNonce(this._ctx), data, aad);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SealError"](e);
        }
        this.incrementSeq(this._ctx);
        return ct;
    }
    constructor(api, kdf, params, enc){
        super(api, kdf, params);
        Object.defineProperty(this, "enc", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.enc = enc;
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/cipherSuiteNative.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CipherSuiteNative",
    ()=>CipherSuiteNative
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$exporterContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/exporterContext.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$recipientContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/recipientContext.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$senderContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/senderContext.js [app-client] (ecmascript)");
;
;
;
;
// b"base_nonce"
// deno-fmt-ignore
const LABEL_BASE_NONCE = new Uint8Array([
    98,
    97,
    115,
    101,
    95,
    110,
    111,
    110,
    99,
    101
]);
// b"exp"
const LABEL_EXP = new Uint8Array([
    101,
    120,
    112
]);
// b"info_hash"
// deno-fmt-ignore
const LABEL_INFO_HASH = new Uint8Array([
    105,
    110,
    102,
    111,
    95,
    104,
    97,
    115,
    104
]);
// b"key"
const LABEL_KEY = new Uint8Array([
    107,
    101,
    121
]);
// b"psk_id_hash"
// deno-fmt-ignore
const LABEL_PSK_ID_HASH = new Uint8Array([
    112,
    115,
    107,
    95,
    105,
    100,
    95,
    104,
    97,
    115,
    104
]);
// b"secret"
const LABEL_SECRET = new Uint8Array([
    115,
    101,
    99,
    114,
    101,
    116
]);
// b"HPKE"
// deno-fmt-ignore
const SUITE_ID_HEADER_HPKE = new Uint8Array([
    72,
    80,
    75,
    69,
    0,
    0,
    0,
    0,
    0,
    0
]);
class CipherSuiteNative extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NativeAlgorithm"] {
    /**
     * Gets the KEM context of the ciphersuite.
     */ get kem() {
        return this._kem;
    }
    /**
     * Gets the KDF context of the ciphersuite.
     */ get kdf() {
        return this._kdf;
    }
    /**
     * Gets the AEAD context of the ciphersuite.
     */ get aead() {
        return this._aead;
    }
    /**
     * Creates an encryption context for a sender.
     *
     * If the error occurred, throws {@link DecapError} | {@link ValidationError}.
     *
     * @param params A set of parameters for the sender encryption context.
     * @returns A sender encryption context.
     * @throws {@link EncapError}, {@link ValidationError}
     */ async createSenderContext(params) {
        this._validateInputLength(params);
        await this._setup();
        const dh = await this._kem.encap(params);
        let mode;
        if (params.psk !== undefined) {
            mode = params.senderKey !== undefined ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].AuthPsk : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].Psk;
        } else {
            mode = params.senderKey !== undefined ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].Auth : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].Base;
        }
        return await this._keyScheduleS(mode, dh.sharedSecret, dh.enc, params);
    }
    /**
     * Creates an encryption context for a recipient.
     *
     * If the error occurred, throws {@link DecapError}
     * | {@link DeserializeError} | {@link ValidationError}.
     *
     * @param params A set of parameters for the recipient encryption context.
     * @returns A recipient encryption context.
     * @throws {@link DecapError}, {@link DeserializeError}, {@link ValidationError}
     */ async createRecipientContext(params) {
        this._validateInputLength(params);
        await this._setup();
        const sharedSecret = await this._kem.decap(params);
        let mode;
        if (params.psk !== undefined) {
            mode = params.senderPublicKey !== undefined ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].AuthPsk : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].Psk;
        } else {
            mode = params.senderPublicKey !== undefined ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].Auth : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Mode"].Base;
        }
        return await this._keyScheduleR(mode, sharedSecret, params);
    }
    /**
     * Encrypts a message to a recipient.
     *
     * If the error occurred, throws `EncapError` | `MessageLimitReachedError` | `SealError` | `ValidationError`.
     *
     * @param params A set of parameters for building a sender encryption context.
     * @param pt A plain text as bytes to be encrypted.
     * @param aad Additional authenticated data as bytes fed by an application.
     * @returns A cipher text and an encapsulated key as bytes.
     * @throws {@link EncapError}, {@link MessageLimitReachedError}, {@link SealError}, {@link ValidationError}
     */ async seal(params, pt) {
        let aad = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer;
        const ctx = await this.createSenderContext(params);
        return {
            ct: await ctx.seal(pt, aad),
            enc: ctx.enc
        };
    }
    /**
     * Decrypts a message from a sender.
     *
     * If the error occurred, throws `DecapError` | `DeserializeError` | `OpenError` | `ValidationError`.
     *
     * @param params A set of parameters for building a recipient encryption context.
     * @param ct An encrypted text as bytes to be decrypted.
     * @param aad Additional authenticated data as bytes fed by an application.
     * @returns A decrypted plain text as bytes.
     * @throws {@link DecapError}, {@link DeserializeError}, {@link OpenError}, {@link ValidationError}
     */ async open(params, ct) {
        let aad = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer;
        const ctx = await this.createRecipientContext(params);
        return await ctx.open(ct, aad);
    }
    // private verifyPskInputs(mode: Mode, params: KeyScheduleParams) {
    //   const gotPsk = (params.psk !== undefined);
    //   const gotPskId = (params.psk !== undefined && params.psk.id.byteLength > 0);
    //   if (gotPsk !== gotPskId) {
    //     throw new Error('Inconsistent PSK inputs');
    //   }
    //   if (gotPsk && (mode === Mode.Base || mode === Mode.Auth)) {
    //     throw new Error('PSK input provided when not needed');
    //   }
    //   if (!gotPsk && (mode === Mode.Psk || mode === Mode.AuthPsk)) {
    //     throw new Error('Missing required PSK input');
    //   }
    //   return;
    // }
    async _keySchedule(mode, sharedSecret, params) {
        // Currently, there is no point in executing this function
        // because this hpke library does not allow users to explicitly specify the mode.
        //
        // this.verifyPskInputs(mode, params);
        const pskId = params.psk === undefined ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"] : new Uint8Array(params.psk.id);
        const pskIdHash = await this._kdf.labeledExtract(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer, LABEL_PSK_ID_HASH, pskId);
        const info = params.info === undefined ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"] : new Uint8Array(params.info);
        const infoHash = await this._kdf.labeledExtract(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer, LABEL_INFO_HASH, info);
        const keyScheduleContext = new Uint8Array(1 + pskIdHash.byteLength + infoHash.byteLength);
        keyScheduleContext.set(new Uint8Array([
            mode
        ]), 0);
        keyScheduleContext.set(new Uint8Array(pskIdHash), 1);
        keyScheduleContext.set(new Uint8Array(infoHash), 1 + pskIdHash.byteLength);
        const psk = params.psk === undefined ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"] : new Uint8Array(params.psk.key);
        const ikm = this._kdf.buildLabeledIkm(LABEL_SECRET, psk).buffer;
        const exporterSecretInfo = this._kdf.buildLabeledInfo(LABEL_EXP, keyScheduleContext, this._kdf.hashSize).buffer;
        const exporterSecret = await this._kdf.extractAndExpand(sharedSecret, ikm, exporterSecretInfo, this._kdf.hashSize);
        if (this._aead.id === __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AeadId"].ExportOnly) {
            return {
                aead: this._aead,
                exporterSecret: exporterSecret
            };
        }
        const keyInfo = this._kdf.buildLabeledInfo(LABEL_KEY, keyScheduleContext, this._aead.keySize).buffer;
        const key = await this._kdf.extractAndExpand(sharedSecret, ikm, keyInfo, this._aead.keySize);
        const baseNonceInfo = this._kdf.buildLabeledInfo(LABEL_BASE_NONCE, keyScheduleContext, this._aead.nonceSize).buffer;
        const baseNonce = await this._kdf.extractAndExpand(sharedSecret, ikm, baseNonceInfo, this._aead.nonceSize);
        return {
            aead: this._aead,
            exporterSecret: exporterSecret,
            key: key,
            baseNonce: new Uint8Array(baseNonce),
            seq: 0
        };
    }
    async _keyScheduleS(mode, sharedSecret, enc, params) {
        const res = await this._keySchedule(mode, sharedSecret, params);
        if (res.key === undefined) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$exporterContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SenderExporterContextImpl"](this._api, this._kdf, res.exporterSecret, enc);
        }
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$senderContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SenderContextImpl"](this._api, this._kdf, res, enc);
    }
    async _keyScheduleR(mode, sharedSecret, params) {
        const res = await this._keySchedule(mode, sharedSecret, params);
        if (res.key === undefined) {
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$exporterContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["RecipientExporterContextImpl"](this._api, this._kdf, res.exporterSecret);
        }
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$recipientContext$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["RecipientContextImpl"](this._api, this._kdf, res);
    }
    _validateInputLength(params) {
        if (params.info !== undefined && params.info.byteLength > __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["INFO_LENGTH_LIMIT"]) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Too long info");
        }
        if (params.psk !== undefined) {
            if (params.psk.key.byteLength < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MINIMUM_PSK_LENGTH"]) {
                throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("PSK must have at least ".concat(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MINIMUM_PSK_LENGTH"], " bytes"));
            }
            if (params.psk.key.byteLength > __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["INPUT_LENGTH_LIMIT"]) {
                throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Too long psk.key");
            }
            if (params.psk.id.byteLength > __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["INPUT_LENGTH_LIMIT"]) {
                throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Too long psk.id");
            }
        }
        return;
    }
    /**
     * @param params A set of parameters for building a cipher suite.
     *
     * If the error occurred, throws {@link InvalidParamError}.
     *
     * @throws {@link InvalidParamError}
     */ constructor(params){
        super();
        Object.defineProperty(this, "_kem", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_kdf", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_aead", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_suiteId", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // KEM
        if (typeof params.kem === "number") {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("KemId cannot be used");
        }
        this._kem = params.kem;
        // KDF
        if (typeof params.kdf === "number") {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("KdfId cannot be used");
        }
        this._kdf = params.kdf;
        // AEAD
        if (typeof params.aead === "number") {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("AeadId cannot be used");
        }
        this._aead = params.aead;
        this._suiteId = new Uint8Array(SUITE_ID_HEADER_HPKE);
        this._suiteId.set((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["i2Osp"])(this._kem.id, 2), 4);
        this._suiteId.set((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["i2Osp"])(this._kdf.id, 2), 6);
        this._suiteId.set((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["i2Osp"])(this._aead.id, 2), 8);
        this._kdf.init(this._suiteId);
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/kems/dhkemNative.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "DhkemP256HkdfSha256Native",
    ()=>DhkemP256HkdfSha256Native,
    "DhkemP384HkdfSha384Native",
    ()=>DhkemP384HkdfSha384Native,
    "DhkemP521HkdfSha512Native",
    ()=>DhkemP521HkdfSha512Native
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kems/dhkem.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$ec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kems/dhkemPrimitives/ec.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kdfs/hkdf.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
;
class DhkemP256HkdfSha256Native extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Dhkem"] {
    constructor(){
        const kdf = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha256Native"]();
        const prim = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$ec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Ec"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP256HkdfSha256, kdf);
        super(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP256HkdfSha256, prim, kdf);
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP256HkdfSha256
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 65
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 65
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
    }
}
class DhkemP384HkdfSha384Native extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Dhkem"] {
    constructor(){
        const kdf = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha384Native"]();
        const prim = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$ec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Ec"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP384HkdfSha384, kdf);
        super(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP384HkdfSha384, prim, kdf);
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP384HkdfSha384
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 48
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 97
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 97
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 48
        });
    }
}
class DhkemP521HkdfSha512Native extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Dhkem"] {
    constructor(){
        const kdf = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha512Native"]();
        const prim = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$ec$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Ec"](__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP521HkdfSha512, kdf);
        super(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP521HkdfSha512, prim, kdf);
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemP521HkdfSha512
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 64
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 133
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 133
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 64
        });
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/native.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CipherSuite",
    ()=>CipherSuite,
    "DhkemP256HkdfSha256",
    ()=>DhkemP256HkdfSha256,
    "DhkemP384HkdfSha384",
    ()=>DhkemP384HkdfSha384,
    "DhkemP521HkdfSha512",
    ()=>DhkemP521HkdfSha512,
    "HkdfSha256",
    ()=>HkdfSha256,
    "HkdfSha384",
    ()=>HkdfSha384,
    "HkdfSha512",
    ()=>HkdfSha512
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kdfs/hkdf.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$cipherSuiteNative$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/cipherSuiteNative.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemNative$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/kems/dhkemNative.js [app-client] (ecmascript)");
;
;
;
class CipherSuite extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$cipherSuiteNative$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CipherSuiteNative"] {
}
class DhkemP256HkdfSha256 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemNative$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DhkemP256HkdfSha256Native"] {
}
class DhkemP384HkdfSha384 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemNative$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DhkemP384HkdfSha384Native"] {
}
class DhkemP521HkdfSha512 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemNative$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DhkemP521HkdfSha512Native"] {
}
class HkdfSha256 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha256Native"] {
}
class HkdfSha384 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha384Native"] {
}
class HkdfSha512 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha512Native"] {
}
}),
"[project]/node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x25519.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "X25519",
    ()=>X25519
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)");
;
const ALG_NAME = "X25519";
// deno-fmt-ignore
const PKCS8_ALG_ID_X25519 = new Uint8Array([
    0x30,
    0x2e,
    0x02,
    0x01,
    0x00,
    0x30,
    0x05,
    0x06,
    0x03,
    0x2b,
    0x65,
    0x6e,
    0x04,
    0x22,
    0x04,
    0x20
]);
class X25519 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NativeAlgorithm"] {
    async serializePublicKey(key) {
        await this._setup();
        try {
            return await this._api.exportKey("raw", key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePublicKey(key) {
        await this._setup();
        try {
            return await this._importRawKey(key, true);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async serializePrivateKey(key) {
        await this._setup();
        try {
            const jwk = await this._api.exportKey("jwk", key);
            if (!("d" in jwk)) {
                throw new Error("Not private key");
            }
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64UrlToBytes"])(jwk["d"]).buffer;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePrivateKey(key) {
        await this._setup();
        try {
            return await this._importRawKey(key, false);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async importKey(format, key, isPublic) {
        await this._setup();
        try {
            if (format === "raw") {
                return await this._importRawKey(key, isPublic);
            }
            // jwk
            if (key instanceof ArrayBuffer) {
                throw new Error("Invalid jwk key format");
            }
            return await this._importJWK(key, isPublic);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async generateKeyPair() {
        await this._setup();
        try {
            return await this._api.generateKey(ALG_NAME, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"](e);
        }
    }
    async deriveKeyPair(ikm) {
        await this._setup();
        try {
            const dkpPrk = await this._hkdf.labeledExtract(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LABEL_DKP_PRK"], new Uint8Array(ikm));
            const rawSk = await this._hkdf.labeledExpand(dkpPrk, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LABEL_SK"], __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"], this._nSk);
            const rawSkBytes = new Uint8Array(rawSk);
            const sk = await this._deserializePkcs8Key(rawSkBytes);
            rawSkBytes.fill(0);
            return {
                privateKey: sk,
                publicKey: await this.derivePublicKey(sk)
            };
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeriveKeyPairError"](e);
        }
    }
    async derivePublicKey(key) {
        await this._setup();
        try {
            const jwk = await this._api.exportKey("jwk", key);
            delete jwk["d"];
            delete jwk["key_ops"];
            return await this._api.importKey("jwk", jwk, this._alg, true, []);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async dh(sk, pk) {
        await this._setup();
        try {
            const bits = await this._api.deriveBits({
                name: ALG_NAME,
                public: pk
            }, sk, this._nDh * 8);
            return bits;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async _importRawKey(key, isPublic) {
        if (isPublic && key.byteLength !== this._nPk) {
            throw new Error("Invalid public key for the ciphersuite");
        }
        if (!isPublic && key.byteLength !== this._nSk) {
            throw new Error("Invalid private key for the ciphersuite");
        }
        if (isPublic) {
            return await this._api.importKey("raw", key, this._alg, true, []);
        }
        return await this._deserializePkcs8Key(new Uint8Array(key));
    }
    async _importJWK(key, isPublic) {
        if (typeof key.kty === "undefined" || key.kty !== "OKP") {
            throw new Error("Invalid kty: ".concat(key.crv));
        }
        if (typeof key.crv === "undefined" || key.crv !== ALG_NAME) {
            throw new Error("Invalid crv: ".concat(key.crv));
        }
        if (isPublic) {
            if (typeof key.d !== "undefined") {
                throw new Error("Invalid key: `d` should not be set");
            }
            return await this._api.importKey("jwk", key, this._alg, true, []);
        }
        if (typeof key.d === "undefined") {
            throw new Error("Invalid key: `d` not found");
        }
        return await this._api.importKey("jwk", key, this._alg, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
    }
    async _deserializePkcs8Key(k) {
        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);
        pkcs8Key.set(this._pkcs8AlgId, 0);
        pkcs8Key.set(k, this._pkcs8AlgId.length);
        return await this._api.importKey("pkcs8", pkcs8Key, this._alg, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
    }
    constructor(hkdf){
        super();
        Object.defineProperty(this, "_hkdf", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_alg", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nPk", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nSk", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nDh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_pkcs8AlgId", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this._alg = {
            name: ALG_NAME
        };
        this._hkdf = hkdf;
        this._nPk = 32;
        this._nSk = 32;
        this._nDh = 32;
        this._pkcs8AlgId = PKCS8_ALG_ID_X25519;
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/kems/dhkemX25519.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "DhkemX25519HkdfSha256",
    ()=>DhkemX25519HkdfSha256
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kems/dhkem.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kdfs/hkdf.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$x25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x25519.js [app-client] (ecmascript)");
;
;
class DhkemX25519HkdfSha256 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Dhkem"] {
    constructor(){
        const kdf = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha256Native"]();
        super(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemX25519HkdfSha256, new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$x25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["X25519"](kdf), kdf);
        /** KemId.DhkemX25519HkdfSha256 (0x0020) */ Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemX25519HkdfSha256
        });
        /** 32 */ Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        /** 32 */ Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        /** 32 */ Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        /** 32 */ Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x448.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "X448",
    ()=>X448
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/algorithm.js [app-client] (ecmascript)");
;
const ALG_NAME = "X448";
// deno-fmt-ignore
const PKCS8_ALG_ID_X448 = new Uint8Array([
    0x30,
    0x46,
    0x02,
    0x01,
    0x00,
    0x30,
    0x05,
    0x06,
    0x03,
    0x2b,
    0x65,
    0x6f,
    0x04,
    0x3a,
    0x04,
    0x38
]);
class X448 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$algorithm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NativeAlgorithm"] {
    async serializePublicKey(key) {
        await this._setup();
        try {
            return await this._api.exportKey("raw", key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePublicKey(key) {
        await this._setup();
        try {
            return await this._importRawKey(key, true);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async serializePrivateKey(key) {
        await this._setup();
        try {
            const jwk = await this._api.exportKey("jwk", key);
            if (!("d" in jwk)) {
                throw new Error("Not private key");
            }
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64UrlToBytes"])(jwk["d"]).buffer;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePrivateKey(key) {
        await this._setup();
        try {
            return await this._importRawKey(key, false);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async importKey(format, key, isPublic) {
        await this._setup();
        try {
            if (format === "raw") {
                return await this._importRawKey(key, isPublic);
            }
            // jwk
            if (key instanceof ArrayBuffer) {
                throw new Error("Invalid jwk key format");
            }
            return await this._importJWK(key, isPublic);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async generateKeyPair() {
        await this._setup();
        try {
            return await this._api.generateKey(ALG_NAME, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"](e);
        }
    }
    async deriveKeyPair(ikm) {
        await this._setup();
        try {
            const dkpPrk = await this._hkdf.labeledExtract(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"].buffer, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LABEL_DKP_PRK"], new Uint8Array(ikm));
            const rawSk = await this._hkdf.labeledExpand(dkpPrk, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LABEL_SK"], __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EMPTY"], this._nSk);
            const rawSkBytes = new Uint8Array(rawSk);
            const sk = await this._deserializePkcs8Key(rawSkBytes);
            rawSkBytes.fill(0);
            return {
                privateKey: sk,
                publicKey: await this.derivePublicKey(sk)
            };
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeriveKeyPairError"](e);
        }
    }
    async derivePublicKey(key) {
        await this._setup();
        try {
            const jwk = await this._api.exportKey("jwk", key);
            delete jwk["d"];
            delete jwk["key_ops"];
            return await this._api.importKey("jwk", jwk, this._alg, true, []);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async dh(sk, pk) {
        await this._setup();
        try {
            const bits = await this._api.deriveBits({
                name: ALG_NAME,
                public: pk
            }, sk, this._nDh * 8);
            return bits;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async _importRawKey(key, isPublic) {
        if (isPublic && key.byteLength !== this._nPk) {
            throw new Error("Invalid public key for the ciphersuite");
        }
        if (!isPublic && key.byteLength !== this._nSk) {
            throw new Error("Invalid private key for the ciphersuite");
        }
        if (isPublic) {
            return await this._api.importKey("raw", key, this._alg, true, []);
        }
        return await this._deserializePkcs8Key(new Uint8Array(key));
    }
    async _importJWK(key, isPublic) {
        if (typeof key.kty === "undefined" || key.kty !== "OKP") {
            throw new Error("Invalid kty: ".concat(key.crv));
        }
        if (typeof key.crv === "undefined" || key.crv !== ALG_NAME) {
            throw new Error("Invalid crv: ".concat(key.crv));
        }
        if (isPublic) {
            if (typeof key.d !== "undefined") {
                throw new Error("Invalid key: `d` should not be set");
            }
            return await this._api.importKey("jwk", key, this._alg, true, []);
        }
        if (typeof key.d === "undefined") {
            throw new Error("Invalid key: `d` not found");
        }
        return await this._api.importKey("jwk", key, this._alg, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
    }
    async _deserializePkcs8Key(k) {
        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);
        pkcs8Key.set(this._pkcs8AlgId, 0);
        pkcs8Key.set(k, this._pkcs8AlgId.length);
        return await this._api.importKey("pkcs8", pkcs8Key, this._alg, true, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
    }
    constructor(hkdf){
        super();
        Object.defineProperty(this, "_hkdf", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_alg", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nPk", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nSk", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_nDh", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "_pkcs8AlgId", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this._alg = {
            name: ALG_NAME
        };
        this._hkdf = hkdf;
        this._nPk = 56;
        this._nSk = 56;
        this._nDh = 56;
        this._pkcs8AlgId = PKCS8_ALG_ID_X448;
    }
}
}),
"[project]/node_modules/@hpke/core/esm/src/kems/dhkemX448.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "DhkemX448HkdfSha512",
    ()=>DhkemX448HkdfSha512
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kems/dhkem.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/kdfs/hkdf.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$x448$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x448.js [app-client] (ecmascript)");
;
;
class DhkemX448HkdfSha512 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kems$2f$dhkem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Dhkem"] {
    constructor(){
        const kdf = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$kdfs$2f$hkdf$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["HkdfSha512Native"]();
        super(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemX448HkdfSha512, new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemPrimitives$2f$x448$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["X448"](kdf), kdf);
        /** KemId.DhkemX448HkdfSha512 (0x0021) */ Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].DhkemX448HkdfSha512
        });
        /** 64 */ Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 64
        });
        /** 56 */ Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 56
        });
        /** 56 */ Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 56
        });
        /** 56 */ Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 56
        });
    }
}
}),
"[project]/node_modules/@hpke/core/esm/mod.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$aeads$2f$aesGcm$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/aeads/aesGcm.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$aeads$2f$exportOnly$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/aeads/exportOnly.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$native$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/native.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemX25519$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/kems/dhkemX25519.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$core$2f$esm$2f$src$2f$kems$2f$dhkemX448$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/core/esm/src/kems/dhkemX448.js [app-client] (ecmascript)");
;
;
;
;
;
;
}),
"[project]/node_modules/mlkem/esm/src/errors.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * The base error class of kyber-ts.
 */ __turbopack_context__.s([
    "MlKemError",
    ()=>MlKemError
]);
class MlKemError extends Error {
    constructor(e){
        let message;
        if (e instanceof Error) {
            message = e.message;
        } else if (typeof e === "string") {
            message = e;
        } else {
            message = "";
        }
        super(message);
        this.name = this.constructor.name;
    }
}
}),
"[project]/node_modules/mlkem/esm/src/consts.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This implementation is based on https://github.com/antontutoveanu/crystals-kyber-javascript,
 * which was deveploped under the MIT licence below:
 * https://github.com/antontutoveanu/crystals-kyber-javascript/blob/main/LICENSE
 */ __turbopack_context__.s([
    "N",
    ()=>N,
    "NTT_ZETAS",
    ()=>NTT_ZETAS,
    "NTT_ZETAS_INV",
    ()=>NTT_ZETAS_INV,
    "Q",
    ()=>Q,
    "Q_INV",
    ()=>Q_INV
]);
const N = 256;
const Q = 3329;
const Q_INV = 62209;
const NTT_ZETAS = [
    2285,
    2571,
    2970,
    1812,
    1493,
    1422,
    287,
    202,
    3158,
    622,
    1577,
    182,
    962,
    2127,
    1855,
    1468,
    573,
    2004,
    264,
    383,
    2500,
    1458,
    1727,
    3199,
    2648,
    1017,
    732,
    608,
    1787,
    411,
    3124,
    1758,
    1223,
    652,
    2777,
    1015,
    2036,
    1491,
    3047,
    1785,
    516,
    3321,
    3009,
    2663,
    1711,
    2167,
    126,
    1469,
    2476,
    3239,
    3058,
    830,
    107,
    1908,
    3082,
    2378,
    2931,
    961,
    1821,
    2604,
    448,
    2264,
    677,
    2054,
    2226,
    430,
    555,
    843,
    2078,
    871,
    1550,
    105,
    422,
    587,
    177,
    3094,
    3038,
    2869,
    1574,
    1653,
    3083,
    778,
    1159,
    3182,
    2552,
    1483,
    2727,
    1119,
    1739,
    644,
    2457,
    349,
    418,
    329,
    3173,
    3254,
    817,
    1097,
    603,
    610,
    1322,
    2044,
    1864,
    384,
    2114,
    3193,
    1218,
    1994,
    2455,
    220,
    2142,
    1670,
    2144,
    1799,
    2051,
    794,
    1819,
    2475,
    2459,
    478,
    3221,
    3021,
    996,
    991,
    958,
    1869,
    1522,
    1628
];
const NTT_ZETAS_INV = [
    1701,
    1807,
    1460,
    2371,
    2338,
    2333,
    308,
    108,
    2851,
    870,
    854,
    1510,
    2535,
    1278,
    1530,
    1185,
    1659,
    1187,
    3109,
    874,
    1335,
    2111,
    136,
    1215,
    2945,
    1465,
    1285,
    2007,
    2719,
    2726,
    2232,
    2512,
    75,
    156,
    3000,
    2911,
    2980,
    872,
    2685,
    1590,
    2210,
    602,
    1846,
    777,
    147,
    2170,
    2551,
    246,
    1676,
    1755,
    460,
    291,
    235,
    3152,
    2742,
    2907,
    3224,
    1779,
    2458,
    1251,
    2486,
    2774,
    2899,
    1103,
    1275,
    2652,
    1065,
    2881,
    725,
    1508,
    2368,
    398,
    951,
    247,
    1421,
    3222,
    2499,
    271,
    90,
    853,
    1860,
    3203,
    1162,
    1618,
    666,
    320,
    8,
    2813,
    1544,
    282,
    1838,
    1293,
    2314,
    552,
    2677,
    2106,
    1571,
    205,
    2918,
    1542,
    2721,
    2597,
    2312,
    681,
    130,
    1602,
    1871,
    829,
    2946,
    3065,
    1325,
    2756,
    1861,
    1474,
    1202,
    2367,
    3147,
    1752,
    2707,
    171,
    3127,
    3042,
    1907,
    1836,
    1517,
    359,
    758,
    1441
];
}),
"[project]/node_modules/mlkem/esm/src/sha3/_u64.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).
 *
 * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-hashes/blob/4e358a46d682adfb005ae6314ec999f2513086b9/src/_u64.ts
 */ /**
 * Internal helpers for u64. BigUint64Array is too slow as per 2025, so we implement it using Uint32Array.
 * @todo re-check https://issues.chromium.org/issues/42212588
 * @module
 */ __turbopack_context__.s([
    "add",
    ()=>add,
    "add3H",
    ()=>add3H,
    "add3L",
    ()=>add3L,
    "add4H",
    ()=>add4H,
    "add4L",
    ()=>add4L,
    "add5H",
    ()=>add5H,
    "add5L",
    ()=>add5L,
    "default",
    ()=>__TURBOPACK__default__export__,
    "fromBig",
    ()=>fromBig,
    "rotlBH",
    ()=>rotlBH,
    "rotlBL",
    ()=>rotlBL,
    "rotlSH",
    ()=>rotlSH,
    "rotlSL",
    ()=>rotlSL,
    "rotr32H",
    ()=>rotr32H,
    "rotr32L",
    ()=>rotr32L,
    "rotrBH",
    ()=>rotrBH,
    "rotrBL",
    ()=>rotrBL,
    "rotrSH",
    ()=>rotrSH,
    "rotrSL",
    ()=>rotrSL,
    "shrSH",
    ()=>shrSH,
    "shrSL",
    ()=>shrSL,
    "split",
    ()=>split,
    "toBig",
    ()=>toBig
]);
const U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);
const _32n = /* @__PURE__ */ BigInt(32);
function fromBig(n) {
    let le = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;
    if (le) {
        return {
            h: Number(n & U32_MASK64),
            l: Number(n >> _32n & U32_MASK64)
        };
    }
    return {
        h: Number(n >> _32n & U32_MASK64) | 0,
        l: Number(n & U32_MASK64) | 0
    };
}
function split(lst) {
    let le = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;
    const len = lst.length;
    const Ah = new Uint32Array(len);
    const Al = new Uint32Array(len);
    for(let i = 0; i < len; i++){
        const { h, l } = fromBig(lst[i], le);
        [Ah[i], Al[i]] = [
            h,
            l
        ];
    }
    return [
        Ah,
        Al
    ];
}
const toBig = (h, l)=>BigInt(h >>> 0) << _32n | BigInt(l >>> 0);
// for Shift in [0, 32)
const shrSH = (h, _l, s)=>h >>> s;
const shrSL = (h, l, s)=>h << 32 - s | l >>> s;
// Right rotate for Shift in [1, 32)
const rotrSH = (h, l, s)=>h >>> s | l << 32 - s;
const rotrSL = (h, l, s)=>h << 32 - s | l >>> s;
// Right rotate for Shift in (32, 64), NOTE: 32 is special case.
const rotrBH = (h, l, s)=>h << 64 - s | l >>> s - 32;
const rotrBL = (h, l, s)=>h >>> s - 32 | l << 64 - s;
// Right rotate for shift===32 (just swaps l&h)
const rotr32H = (_h, l)=>l;
const rotr32L = (h, _l)=>h;
// Left rotate for Shift in [1, 32)
const rotlSH = (h, l, s)=>h << s | l >>> 32 - s;
const rotlSL = (h, l, s)=>l << s | h >>> 32 - s;
// Left rotate for Shift in (32, 64), NOTE: 32 is special case.
const rotlBH = (h, l, s)=>l << s - 32 | h >>> 64 - s;
const rotlBL = (h, l, s)=>h << s - 32 | l >>> 64 - s;
// JS uses 32-bit signed integers for bitwise operations which means we cannot
// simple take carry out of low bit sum by shift, we need to use division.
function add(Ah, Al, Bh, Bl) {
    const l = (Al >>> 0) + (Bl >>> 0);
    return {
        h: Ah + Bh + (l / 2 ** 32 | 0) | 0,
        l: l | 0
    };
}
// Addition with more than 2 elements
const add3L = (Al, Bl, Cl)=>(Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);
const add3H = (low, Ah, Bh, Ch)=>Ah + Bh + Ch + (low / 2 ** 32 | 0) | 0;
const add4L = (Al, Bl, Cl, Dl)=>(Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);
const add4H = (low, Ah, Bh, Ch, Dh)=>Ah + Bh + Ch + Dh + (low / 2 ** 32 | 0) | 0;
const add5L = (Al, Bl, Cl, Dl, El)=>(Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);
const add5H = (low, Ah, Bh, Ch, Dh, Eh)=>Ah + Bh + Ch + Dh + Eh + (low / 2 ** 32 | 0) | 0;
;
// prettier-ignore
const u64 = {
    fromBig,
    split,
    toBig,
    shrSH,
    shrSL,
    rotrSH,
    rotrSL,
    rotrBH,
    rotrBL,
    rotr32H,
    rotr32L,
    rotlSH,
    rotlSL,
    rotlBH,
    rotlBL,
    add,
    add3L,
    add3H,
    add4L,
    add4H,
    add5H,
    add5L
};
const __TURBOPACK__default__export__ = u64;
}),
"[project]/node_modules/mlkem/esm/src/sha3/utils.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// deno-lint-ignore-file no-explicit-any
/**
 * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).
 *
 * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-hashes/blob/4e358a46d682adfb005ae6314ec999f2513086b9/src/utils.ts
 */ /**
 * Utilities for hex, bytes, CSPRNG.
 * @module
 */ /*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */ /** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */ __turbopack_context__.s([
    "abytes",
    ()=>abytes,
    "aexists",
    ()=>aexists,
    "anumber",
    ()=>anumber,
    "aoutput",
    ()=>aoutput,
    "byteSwap",
    ()=>byteSwap,
    "byteSwap32",
    ()=>byteSwap32,
    "byteSwapIfBE",
    ()=>byteSwapIfBE,
    "bytesToUtf8",
    ()=>bytesToUtf8,
    "clean",
    ()=>clean,
    "concatBytes",
    ()=>concatBytes,
    "createHasher",
    ()=>createHasher,
    "hexToBytes",
    ()=>hexToBytes,
    "isBytes",
    ()=>isBytes,
    "isLE",
    ()=>isLE,
    "oidNist",
    ()=>oidNist,
    "swap32IfBE",
    ()=>swap32IfBE,
    "swap8IfBE",
    ()=>swap8IfBE,
    "u32",
    ()=>u32,
    "utf8ToBytes",
    ()=>utf8ToBytes
]);
function isBytes(a) {
    return a instanceof Uint8Array || ArrayBuffer.isView(a) && a.constructor.name === "Uint8Array";
}
function anumber(n) {
    let title = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "";
    if (!Number.isSafeInteger(n) || n < 0) {
        const prefix = title && '"'.concat(title, '" ');
        throw new Error("".concat(prefix, "expected integer >0, got ").concat(n));
    }
}
function abytes(value, length) {
    let title = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : "";
    const bytes = isBytes(value);
    const len = value === null || value === void 0 ? void 0 : value.length;
    const needsLen = length !== undefined;
    if (!bytes || needsLen && len !== length) {
        const prefix = title && '"'.concat(title, '" ');
        const ofLen = needsLen ? " of length ".concat(length) : "";
        const got = bytes ? "length=".concat(len) : "type=".concat(typeof value);
        throw new Error(prefix + "expected Uint8Array" + ofLen + ", got " + got);
    }
    return value;
}
function aexists(instance) {
    let checkFinished = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;
    if (instance.destroyed) throw new Error("Hash instance has been destroyed");
    if (checkFinished && instance.finished) {
        throw new Error("Hash#digest() has already been called");
    }
}
function aoutput(out, instance) {
    abytes(out, undefined, "digestInto() output");
    const min = instance.outputLen;
    if (out.length < min) {
        throw new Error('"digestInto() output" expected to be of length >=' + min);
    }
}
function u32(arr) {
    return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));
}
function clean() {
    for(var _len = arguments.length, arrays = new Array(_len), _key = 0; _key < _len; _key++){
        arrays[_key] = arguments[_key];
    }
    for(let i = 0; i < arrays.length; i++){
        arrays[i].fill(0);
    }
}
const isLE = /* @__PURE__ */ (()=>new Uint8Array(new Uint32Array([
        0x11223344
    ]).buffer)[0] === 0x44)();
function byteSwap(word) {
    return word << 24 & 0xff000000 | word << 8 & 0xff0000 | word >>> 8 & 0xff00 | word >>> 24 & 0xff;
}
const swap8IfBE = isLE ? (n)=>n : (n)=>byteSwap(n);
const byteSwapIfBE = swap8IfBE;
function byteSwap32(arr) {
    for(let i = 0; i < arr.length; i++){
        arr[i] = byteSwap(arr[i]);
    }
    return arr;
}
const swap32IfBE = isLE ? (u)=>u : byteSwap32;
// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex
const hasHexBuiltin = /* @__PURE__ */ (()=>// @ts-ignore: to check the existence of the method
    typeof Uint8Array.from([]).toHex === "function" && // @ts-ignore: to check the existence of the method
    typeof Uint8Array.fromHex === "function")();
// We use optimized technique to convert hex string to byte array
const asciis = {
    _0: 48,
    _9: 57,
    A: 65,
    F: 70,
    a: 97,
    f: 102
};
function asciiToBase16(ch) {
    if (ch >= asciis._0 && ch <= asciis._9) return ch - asciis._0; // '2' => 50-48
    if (ch >= asciis.A && ch <= asciis.F) return ch - (asciis.A - 10); // 'B' => 66-(65-10)
    if (ch >= asciis.a && ch <= asciis.f) return ch - (asciis.a - 10); // 'b' => 98-(97-10)
    return;
}
function hexToBytes(hex) {
    if (typeof hex !== "string") {
        throw new Error("hex string expected, got " + typeof hex);
    }
    // @ts-ignore: to check the existence of the method
    if (hasHexBuiltin) return Uint8Array.fromHex(hex);
    const hl = hex.length;
    const al = hl / 2;
    if (hl % 2) {
        throw new Error("hex string expected, got unpadded hex of length " + hl);
    }
    const array = new Uint8Array(al);
    for(let ai = 0, hi = 0; ai < al; ai++, hi += 2){
        const n1 = asciiToBase16(hex.charCodeAt(hi));
        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));
        if (n1 === undefined || n2 === undefined) {
            const char = hex[hi] + hex[hi + 1];
            throw new Error('hex string expected, got non-hex character "' + char + '" at index ' + hi);
        }
        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163
    }
    return array;
}
function utf8ToBytes(str) {
    if (typeof str !== "string") throw new Error("string expected");
    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809
}
function bytesToUtf8(bytes) {
    return new TextDecoder().decode(bytes);
}
function concatBytes() {
    for(var _len = arguments.length, arrays = new Array(_len), _key = 0; _key < _len; _key++){
        arrays[_key] = arguments[_key];
    }
    let sum = 0;
    for(let i = 0; i < arrays.length; i++){
        const a = arrays[i];
        abytes(a);
        sum += a.length;
    }
    const res = new Uint8Array(sum);
    for(let i = 0, pad = 0; i < arrays.length; i++){
        const a = arrays[i];
        res.set(a, pad);
        pad += a.length;
    }
    return res;
}
function createHasher(hashCons) {
    let info = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    const hashC = (msg, opts)=>hashCons(opts).update(msg).digest();
    const tmp = hashCons(undefined);
    hashC.outputLen = tmp.outputLen;
    hashC.blockLen = tmp.blockLen;
    hashC.create = (opts)=>hashCons(opts);
    Object.assign(hashC, info);
    return Object.freeze(hashC);
}
const oidNist = (suffix)=>({
        oid: Uint8Array.from([
            0x06,
            0x09,
            0x60,
            0x86,
            0x48,
            0x01,
            0x65,
            0x03,
            0x04,
            0x02,
            suffix
        ])
    });
}),
"[project]/node_modules/mlkem/esm/src/sha3/sha3.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).
 *
 * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)
 *
 * The original file is located at:
 * https://github.com/paulmillr/noble-hashes/blob/4e358a46d682adfb005ae6314ec999f2513086b9/src/sha3.ts
 */ /**
 * SHA3 (keccak) hash function, based on a new "Sponge function" design.
 * Different from older hashes, the internal state is bigger than output size.
 *
 * Check out [FIPS-202](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf),
 * [Website](https://keccak.team/keccak.html),
 * [the differences between SHA-3 and Keccak](https://crypto.stackexchange.com/questions/15727/what-are-the-key-differences-between-the-draft-sha-3-standard-and-the-keccak-sub).
 *
 * Check out `sha3-addons` module for cSHAKE, k12, and others.
 * @module
 */ __turbopack_context__.s([
    "Keccak",
    ()=>Keccak,
    "keccakP",
    ()=>keccakP,
    "keccak_224",
    ()=>keccak_224,
    "keccak_256",
    ()=>keccak_256,
    "keccak_384",
    ()=>keccak_384,
    "keccak_512",
    ()=>keccak_512,
    "sha3_256",
    ()=>sha3_256,
    "sha3_512",
    ()=>sha3_512,
    "shake128",
    ()=>shake128,
    "shake256",
    ()=>shake256
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$_u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/sha3/_u64.js [app-client] (ecmascript)");
// prettier-ignore
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/sha3/utils.js [app-client] (ecmascript)");
;
;
// No __PURE__ annotations in sha3 header:
// EVERYTHING is in fact used on every export.
// Various per round constants calculations
const _0n = BigInt(0);
const _1n = BigInt(1);
const _2n = BigInt(2);
const _7n = BigInt(7);
const _256n = BigInt(256);
const _0x71n = BigInt(0x71);
const SHA3_PI = [];
const SHA3_ROTL = [];
const _SHA3_IOTA = []; // no pure annotation: var is always used
for(let round = 0, R = _1n, x = 1, y = 0; round < 24; round++){
    // Pi
    [x, y] = [
        y,
        (2 * x + 3 * y) % 5
    ];
    SHA3_PI.push(2 * (5 * y + x));
    // Rotational
    SHA3_ROTL.push((round + 1) * (round + 2) / 2 % 64);
    // Iota
    let t = _0n;
    for(let j = 0; j < 7; j++){
        R = (R << _1n ^ (R >> _7n) * _0x71n) % _256n;
        if (R & _2n) t ^= _1n << (_1n << BigInt(j)) - _1n;
    }
    _SHA3_IOTA.push(t);
}
const IOTAS = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$_u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["split"])(_SHA3_IOTA, true);
const SHA3_IOTA_H = IOTAS[0];
const SHA3_IOTA_L = IOTAS[1];
// Left rotation (without 0, 32, 64)
const rotlH = (h, l, s)=>s > 32 ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$_u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotlBH"])(h, l, s) : (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$_u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotlSH"])(h, l, s);
const rotlL = (h, l, s)=>s > 32 ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$_u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotlBL"])(h, l, s) : (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$_u64$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["rotlSL"])(h, l, s);
function keccakP(s) {
    let rounds = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 24;
    const B = new Uint32Array(5 * 2);
    // NOTE: all indices are x2 since we store state as u32 instead of u64 (bigints to slow in js)
    for(let round = 24 - rounds; round < 24; round++){
        // Theta 
        for(let x = 0; x < 10; x++){
            B[x] = s[x] ^ s[x + 10] ^ s[x + 20] ^ s[x + 30] ^ s[x + 40];
        }
        for(let x = 0; x < 10; x += 2){
            const idx1 = (x + 8) % 10;
            const idx0 = (x + 2) % 10;
            const B0 = B[idx0];
            const B1 = B[idx0 + 1];
            const Th = rotlH(B0, B1, 1) ^ B[idx1];
            const Tl = rotlL(B0, B1, 1) ^ B[idx1 + 1];
            for(let y = 0; y < 50; y += 10){
                s[x + y] ^= Th;
                s[x + y + 1] ^= Tl;
            }
        }
        // Rho () and Pi ()
        let curH = s[2];
        let curL = s[3];
        for(let t = 0; t < 24; t++){
            const shift = SHA3_ROTL[t];
            const Th = rotlH(curH, curL, shift);
            const Tl = rotlL(curH, curL, shift);
            const PI = SHA3_PI[t];
            curH = s[PI];
            curL = s[PI + 1];
            s[PI] = Th;
            s[PI + 1] = Tl;
        }
        // Chi ()
        for(let y = 0; y < 50; y += 10){
            for(let x = 0; x < 10; x++)B[x] = s[y + x];
            for(let x = 0; x < 10; x++){
                s[y + x] ^= ~B[(x + 2) % 10] & B[(x + 4) % 10];
            }
        }
        // Iota ()
        s[0] ^= SHA3_IOTA_H[round];
        s[1] ^= SHA3_IOTA_L[round];
    }
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(B);
}
class Keccak {
    clone() {
        return this._cloneInto();
    }
    keccak() {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["swap32IfBE"])(this.state32);
        keccakP(this.state32, this.rounds);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["swap32IfBE"])(this.state32);
        this.posOut = 0;
        this.pos = 0;
    }
    update(data) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aexists"])(this);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(data);
        const { blockLen, state } = this;
        const len = data.length;
        for(let pos = 0; pos < len;){
            const take = Math.min(blockLen - this.pos, len - pos);
            for(let i = 0; i < take; i++)state[this.pos++] ^= data[pos++];
            if (this.pos === blockLen) this.keccak();
        }
        return this;
    }
    finish() {
        if (this.finished) return;
        this.finished = true;
        const { state, suffix, pos, blockLen } = this;
        // Do the padding
        state[pos] ^= suffix;
        if ((suffix & 0x80) !== 0 && pos === blockLen - 1) this.keccak();
        state[blockLen - 1] ^= 0x80;
        this.keccak();
    }
    writeInto(out) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aexists"])(this, false);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["abytes"])(out);
        this.finish();
        const bufferOut = this.state;
        const { blockLen } = this;
        for(let pos = 0, len = out.length; pos < len;){
            if (this.posOut >= blockLen) this.keccak();
            const take = Math.min(blockLen - this.posOut, len - pos);
            out.set(bufferOut.subarray(this.posOut, this.posOut + take), pos);
            this.posOut += take;
            pos += take;
        }
        return out;
    }
    xofInto(out) {
        // Sha3/Keccak usage with XOF is probably mistake, only SHAKE instances can do XOF
        if (!this.enableXOF) {
            throw new Error("XOF is not possible for this instance");
        }
        return this.writeInto(out);
    }
    xof(bytes) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["anumber"])(bytes);
        return this.xofInto(new Uint8Array(bytes));
    }
    digestInto(out) {
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["aoutput"])(out, this);
        if (this.finished) throw new Error("digest() was already called");
        this.writeInto(out);
        this.destroy();
        return out;
    }
    digest() {
        return this.digestInto(new Uint8Array(this.outputLen));
    }
    destroy() {
        this.destroyed = true;
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["clean"])(this.state);
    }
    _cloneInto(to) {
        const { blockLen, suffix, outputLen, rounds, enableXOF } = this;
        to || (to = new Keccak(blockLen, suffix, outputLen, enableXOF, rounds));
        to.state32.set(this.state32);
        to.pos = this.pos;
        to.posOut = this.posOut;
        to.finished = this.finished;
        to.rounds = rounds;
        // Suffix can change in cSHAKE
        to.suffix = suffix;
        to.outputLen = outputLen;
        to.enableXOF = enableXOF;
        to.destroyed = this.destroyed;
        return to;
    }
    // NOTE: we accept arguments in bytes instead of bits here.
    constructor(blockLen, suffix, outputLen, enableXOF = false, rounds = 24){
        Object.defineProperty(this, "state", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "pos", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "posOut", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "finished", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "state32", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "destroyed", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "blockLen", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "suffix", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "outputLen", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "enableXOF", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "rounds", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.blockLen = blockLen;
        this.suffix = suffix;
        this.outputLen = outputLen;
        this.enableXOF = enableXOF;
        this.rounds = rounds;
        // Can be passed from user as dkLen
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["anumber"])(outputLen, "outputLen");
        // 1600 = 5x5 matrix of 64bit.  1600 bits === 200 bytes
        // 0 < blockLen < 200
        if (!(0 < blockLen && blockLen < 200)) {
            throw new Error("only keccak-f1600 function is supported");
        }
        this.state = new Uint8Array(200);
        this.state32 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["u32"])(this.state);
    }
}
const genKeccak = function(suffix, blockLen, outputLen) {
    let info = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createHasher"])(()=>new Keccak(blockLen, suffix, outputLen), info);
};
const sha3_256 = /* @__PURE__ */ genKeccak(0x06, 136, 32, /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["oidNist"])(0x08));
const sha3_512 = /* @__PURE__ */ genKeccak(0x06, 72, 64, /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["oidNist"])(0x0a));
const keccak_224 = /* @__PURE__ */ genKeccak(0x01, 144, 28);
const keccak_256 = /* @__PURE__ */ genKeccak(0x01, 136, 32);
const keccak_384 = /* @__PURE__ */ genKeccak(0x01, 104, 48);
const keccak_512 = /* @__PURE__ */ genKeccak(0x01, 72, 64);
const genShake = function(suffix, blockLen, outputLen) {
    let info = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : {};
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createHasher"])(function() {
        let opts = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
        return new Keccak(blockLen, suffix, opts.dkLen === undefined ? outputLen : opts.dkLen, true);
    }, info);
};
const shake128 = /* @__PURE__ */ genShake(0x1f, 168, 16, /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["oidNist"])(0x0b));
const shake256 = /* @__PURE__ */ genShake(0x1f, 136, 32, /* @__PURE__ */ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["oidNist"])(0x0c)); // /** SHAKE128 XOF with 256-bit output (NIST version). */
 // export const shake128_32: CHashXOF<Keccak, ShakeOpts> =
 //   /* @__PURE__ */
 //   genShake(0x1f, 168, 32, /* @__PURE__ */ oidNist(0x0b));
 // /** SHAKE256 XOF with 512-bit output (NIST version). */
 // export const shake256_64: CHashXOF<Keccak, ShakeOpts> =
 //   /* @__PURE__ */
 //   genShake(0x1f, 136, 64, /* @__PURE__ */ oidNist(0x0c));
}),
"[project]/node_modules/mlkem/esm/src/deps.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/sha3/sha3.js [app-client] (ecmascript)");
;
}),
"[project]/node_modules/mlkem/esm/_dnt.shims.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "dntGlobalThis",
    ()=>dntGlobalThis
]);
const dntGlobals = {};
const dntGlobalThis = createMergeProxy(globalThis, dntGlobals);
function createMergeProxy(baseObj, extObj) {
    return new Proxy(baseObj, {
        get (_target, prop, _receiver) {
            if (prop in extObj) {
                return extObj[prop];
            } else {
                return baseObj[prop];
            }
        },
        set (_target, prop, value) {
            if (prop in extObj) {
                delete extObj[prop];
            }
            baseObj[prop] = value;
            return true;
        },
        deleteProperty (_target, prop) {
            let success = false;
            if (prop in extObj) {
                delete extObj[prop];
                success = true;
            }
            if (prop in baseObj) {
                delete baseObj[prop];
                success = true;
            }
            return success;
        },
        ownKeys (_target) {
            const baseKeys = Reflect.ownKeys(baseObj);
            const extKeys = Reflect.ownKeys(extObj);
            const extKeysSet = new Set(extKeys);
            return [
                ...baseKeys.filter((k)=>!extKeysSet.has(k)),
                ...extKeys
            ];
        },
        defineProperty (_target, prop, desc) {
            if (prop in extObj) {
                delete extObj[prop];
            }
            Reflect.defineProperty(baseObj, prop, desc);
            return true;
        },
        getOwnPropertyDescriptor (_target, prop) {
            if (prop in extObj) {
                return Reflect.getOwnPropertyDescriptor(extObj, prop);
            } else {
                return Reflect.getOwnPropertyDescriptor(baseObj, prop);
            }
        },
        has (_target, prop) {
            return prop in extObj || prop in baseObj;
        }
    });
}
}),
"[project]/node_modules/mlkem/esm/src/utils.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "byte",
    ()=>byte,
    "byteopsLoad24",
    ()=>byteopsLoad24,
    "byteopsLoad32",
    ()=>byteopsLoad32,
    "constantTimeCompare",
    ()=>constantTimeCompare,
    "equalUint8Array",
    ()=>equalUint8Array,
    "int16",
    ()=>int16,
    "int32",
    ()=>int32,
    "loadCrypto",
    ()=>loadCrypto,
    "prf",
    ()=>prf,
    "uint16",
    ()=>uint16,
    "uint32",
    ()=>uint32
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/_dnt.shims.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$deps$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/deps.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/sha3/sha3.js [app-client] (ecmascript)");
;
;
function byte(n) {
    return n % 256;
}
function int16(n) {
    const end = -32768;
    const start = 32767;
    if (n >= end && n <= start) {
        return n;
    }
    if (n < end) {
        n = n + 32769;
        n = n % 65536;
        return start + n;
    }
    // if (n > start) {
    n = n - 32768;
    n = n % 65536;
    return end + n;
}
function uint16(n) {
    return n % 65536;
}
function int32(n) {
    const end = -2147483648;
    const start = 2147483647;
    if (n >= end && n <= start) {
        return n;
    }
    if (n < end) {
        n = n + 2147483649;
        n = n % 4294967296;
        return start + n;
    }
    // if (n > start) {
    n = n - 2147483648;
    n = n % 4294967296;
    return end + n;
}
function uint32(n) {
    return n % 4294967296;
}
function constantTimeCompare(x, y) {
    // check array lengths
    if (x.length != y.length) {
        return 0;
    }
    const v = new Uint8Array([
        0
    ]);
    for(let i = 0; i < x.length; i++){
        v[0] |= x[i] ^ y[i];
    }
    // constantTimeByteEq
    const z = new Uint8Array([
        0
    ]);
    z[0] = ~(v[0] ^ z[0]);
    z[0] &= z[0] >> 4;
    z[0] &= z[0] >> 2;
    z[0] &= z[0] >> 1;
    return z[0];
}
function equalUint8Array(x, y) {
    if (x.length != y.length) {
        return false;
    }
    for(let i = 0; i < x.length; i++){
        if (x[i] !== y[i]) {
            return false;
        }
    }
    return true;
}
async function loadCrypto() {
    if (typeof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$_dnt$2e$shims$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["dntGlobalThis"] !== "undefined" && globalThis.crypto !== undefined) {
        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.
        return globalThis.crypto;
    }
    // Node.js <= v18
    try {
        // @ts-ignore: to ignore "crypto"
        const { webcrypto } = await __turbopack_context__.A("[project]/node_modules/next/dist/compiled/crypto-browserify/index.js [app-client] (ecmascript, async loader)"); // node:crypto
        return webcrypto;
    } catch (_e) {
        throw new Error("failed to load Crypto");
    }
}
function prf(len, seed, nonce) {
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["shake256"].create({
        dkLen: len
    }).update(seed).update(new Uint8Array([
        nonce
    ])).digest();
}
function byteopsLoad24(x) {
    let r = uint32(x[0]);
    r |= uint32(x[1]) << 8;
    r |= uint32(x[2]) << 16;
    return r;
}
function byteopsLoad32(x) {
    let r = uint32(x[0]);
    r |= uint32(x[1]) << 8;
    r |= uint32(x[2]) << 16;
    r |= uint32(x[3]) << 24;
    return uint32(r);
}
}),
"[project]/node_modules/mlkem/esm/src/mlKemBase.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This implementation is based on https://github.com/antontutoveanu/crystals-kyber-javascript,
 * which was deveploped under the MIT licence below:
 * https://github.com/antontutoveanu/crystals-kyber-javascript/blob/main/LICENSE
 */ __turbopack_context__.s([
    "MlKemBase",
    ()=>MlKemBase
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$deps$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/deps.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/sha3/sha3.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/utils.js [app-client] (ecmascript)");
;
;
;
;
class MlKemBase {
    /**
     * Generates a keypair [publicKey, privateKey].
     *
     * If an error occurred, throws {@link MlKemError}.
     *
     * @returns A kaypair [publicKey, privateKey].
     * @throws {@link MlKemError}
     *
     * @example Generates a {@link MlKem768} keypair.
     *
     * ```ts
     * // Using jsr:
     * import { MlKem768 } from "@dajiaji/mlkem";
     * // Using npm:
     * // import { MlKem768 } from "mlkem"; // or "crystals-kyber-js"
     *
     * const kyber = new MlKem768();
     * const [pk, sk] = await kyber.generateKeyPair();
     * ```
     */ async generateKeyPair() {
        await this._setup();
        try {
            const rnd = new Uint8Array(64);
            this._api.getRandomValues(rnd);
            return this._deriveKeyPair(rnd);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKemError"](e);
        }
    }
    /**
     * Derives a keypair [publicKey, privateKey] deterministically from a 64-octet seed.
     *
     * If an error occurred, throws {@link MlKemError}.
     *
     * @param seed A 64-octet seed for the deterministic key generation.
     * @returns A kaypair [publicKey, privateKey].
     * @throws {@link MlKemError}
     *
     * @example Derives a {@link MlKem768} keypair deterministically.
     *
     * ```ts
     * // Using jsr:
     * import { MlKem768 } from "@dajiaji/mlkem";
     * // Using npm:
     * // import { MlKem768 } from "mlkem"; // or "crystals-kyber-js"
     *
     * const kyber = new MlKem768();
     * const seed = new Uint8Array(64);
     * globalThis.crypto.getRandomValues(seed);
     * const [pk, sk] = await kyber.deriveKeyPair(seed);
     * ```
     */ async deriveKeyPair(seed) {
        await this._setup();
        try {
            if (seed.byteLength !== 64) {
                throw new Error("seed must be 64 bytes in length");
            }
            return this._deriveKeyPair(seed);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKemError"](e);
        }
    }
    /**
     * Generates a shared secret from the encapsulated ciphertext and the private key.
     *
     * If an error occurred, throws {@link MlKemError}.
     *
     * @param pk A public key.
     * @param seed An optional 32-octet seed for the deterministic shared secret generation.
     * @returns A ciphertext (encapsulated public key) and a shared secret.
     * @throws {@link MlKemError}
     *
     * @example The {@link MlKem768} encapsulation.
     *
     * ```ts
     * // Using jsr:
     * import { MlKem768 } from "@dajiaji/mlkem";
     * // Using npm:
     * // import { MlKem768 } from "mlkem"; // or "crystals-kyber-js"
     *
     * const kyber = new MlKem768();
     * const [pk, sk] = await kyber.generateKeyPair();
     * const [ct, ss] = await kyber.encap(pk);
     * ```
     */ async encap(pk, seed) {
        await this._setup();
        try {
            // validate key type; the modulo is checked in `_encap`.
            if (pk.length !== 384 * this._k + 32) {
                throw new Error("invalid encapsulation key");
            }
            const m = this._getSeed(seed);
            const [k, r] = g(m, h(pk));
            const ct = this._encap(pk, m, r);
            return [
                ct,
                k
            ];
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKemError"](e);
        }
    }
    /**
     * Generates a ciphertext for the public key and a shared secret.
     *
     * If an error occurred, throws {@link MlKemError}.
     *
     * @param ct A ciphertext generated by {@link encap}.
     * @param sk A private key.
     * @returns A shared secret.
     * @throws {@link MlKemError}
     *
     * @example The {@link MlKem768} decapsulation.
     *
     * ```ts
     * // Using jsr:
     * import { MlKem768 } from "@dajiaji/mlkem";
     * // Using npm:
     * // import { MlKem768 } from "mlkem"; // or "crystals-kyber-js"
     *
     * const kyber = new MlKem768();
     * const [pk, sk] = await kyber.generateKeyPair();
     * const [ct, ssS] = await kyber.encap(pk);
     * const ssR = await kyber.decap(ct, sk);
     * // ssS === ssR
     * ```
     */ async decap(ct, sk) {
        await this._setup();
        try {
            // ciphertext type check
            if (ct.byteLength !== this._compressedUSize + this._compressedVSize) {
                throw new Error("Invalid ct size");
            }
            // decapsulation key type check
            if (sk.length !== 768 * this._k + 96) {
                throw new Error("Invalid decapsulation key");
            }
            const sk2 = sk.subarray(0, this._skSize);
            const pk = sk.subarray(this._skSize, this._skSize + this._pkSize);
            const hpk = sk.subarray(this._skSize + this._pkSize, this._skSize + this._pkSize + 32);
            const z = sk.subarray(this._skSize + this._pkSize + 32, this._skSize + this._pkSize + 64);
            const m2 = this._decap(ct, sk2);
            const [k2, r2] = g(m2, hpk);
            const kBar = kdf(z, ct);
            const ct2 = this._encap(pk, m2, r2);
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["constantTimeCompare"])(ct, ct2) === 1 ? k2 : kBar;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKemError"](e);
        }
    }
    /**
     * Sets up the MlKemBase instance by loading the necessary crypto library.
     * If the crypto library is already loaded, this method does nothing.
     * @returns {Promise<void>} A promise that resolves when the setup is complete.
     */ async _setup() {
        if (this._api !== undefined) {
            return;
        }
        this._api = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["loadCrypto"])();
    }
    /**
     * Returns a Uint8Array seed for cryptographic operations.
     * If no seed is provided, a random seed of length 32 bytes is generated.
     * If a seed is provided, it must be exactly 32 bytes in length.
     *
     * @param seed - Optional seed for cryptographic operations.
     * @returns A Uint8Array seed.
     * @throws Error if the provided seed is not 32 bytes in length.
     */ _getSeed(seed) {
        if (seed == undefined) {
            const s = new Uint8Array(32);
            this._api.getRandomValues(s);
            return s;
        }
        if (seed.byteLength !== 32) {
            throw new Error("seed must be 32 bytes in length");
        }
        return seed;
    }
    /**
     * Derives a key pair from a given seed.
     *
     * @param seed - The seed used for key derivation.
     * @returns An array containing the public key and secret key.
     */ _deriveKeyPair(seed) {
        const cpaSeed = seed.subarray(0, 32);
        const z = seed.subarray(32, 64);
        const [pk, skBody] = this._deriveCpaKeyPair(cpaSeed);
        const pkh = h(pk);
        const sk = new Uint8Array(this._skSize + this._pkSize + 64);
        sk.set(skBody, 0);
        sk.set(pk, this._skSize);
        sk.set(pkh, this._skSize + this._pkSize);
        sk.set(z, this._skSize + this._pkSize + 32);
        return [
            pk,
            sk
        ];
    }
    // indcpaKeyGen generates public and private keys for the CPA-secure
    // public-key encryption scheme underlying ML-KEM.
    /**
     * Derives a CPA key pair using the provided CPA seed.
     *
     * @param cpaSeed - The CPA seed used for key derivation.
     * @returns An array containing the public key and private key.
     */ _deriveCpaKeyPair(cpaSeed) {
        const [publicSeed, noiseSeed] = g(cpaSeed, new Uint8Array([
            this._k
        ]));
        const a = this._sampleMatrix(publicSeed, false);
        const s = this._sampleNoise1(noiseSeed, 0, this._k);
        const e = this._sampleNoise1(noiseSeed, this._k, this._k);
        // perform number theoretic transform on secret s
        for(let i = 0; i < this._k; i++){
            s[i] = ntt(s[i]);
            s[i] = reduce(s[i]);
            e[i] = ntt(e[i]);
        }
        // KEY COMPUTATION
        // pk = A*s + e
        const pk = new Array(this._k);
        for(let i = 0; i < this._k; i++){
            pk[i] = polyToMont(multiply(a[i], s));
            pk[i] = add(pk[i], e[i]);
            pk[i] = reduce(pk[i]);
        }
        // PUBLIC KEY
        // turn polynomials into byte arrays
        const pubKey = new Uint8Array(this._pkSize);
        for(let i = 0; i < this._k; i++){
            pubKey.set(polyToBytes(pk[i]), i * 384);
        }
        // append public seed
        pubKey.set(publicSeed, this._skSize);
        // PRIVATE KEY
        // turn polynomials into byte arrays
        const privKey = new Uint8Array(this._skSize);
        for(let i = 0; i < this._k; i++){
            privKey.set(polyToBytes(s[i]), i * 384);
        }
        return [
            pubKey,
            privKey
        ];
    }
    // _encap is the encapsulation function of the CPA-secure
    // public-key encryption scheme underlying ML-KEM.
    /**
     * Encapsulates a message using the ML-KEM encryption scheme.
     *
     * @param pk - The public key.
     * @param msg - The message to be encapsulated.
     * @param seed - The seed used for generating random values.
     * @returns The encapsulated message as a Uint8Array.
     */ _encap(pk, msg, seed) {
        const tHat = new Array(this._k);
        const pkCheck = new Uint8Array(384 * this._k); // to validate the pk modulo (see input validation at NIST draft 6.2)
        for(let i = 0; i < this._k; i++){
            tHat[i] = polyFromBytes(pk.subarray(i * 384, (i + 1) * 384));
            pkCheck.set(polyToBytes(tHat[i]), i * 384);
        }
        if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["equalUint8Array"])(pk.subarray(0, pkCheck.length), pkCheck)) {
            throw new Error("invalid encapsulation key");
        }
        const rho = pk.subarray(this._skSize);
        const a = this._sampleMatrix(rho, true);
        const r = this._sampleNoise1(seed, 0, this._k);
        const e1 = this._sampleNoise2(seed, this._k, this._k);
        const e2 = this._sampleNoise2(seed, this._k * 2, 1)[0];
        // perform number theoretic transform on random vector r
        for(let i = 0; i < this._k; i++){
            r[i] = ntt(r[i]);
            r[i] = reduce(r[i]);
        }
        // u = A*r + e1
        const u = new Array(this._k);
        for(let i = 0; i < this._k; i++){
            u[i] = multiply(a[i], r);
            u[i] = nttInverse(u[i]);
            u[i] = add(u[i], e1[i]);
            u[i] = reduce(u[i]);
        }
        // v = tHat*r + e2 + m
        const m = polyFromMsg(msg);
        let v = multiply(tHat, r);
        v = nttInverse(v);
        v = add(v, e2);
        v = add(v, m);
        v = reduce(v);
        // compress
        const ret = new Uint8Array(this._compressedUSize + this._compressedVSize);
        this._compressU(ret.subarray(0, this._compressedUSize), u);
        this._compressV(ret.subarray(this._compressedUSize), v);
        return ret;
    }
    // indcpaDecrypt is the decryption function of the CPA-secure
    // public-key encryption scheme underlying ML-KEM.
    /**
     * Decapsulates the ciphertext using the provided secret key.
     *
     * @param ct - The ciphertext to be decapsulated.
     * @param sk - The secret key used for decapsulation.
     * @returns The decapsulated message as a Uint8Array.
     */ _decap(ct, sk) {
        // extract ciphertext
        const u = this._decompressU(ct.subarray(0, this._compressedUSize));
        const v = this._decompressV(ct.subarray(this._compressedUSize));
        const privateKeyPolyvec = this._polyvecFromBytes(sk);
        for(let i = 0; i < this._k; i++){
            u[i] = ntt(u[i]);
        }
        let mp = multiply(privateKeyPolyvec, u);
        mp = nttInverse(mp);
        mp = subtract(v, mp);
        mp = reduce(mp);
        return polyToMsg(mp);
    }
    // generateMatrixA deterministically generates a matrix `A` (or the transpose of `A`)
    // from a seed. Entries of the matrix are polynomials that look uniformly random.
    // Performs rejection sampling on the output of an extendable-output function (XOF).
    /**
     * Generates a sample matrix based on the provided seed and transposition flag.
     *
     * @param seed - The seed used for generating the matrix.
     * @param transposed - A flag indicating whether the matrix should be transposed or not.
     * @returns The generated sample matrix.
     */ _sampleMatrix(seed, transposed) {
        const a = new Array(this._k);
        const transpose = new Uint8Array(2);
        for(let ctr = 0, i = 0; i < this._k; i++){
            a[i] = new Array(this._k);
            for(let j = 0; j < this._k; j++){
                // set if transposed matrix or not
                if (transposed) {
                    transpose[0] = i;
                    transpose[1] = j;
                } else {
                    transpose[0] = j;
                    transpose[1] = i;
                }
                const output = xof(seed, transpose);
                // run rejection sampling on the output from above
                const result = indcpaRejUniform(output.subarray(0, 504), 504, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]);
                a[i][j] = result[0]; // the result here is an NTT-representation
                ctr = result[1]; // keeps track of index of output array from sampling function
                while(ctr < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]){
                    const outputn = output.subarray(504, 672); // take last 168 bytes of byte array from xof
                    const result1 = indcpaRejUniform(outputn, 168, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] - ctr); // run sampling function again
                    const missing = result1[0]; // here is additional mod q polynomial coefficients
                    const ctrn = result1[1]; // how many coefficients were accepted and are in the output
                    // starting at last position of output array from first sampling function until 256 is reached
                    for(let k = ctr; k < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]; k++){
                        a[i][j][k] = missing[k - ctr]; // fill rest of array with the additional coefficients until full
                    }
                    ctr = ctr + ctrn; // update index
                }
            }
        }
        return a;
    }
    /**
     * Generates a 2D array of noise samples.
     *
     * @param sigma - The noise parameter.
     * @param offset - The offset value.
     * @param size - The size of the array.
     * @returns The generated 2D array of noise samples.
     */ _sampleNoise1(sigma, offset, size) {
        const r = new Array(size);
        for(let i = 0; i < size; i++){
            r[i] = byteopsCbd((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["prf"])(this._eta1 * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 4, sigma, offset), this._eta1);
            offset++;
        }
        return r;
    }
    /**
     * Generates a 2-dimensional array of noise samples.
     *
     * @param sigma - The noise parameter.
     * @param offset - The offset value.
     * @param size - The size of the array.
     * @returns The generated 2-dimensional array of noise samples.
     */ _sampleNoise2(sigma, offset, size) {
        const r = new Array(size);
        for(let i = 0; i < size; i++){
            r[i] = byteopsCbd((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["prf"])(this._eta2 * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 4, sigma, offset), this._eta2);
            offset++;
        }
        return r;
    }
    // polyvecFromBytes deserializes a vector of polynomials.
    /**
     * Converts a Uint8Array to a 2D array of numbers representing a polynomial vector.
     * Each element in the resulting array represents a polynomial.
     * @param a The Uint8Array to convert.
     * @returns The 2D array of numbers representing the polynomial vector.
     */ _polyvecFromBytes(a) {
        const r = new Array(this._k);
        for(let i = 0; i < this._k; i++){
            r[i] = polyFromBytes(a.subarray(i * 384, (i + 1) * 384));
        }
        return r;
    }
    // compressU lossily compresses and serializes a vector of polynomials.
    /**
     * Compresses the given array of coefficients into a Uint8Array.
     *
     * @param r - The output Uint8Array.
     * @param u - The array of coefficients.
     * @returns The compressed Uint8Array.
     */ _compressU(r, u) {
        const t = new Array(4);
        for(let rr = 0, i = 0; i < this._k; i++){
            for(let j = 0; j < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 4; j++){
                for(let k = 0; k < 4; k++){
                    // parse {0,...,3328} to {0,...,1023}
                    t[k] = ((u[i][4 * j + k] << 10) + __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] / 2) / __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] & 0b1111111111;
                }
                // converts 4 12-bit coefficients {0,...,3328} to 5 8-bit bytes {0,...,255}
                // 48 bits down to 40 bits per block
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[0] >> 0);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[0] >> 8 | t[1] << 2);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[1] >> 6 | t[2] << 4);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[2] >> 4 | t[3] << 6);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[3] >> 2);
            }
        }
        return r;
    }
    // compressV lossily compresses and subsequently serializes a polynomial.
    /**
     * Compresses the given array of numbers into a Uint8Array.
     *
     * @param r - The Uint8Array to store the compressed values.
     * @param v - The array of numbers to compress.
     * @returns The compressed Uint8Array.
     */ _compressV(r, v) {
        // const r = new Uint8Array(128);
        const t = new Uint8Array(8);
        for(let rr = 0, i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; i++){
            for(let j = 0; j < 8; j++){
                t[j] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(((v[8 * i + j] << 4) + __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] / 2) / __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) & 0b1111;
            }
            r[rr++] = t[0] | t[1] << 4;
            r[rr++] = t[2] | t[3] << 4;
            r[rr++] = t[4] | t[5] << 4;
            r[rr++] = t[6] | t[7] << 4;
        }
        return r;
    }
    // decompressU de-serializes and decompresses a vector of polynomials and
    // represents the approximate inverse of compress1. Since compression is lossy,
    // the results of decompression will may not match the original vector of polynomials.
    /**
     * Decompresses a Uint8Array into a two-dimensional array of numbers.
     *
     * @param a The Uint8Array to decompress.
     * @returns The decompressed two-dimensional array.
     */ _decompressU(a) {
        const r = new Array(this._k);
        for(let i = 0; i < this._k; i++){
            r[i] = new Array(384);
        }
        const t = new Array(4);
        for(let aa = 0, i = 0; i < this._k; i++){
            for(let j = 0; j < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 4; j++){
                t[0] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 0]) >> 0 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 1]) << 8;
                t[1] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 1]) >> 2 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 2]) << 6;
                t[2] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 2]) >> 4 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 3]) << 4;
                t[3] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 3]) >> 6 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 4]) << 2;
                aa = aa + 5;
                for(let k = 0; k < 4; k++){
                    r[i][4 * j + k] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(t[k] & 0x3FF) * (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) + 512 >> 10);
                }
            }
        }
        return r;
    }
    // decompressV de-serializes and subsequently decompresses a polynomial,
    // representing the approximate inverse of compress2.
    // Note that compression is lossy, and thus decompression will not match the
    // original input.
    /**
     * Decompresses a Uint8Array into an array of numbers.
     *
     * @param a - The Uint8Array to decompress.
     * @returns An array of numbers.
     */ _decompressV(a) {
        const r = new Array(384);
        for(let aa = 0, i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 2; i++, aa++){
            r[2 * i + 0] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa] & 15) * (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) + 8 >> 4);
            r[2 * i + 1] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa] >> 4) * (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) + 8 >> 4);
        }
        return r;
    }
    /**
     * Creates a new instance of the MlKemBase class.
     */ constructor(){
        Object.defineProperty(this, "_api", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
        Object.defineProperty(this, "_k", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_du", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_dv", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_eta1", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_eta2", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_skSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_pkSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_compressedUSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "_compressedVSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
    }
}
/**
 * Computes the hash of the input array `a` and an optional input array `b`.
 * Returns an array containing two Uint8Arrays, representing the first 32 bytes and the next 32 bytes of the hash digest.
 * @param a - The input array to be hashed.
 * @param b - An optional input array to be hashed along with `a`.
 * @returns An array containing two Uint8Arrays representing the hash digest.
 */ function g(a, b) {
    const hash = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["sha3_512"].create().update(a);
    if (b !== undefined) {
        hash.update(b);
    }
    const res = hash.digest();
    return [
        res.subarray(0, 32),
        res.subarray(32, 64)
    ];
}
/**
 * Computes the SHA3-256 hash of the given message.
 *
 * @param msg - The input message as a Uint8Array.
 * @returns The computed hash as a Uint8Array.
 */ function h(msg) {
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["sha3_256"].create().update(msg).digest();
}
/**
 * Key Derivation Function (KDF) that takes an input array `a` and an optional input array `b`.
 * It uses the SHAKE256 hash function to derive a 32-byte output.
 *
 * @param a - The input array.
 * @param b - The optional input array.
 * @returns The derived key as a Uint8Array.
 */ function kdf(a, b) {
    const hash = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["shake256"].create({
        dkLen: 32
    }).update(a);
    if (b !== undefined) {
        hash.update(b);
    }
    return hash.digest();
}
/**
 * Computes the extendable-output function (XOF) using the SHAKE128 algorithm.
 *
 * @param seed - The seed value for the XOF.
 * @param transpose - The transpose value for the XOF.
 * @returns The computed XOF value as a Uint8Array.
 */ function xof(seed, transpose) {
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["shake128"].create({
        dkLen: 672
    }).update(seed).update(transpose).digest();
}
// polyToBytes serializes a polynomial into an array of bytes.
/**
 * Converts a polynomial represented by an array of numbers to a Uint8Array.
 * Each coefficient of the polynomial is reduced modulo q.
 *
 * @param a - The array representing the polynomial.
 * @returns The Uint8Array representation of the polynomial.
 */ function polyToBytes(a) {
    let t0 = 0;
    let t1 = 0;
    const r = new Uint8Array(384);
    const a2 = subtractQ(a); // Returns: a - q if a >= q, else a (each coefficient of the polynomial)
    // for 0-127
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 2; i++){
        // get two coefficient entries in the polynomial
        t0 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a2[2 * i]);
        t1 = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a2[2 * i + 1]);
        // convert the 2 coefficient into 3 bytes
        r[3 * i + 0] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t0 >> 0); // byte() does mod 256 of the input (output value 0-255)
        r[3 * i + 1] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t0 >> 8) | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t1 << 4);
        r[3 * i + 2] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t1 >> 4);
    }
    return r;
}
// polyFromBytes de-serialises an array of bytes into a polynomial,
// and represents the inverse of polyToBytes.
/**
 * Converts a Uint8Array to an array of numbers representing a polynomial.
 * Each element in the array represents a coefficient of the polynomial.
 * The input array `a` should have a length of 384.
 * The function performs bitwise operations to extract the coefficients from the input array.
 * @param a The Uint8Array to convert to a polynomial.
 * @returns An array of numbers representing the polynomial.
 */ function polyFromBytes(a) {
    const r = new Array(384).fill(0);
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 2; i++){
        r[2 * i] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[3 * i + 0]) >> 0 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[3 * i + 1]) << 8) & 0xFFF);
        r[2 * i + 1] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[3 * i + 1]) >> 4 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[3 * i + 2]) << 4) & 0xFFF);
    }
    return r;
}
// polyToMsg converts a polynomial to a 32-byte message
// and represents the inverse of polyFromMsg.
/**
 * Converts a polynomial to a message represented as a Uint8Array.
 * @param a - The polynomial to convert.
 * @returns The message as a Uint8Array.
 */ function polyToMsg(a) {
    const msg = new Uint8Array(32);
    let t;
    const a2 = subtractQ(a);
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; i++){
        msg[i] = 0;
        for(let j = 0; j < 8; j++){
            t = (((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a2[8 * i + j]) << 1) + (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] / 2)) / (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) & 1;
            msg[i] |= (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t << j);
        }
    }
    return msg;
}
// polyFromMsg converts a 32-byte message to a polynomial.
/**
 * Converts a Uint8Array message to an array of numbers representing a polynomial.
 * Each element in the array is an int16 (0-65535).
 *
 * @param msg - The Uint8Array message to convert.
 * @returns An array of numbers representing the polynomial.
 */ function polyFromMsg(msg) {
    const r = new Array(384).fill(0); // each element is int16 (0-65535)
    let mask; // int16
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; i++){
        for(let j = 0; j < 8; j++){
            mask = -1 * (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(msg[i] >> j & 1);
            r[8 * i + j] = mask & (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])((__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] + 1) / 2);
        }
    }
    return r;
}
// indcpaRejUniform runs rejection sampling on uniform random bytes
// to generate uniform random integers modulo `Q`.
/**
 * Generates an array of random numbers from a given buffer, rejecting values greater than a specified threshold.
 *
 * @param buf - The input buffer containing random bytes.
 * @param bufl - The length of the input buffer.
 * @param len - The desired length of the output array.
 * @returns An array of random numbers and the actual length of the output array.
 */ function indcpaRejUniform(buf, bufl, len) {
    const r = new Array(384).fill(0);
    let ctr = 0;
    let val0, val1; // d1, d2 in kyber documentation
    for(let pos = 0; ctr < len && pos + 3 <= bufl;){
        // compute d1 and d2
        val0 = ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(buf[pos] >> 0) | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(buf[pos + 1]) << 8) & 0xFFF;
        val1 = ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(buf[pos + 1] >> 4) | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(buf[pos + 2]) << 4) & 0xFFF;
        // increment input buffer index by 3
        pos = pos + 3;
        // if d1 is less than 3329
        if (val0 < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) {
            // assign to d1
            r[ctr] = val0;
            // increment position of output array
            ctr = ctr + 1;
        }
        if (ctr < len && val1 < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) {
            r[ctr] = val1;
            ctr = ctr + 1;
        }
    }
    return [
        r,
        ctr
    ];
}
// byteopsCbd computes a polynomial with coefficients distributed
// according to a centered binomial distribution with parameter PARAMS_ETA,
// given an array of uniformly random bytes.
/**
 * Converts a Uint8Array buffer to an array of numbers using the CBD operation.
 * @param buf - The input Uint8Array buffer.
 * @param eta - The value used in the CBD operation.
 * @returns An array of numbers obtained from the CBD operation.
 */ function byteopsCbd(buf, eta) {
    let t, d;
    let a, b;
    const r = new Array(384).fill(0);
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; i++){
        t = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byteopsLoad32"])(buf.subarray(4 * i, buf.length));
        d = t & 0x55555555;
        d = d + (t >> 1 & 0x55555555);
        for(let j = 0; j < 8; j++){
            a = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(d >> 4 * j + 0 & 0x3);
            b = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(d >> 4 * j + eta & 0x3);
            r[8 * i + j] = a - b;
        }
    }
    return r;
}
// ntt performs an inplace number-theoretic transform (NTT) in `Rq`.
// The input is in standard order, the output is in bit-reversed order.
/**
 * Performs the Number Theoretic Transform (NTT) on an array of numbers.
 *
 * @param r - The input array of numbers.
 * @returns The transformed array of numbers.
 */ function ntt(r) {
    // 128, 64, 32, 16, 8, 4, 2
    for(let j = 0, k = 1, l = 128; l >= 2; l >>= 1){
        // 0,
        for(let start = 0; start < 256; start = j + l){
            const zeta = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NTT_ZETAS"][k];
            k = k + 1;
            // for each element in the subsections (128, 64, 32, 16, 8, 4, 2) starting at an offset
            for(j = start; j < start + l; j++){
                // compute the modular multiplication of the zeta and each element in the subsection
                const t = nttFqMul(zeta, r[j + l]); // t is mod q
                // overwrite each element in the subsection as the opposite subsection element minus t
                r[j + l] = r[j] - t;
                // add t back again to the opposite subsection
                r[j] = r[j] + t;
            }
        }
    }
    return r;
}
// nttFqMul performs multiplication followed by Montgomery reduction
// and returns a 16-bit integer congruent to `a*b*R^{-1} mod Q`.
/**
 * Performs an NTT (Number Theoretic Transform) multiplication on two numbers in Fq.
 * @param a The first number.
 * @param b The second number.
 * @returns The result of the NTT multiplication.
 */ function nttFqMul(a, b) {
    return byteopsMontgomeryReduce(a * b);
}
// reduce applies Barrett reduction to all coefficients of a polynomial.
/**
 * Reduces each element in the given array using the barrett function.
 *
 * @param r - The array to be reduced.
 * @returns The reduced array.
 */ function reduce(r) {
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]; i++){
        r[i] = barrett(r[i]);
    }
    return r;
}
// barrett computes a Barrett reduction; given
// a integer `a`, returns a integer congruent to
// `a mod Q` in {0,...,Q}.
/**
 * Performs the Barrett reduction algorithm on the given number.
 *
 * @param a - The number to be reduced.
 * @returns The result of the reduction.
 */ function barrett(a) {
    const v = ((1 << 24) + __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] / 2) / __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"];
    let t = v * a >> 24;
    t = t * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"];
    return a - t;
}
// byteopsMontgomeryReduce computes a Montgomery reduction; given
// a 32-bit integer `a`, returns `a * R^-1 mod Q` where `R=2^16`.
/**
 * Performs Montgomery reduction on a given number.
 * @param a - The number to be reduced.
 * @returns The reduced number.
 */ function byteopsMontgomeryReduce(a) {
    const u = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int32"])(a) * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q_INV"]);
    let t = u * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"];
    t = a - t;
    t >>= 16;
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(t);
}
// polyToMont performs the in-place conversion of all coefficients
// of a polynomial from the normal domain to the Montgomery domain.
/**
 * Converts a polynomial to the Montgomery domain.
 *
 * @param r - The polynomial to be converted.
 * @returns The polynomial in the Montgomery domain.
 */ function polyToMont(r) {
    // let f = int16(((uint64(1) << 32)) % uint64(Q));
    const f = 1353; // if Q changes then this needs to be updated
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]; i++){
        r[i] = byteopsMontgomeryReduce((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int32"])(r[i]) * (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int32"])(f));
    }
    return r;
}
// pointwise-multiplies elements of polynomial-vectors
// `a` and `b`, accumulates the results into `r`, and then multiplies by `2^-16`.
/**
 * Multiplies two matrices element-wise and returns the result.
 * @param a - The first matrix.
 * @param b - The second matrix.
 * @returns The resulting matrix after element-wise multiplication.
 */ function multiply(a, b) {
    let r = polyBaseMulMontgomery(a[0], b[0]);
    let t;
    for(let i = 1; i < a.length; i++){
        t = polyBaseMulMontgomery(a[i], b[i]);
        r = add(r, t);
    }
    return reduce(r);
}
// polyBaseMulMontgomery performs the multiplication of two polynomials
// in the number-theoretic transform (NTT) domain.
/**
 * Performs polynomial base multiplication in Montgomery domain.
 * @param a - The first polynomial array.
 * @param b - The second polynomial array.
 * @returns The result of the polynomial base multiplication.
 */ function polyBaseMulMontgomery(a, b) {
    let rx, ry;
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 4; i++){
        rx = nttBaseMul(a[4 * i + 0], a[4 * i + 1], b[4 * i + 0], b[4 * i + 1], __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NTT_ZETAS"][64 + i]);
        ry = nttBaseMul(a[4 * i + 2], a[4 * i + 3], b[4 * i + 2], b[4 * i + 3], -__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NTT_ZETAS"][64 + i]);
        a[4 * i + 0] = rx[0];
        a[4 * i + 1] = rx[1];
        a[4 * i + 2] = ry[0];
        a[4 * i + 3] = ry[1];
    }
    return a;
}
// nttBaseMul performs the multiplication of polynomials
// in `Zq[X]/(X^2-zeta)`. Used for multiplication of elements
// in `Rq` in the number-theoretic transformation domain.
/**
 * Performs NTT base multiplication.
 *
 * @param a0 - The first coefficient of the first polynomial.
 * @param a1 - The second coefficient of the first polynomial.
 * @param b0 - The first coefficient of the second polynomial.
 * @param b1 - The second coefficient of the second polynomial.
 * @param zeta - The zeta value used in the multiplication.
 * @returns An array containing the result of the multiplication.
 */ function nttBaseMul(a0, a1, b0, b1, zeta) {
    const r = new Array(2);
    r[0] = nttFqMul(a1, b1);
    r[0] = nttFqMul(r[0], zeta);
    r[0] += nttFqMul(a0, b0);
    r[1] = nttFqMul(a0, b1);
    r[1] += nttFqMul(a1, b0);
    return r;
}
// adds two polynomials.
/**
 * Adds two arrays element-wise.
 * @param a - The first array.
 * @param b - The second array.
 * @returns The resulting array after element-wise addition.
 */ function add(a, b) {
    const c = new Array(384);
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]; i++){
        c[i] = a[i] + b[i];
    }
    return c;
}
// subtracts two polynomials.
/**
 * Subtracts the elements of array b from array a.
 *
 * @param a - The array from which to subtract.
 * @param b - The array to subtract.
 * @returns The resulting array after subtraction.
 */ function subtract(a, b) {
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]; i++){
        a[i] -= b[i];
    }
    return a;
}
// nttInverse performs an inplace inverse number-theoretic transform (NTT)
// in `Rq` and multiplication by Montgomery factor 2^16.
// The input is in bit-reversed order, the output is in standard order.
/**
 * Performs the inverse Number Theoretic Transform (NTT) on the given array.
 *
 * @param r - The input array to perform the inverse NTT on.
 * @returns The array after performing the inverse NTT.
 */ function nttInverse(r) {
    let j = 0;
    for(let k = 0, l = 2; l <= 128; l <<= 1){
        for(let start = 0; start < 256; start = j + l){
            const zeta = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NTT_ZETAS_INV"][k];
            k = k + 1;
            for(j = start; j < start + l; j++){
                const t = r[j];
                r[j] = barrett(t + r[j + l]);
                r[j + l] = t - r[j + l];
                r[j + l] = nttFqMul(zeta, r[j + l]);
            }
        }
    }
    for(j = 0; j < 256; j++){
        r[j] = nttFqMul(r[j], __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NTT_ZETAS_INV"][127]);
    }
    return r;
}
// subtractQ applies the conditional subtraction of q to each coefficient of a polynomial.
// if a is 3329 then convert to 0
// Returns:     a - q if a >= q, else a
/**
 * Subtracts the value of Q from each element in the given array.
 * The result should be a negative integer for each element.
 * If the leftmost bit is 0 (positive number), the value of Q is added back.
 *
 * @param r - The array to subtract Q from.
 * @returns The resulting array after the subtraction.
 */ function subtractQ(r) {
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"]; i++){
        r[i] -= __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]; // should result in a negative integer
        // push left most signed bit to right most position
        // javascript does bitwise operations in signed 32 bit
        // add q back again if left most bit was 0 (positive number)
        r[i] += r[i] >> 31 & __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"];
    }
    return r;
}
}),
"[project]/node_modules/mlkem/esm/src/mlKem512.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This implementation is based on https://github.com/antontutoveanu/crystals-kyber-javascript,
 * which was deveploped under the MIT licence below:
 * https://github.com/antontutoveanu/crystals-kyber-javascript/blob/main/LICENSE
 */ __turbopack_context__.s([
    "MlKem512",
    ()=>MlKem512
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKemBase$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKemBase.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/utils.js [app-client] (ecmascript)");
;
;
;
class MlKem512 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKemBase$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKemBase"] {
    /**
     * Samples a vector of polynomials from a seed.
     * @internal
     * @param sigma - The seed.
     * @param offset - The offset.
     * @param size - The size.
     * @returns The sampled vector of polynomials.
     */ _sampleNoise1(sigma, offset, size) {
        const r = new Array(size);
        for(let i = 0; i < size; i++){
            r[i] = byteopsCbd((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["prf"])(this._eta1 * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 4, sigma, offset), this._eta1);
            offset++;
        }
        return r;
    }
    /**
     * Constructs a new instance of the MlKem512 class.
     */ constructor(){
        super();
        Object.defineProperty(this, "_k", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 2
        });
        Object.defineProperty(this, "_du", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 10
        });
        Object.defineProperty(this, "_dv", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 4
        });
        Object.defineProperty(this, "_eta1", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 3
        });
        Object.defineProperty(this, "_eta2", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 2
        });
        this._skSize = 12 * this._k * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
        this._pkSize = this._skSize + 32;
        this._compressedUSize = this._k * this._du * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
        this._compressedVSize = this._dv * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
    }
}
/**
 * Performs the byte operations for the Cbd function.
 *
 * @param buf - The input buffer.
 * @param eta - The value of eta.
 * @returns An array of numbers representing the result of the byte operations.
 */ function byteopsCbd(buf, eta) {
    let t, d;
    let a, b;
    const r = new Array(384).fill(0);
    for(let i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 4; i++){
        t = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byteopsLoad24"])(buf.subarray(3 * i, buf.length));
        d = t & 0x00249249;
        d = d + (t >> 1 & 0x00249249);
        d = d + (t >> 2 & 0x00249249);
        for(let j = 0; j < 4; j++){
            a = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(d >> 6 * j + 0 & 0x7);
            b = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])(d >> 6 * j + eta & 0x7);
            r[4 * i + j] = a - b;
        }
    }
    return r;
}
}),
"[project]/node_modules/mlkem/esm/src/mlKem768.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This implementation is based on https://github.com/antontutoveanu/crystals-kyber-javascript,
 * which was deveploped under the MIT licence below:
 * https://github.com/antontutoveanu/crystals-kyber-javascript/blob/main/LICENSE
 */ __turbopack_context__.s([
    "MlKem768",
    ()=>MlKem768
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKemBase$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKemBase.js [app-client] (ecmascript)");
;
;
class MlKem768 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKemBase$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKemBase"] {
    constructor(){
        super();
        Object.defineProperty(this, "_k", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 3
        });
        Object.defineProperty(this, "_du", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 10
        });
        Object.defineProperty(this, "_dv", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 4
        });
        Object.defineProperty(this, "_eta1", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 2
        });
        Object.defineProperty(this, "_eta2", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 2
        });
        this._skSize = 12 * this._k * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
        this._pkSize = this._skSize + 32;
        this._compressedUSize = this._k * this._du * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
        this._compressedVSize = this._dv * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
    }
}
}),
"[project]/node_modules/mlkem/esm/src/mlKem1024.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * This implementation is based on https://github.com/antontutoveanu/crystals-kyber-javascript,
 * which was deveploped under the MIT licence below:
 * https://github.com/antontutoveanu/crystals-kyber-javascript/blob/main/LICENSE
 */ __turbopack_context__.s([
    "MlKem1024",
    ()=>MlKem1024
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/consts.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKemBase$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKemBase.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/utils.js [app-client] (ecmascript)");
;
;
;
class MlKem1024 extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKemBase$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKemBase"] {
    // compressU lossily compresses and serializes a vector of polynomials.
    /**
     * Lossily compresses and serializes a vector of polynomials.
     *
     * @param u - The vector of polynomials to compress.
     * @returns The compressed and serialized data as a Uint8Array.
     */ _compressU(r, u) {
        const t = new Array(8);
        for(let rr = 0, i = 0; i < this._k; i++){
            for(let j = 0; j < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; j++){
                for(let k = 0; k < 8; k++){
                    t[k] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])((((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(u[i][8 * j + k]) << 11) + (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] / 2)) / (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) & 0x7ff);
                }
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[0] >> 0);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[0] >> 8 | t[1] << 3);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[1] >> 5 | t[2] << 6);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[2] >> 2);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[2] >> 10 | t[3] << 1);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[3] >> 7 | t[4] << 4);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[4] >> 4 | t[5] << 7);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[5] >> 1);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[5] >> 9 | t[6] << 2);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[6] >> 6 | t[7] << 5);
                r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[7] >> 3);
            }
        }
        return r;
    }
    // compressV lossily compresses and subsequently serializes a polynomial.
    /**
     * Lossily compresses and serializes a polynomial.
     *
     * @param r - The output buffer to store the compressed data.
     * @param v - The polynomial to compress.
     * @returns The compressed and serialized data as a Uint8Array.
     */ _compressV(r, v) {
        const t = new Uint8Array(8);
        for(let rr = 0, i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; i++){
            for(let j = 0; j < 8; j++){
                t[j] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])((((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(v[8 * i + j]) << 5) + (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] / 2)) / (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"])) & 31;
            }
            r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[0] >> 0 | t[1] << 5);
            r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[1] >> 3 | t[2] << 2 | t[3] << 7);
            r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[3] >> 1 | t[4] << 4);
            r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[4] >> 4 | t[5] << 1 | t[6] << 6);
            r[rr++] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["byte"])(t[6] >> 2 | t[7] << 3);
        }
        return r;
    }
    // decompressU de-serializes and decompresses a vector of polynomials and
    // represents the approximate inverse of compress1. Since compression is lossy,
    // the results of decompression will may not match the original vector of polynomials.
    /**
     * Deserializes and decompresses a vector of polynomials.
     * This is the approximate inverse of the `_compressU` method.
     * Since compression is lossy, the decompressed data may not match the original vector of polynomials.
     *
     * @param a - The compressed and serialized data as a Uint8Array.
     * @returns The decompressed vector of polynomials.
     */ _decompressU(a) {
        const r = new Array(this._k);
        for(let i = 0; i < this._k; i++){
            r[i] = new Array(384);
        }
        const t = new Array(8);
        for(let aa = 0, i = 0; i < this._k; i++){
            for(let j = 0; j < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; j++){
                t[0] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 0]) >> 0 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 1]) << 8;
                t[1] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 1]) >> 3 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 2]) << 5;
                t[2] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 2]) >> 6 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 3]) << 2 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 4]) << 10;
                t[3] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 4]) >> 1 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 5]) << 7;
                t[4] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 5]) >> 4 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 6]) << 4;
                t[5] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 6]) >> 7 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 7]) << 1 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 8]) << 9;
                t[6] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 8]) >> 2 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 9]) << 6;
                t[7] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 9]) >> 5 | (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint16"])(a[aa + 10]) << 3;
                aa = aa + 11;
                for(let k = 0; k < 8; k++){
                    r[i][8 * j + k] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(t[k] & 0x7FF) * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"] + 1024 >> 11;
                }
            }
        }
        return r;
    }
    // decompressV de-serializes and subsequently decompresses a polynomial,
    // representing the approximate inverse of compress2.
    // Note that compression is lossy, and thus decompression will not match the
    // original input.
    /**
     * Decompresses a given polynomial, representing the approximate inverse of
     * compress2, in Uint8Array into an array of numbers.
     *
     * Note that compression is lossy, and thus decompression will not match the
     * original input.
     *
     * @param a - The Uint8Array to decompress.
     * @returns An array of numbers obtained from the decompression process.
     */ _decompressV(a) {
        const r = new Array(384);
        const t = new Array(8);
        for(let aa = 0, i = 0; i < __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8; i++){
            t[0] = a[aa + 0] >> 0;
            t[1] = a[aa + 0] >> 5 | a[aa + 1] << 3;
            t[2] = a[aa + 1] >> 2;
            t[3] = a[aa + 1] >> 7 | a[aa + 2] << 1;
            t[4] = a[aa + 2] >> 4 | a[aa + 3] << 4;
            t[5] = a[aa + 3] >> 1;
            t[6] = a[aa + 3] >> 6 | a[aa + 4] << 2;
            t[7] = a[aa + 4] >> 3;
            aa = aa + 5;
            for(let j = 0; j < 8; j++){
                r[8 * i + j] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["int16"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(t[j] & 31) * (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$utils$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["uint32"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Q"]) + 16 >> 5);
            }
        }
        return r;
    }
    /**
     * Constructs a new instance of the MlKem1024 class.
     */ constructor(){
        super();
        Object.defineProperty(this, "_k", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 4
        });
        Object.defineProperty(this, "_du", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 11
        });
        Object.defineProperty(this, "_dv", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 5
        });
        Object.defineProperty(this, "_eta1", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 2
        });
        Object.defineProperty(this, "_eta2", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 2
        });
        this._skSize = 12 * this._k * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
        this._pkSize = this._skSize + 32;
        this._compressedUSize = this._k * this._du * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
        this._compressedVSize = this._dv * __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$consts$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["N"] / 8;
    }
}
}),
"[project]/node_modules/mlkem/esm/mod.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem512$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKem512.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem768$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKem768.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem1024$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKem1024.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$sha3$2f$sha3$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/sha3/sha3.js [app-client] (ecmascript)");
;
;
;
;
;
}),
"[project]/node_modules/@hpke/ml-kem/esm/src/mlKem.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "MlKem1024",
    ()=>MlKem1024,
    "MlKem512",
    ()=>MlKem512,
    "MlKem768",
    ()=>MlKem768,
    "MlKemBase",
    ()=>MlKemBase
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem1024$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKem1024.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem512$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKem512.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem768$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/mlkem/esm/src/mlKem768.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$mod$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/mod.js [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/utils/misc.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/errors.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/identifiers.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/common/esm/src/xCryptoKey.js [app-client] (ecmascript)");
;
;
class MlKemBase {
    async serializePublicKey(key) {
        try {
            return await this._serializePublicKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePublicKey(key) {
        try {
            return await this._deserializePublicKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async serializePrivateKey(key) {
        try {
            return await this._serializePrivateKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["SerializeError"](e);
        }
    }
    async deserializePrivateKey(key) {
        try {
            return await this._deserializePrivateKey(key);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async generateKeyPair() {
        await this._setup();
        const d = new Uint8Array(32);
        const z = new Uint8Array(32);
        try {
            this._api.getRandomValues(d);
            this._api.getRandomValues(z);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["NotSupportedError"](e);
        }
        try {
            const sk = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["concat"])(d, z);
            const [pk, _sk] = await this._prim.deriveKeyPair(sk);
            const dSk = await this.deserializePrivateKey(sk.buffer);
            const dPk = await this.deserializePublicKey(pk.buffer);
            return {
                privateKey: dSk,
                publicKey: dPk
            };
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeriveKeyPairError"](e);
        }
    }
    async deriveKeyPair(ikm) {
        try {
            const [pk, _] = await this._prim.deriveKeyPair(new Uint8Array(ikm));
            const dSk = await this.deserializePrivateKey(ikm);
            const dPk = await this.deserializePublicKey(pk.buffer);
            return {
                privateKey: dSk,
                publicKey: dPk
            };
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeriveKeyPairError"](e);
        }
    }
    async importKey(format, key) {
        let isPublic = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : true;
        await this._setup();
        try {
            let ret;
            if (format === "jwk") {
                if (key instanceof ArrayBuffer || key instanceof Uint8Array) {
                    throw new Error("Invalid jwk key format");
                }
                ret = await this._importJWK(key, isPublic);
            } else {
                if (key instanceof ArrayBuffer) {
                    ret = new Uint8Array(key);
                } else if (key instanceof Uint8Array) {
                    ret = key;
                } else {
                    throw new Error("Invalid key format");
                }
            }
            if (isPublic && ret.byteLength !== this.publicKeySize) {
                throw new Error("Invalid length of the key");
            }
            if (!isPublic && ret.byteLength !== this.privateKeySize) {
                throw new Error("Invalid length of the key");
            }
            return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["XCryptoKey"](this.name, ret, isPublic ? "public" : "private", isPublic ? [] : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$interfaces$2f$dhkemPrimitives$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KEM_USAGES"]);
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DeserializeError"](e);
        }
    }
    async encap(params) {
        let ekm = undefined;
        if (params.ekm !== undefined) {
            if (params.ekm instanceof ArrayBuffer) {
                ekm = new Uint8Array(params.ekm);
            } else if (params.ekm instanceof Uint8Array) {
                ekm = params.ekm;
            } else {
                throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("ekm must be 32 bytes in length");
            }
        }
        const pk = new Uint8Array(await this.serializePublicKey(params.recipientPublicKey));
        if (pk.byteLength !== this.publicKeySize) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Invalid length of recipientKey");
        }
        try {
            const [ct, ss] = await this._prim.encap(pk, ekm);
            return {
                sharedSecret: ss.buffer,
                enc: ct.buffer
            };
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EncapError"](e);
        }
    }
    async decap(params) {
        const rSk = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["isCryptoKeyPair"])(params.recipientKey) ? params.recipientKey.privateKey : params.recipientKey;
        if (params.enc.byteLength !== this.encSize) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Invalid length of enc");
        }
        const ct = new Uint8Array(params.enc);
        const sk = new Uint8Array(await this.serializePrivateKey(rSk));
        if (sk.byteLength !== this.privateKeySize) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["InvalidParamError"]("Invalid length of recipientKey");
        }
        try {
            const [_, exSk] = await this._prim.deriveKeyPair(sk);
            return (await this._prim.decap(ct, exSk)).buffer;
        } catch (e) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$errors$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DecapError"](e);
        }
    }
    async _setup() {
        if (this._api !== undefined) {
            return;
        }
        this._api = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["loadCrypto"])();
    }
    _serializePublicKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.type !== "public") {
                reject(new Error("Not public key"));
            }
            if (k.algorithm.name !== this.name) {
                reject(new Error("Invalid algorithm name: ".concat(k.algorithm.name)));
            }
            if (k.key.byteLength !== this.publicKeySize) {
                reject(new Error("Invalid key length: ".concat(k.key.byteLength)));
            }
            resolve(k.key.buffer);
        });
    }
    _deserializePublicKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.byteLength !== this.publicKeySize) {
                reject(new Error("Invalid key length: ".concat(k.byteLength)));
            }
            resolve(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["XCryptoKey"](this.name, new Uint8Array(k), "public"));
        });
    }
    _serializePrivateKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.type !== "private") {
                reject(new Error("Not private key"));
            }
            if (k.algorithm.name !== this.name) {
                reject(new Error("Invalid algorithm name: ".concat(k.algorithm.name)));
            }
            if (k.key.byteLength !== this.privateKeySize) {
                reject(new Error("Invalid key length: ".concat(k.key.byteLength)));
            }
            resolve(k.key.buffer);
        });
    }
    _deserializePrivateKey(k) {
        return new Promise((resolve, reject)=>{
            if (k.byteLength !== this.privateKeySize) {
                reject(new Error("Invalid key length: ".concat(k.byteLength)));
            }
            resolve(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$xCryptoKey$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["XCryptoKey"](this.name, new Uint8Array(k), "private", [
                "deriveBits"
            ]));
        });
    }
    _importJWK(key, isPublic) {
        return new Promise((resolve, reject)=>{
            if (typeof key.kty === "undefined" || key.kty !== "AKP") {
                reject(new Error("Invalid kty: ".concat(key.kty)));
            }
            if (typeof key.alg === "undefined" || key.alg !== this.name) {
                reject(new Error("Invalid alg: ".concat(key.alg)));
            }
            if (!isPublic) {
                if (typeof key.priv === "undefined") {
                    reject(new Error("Invalid key: `priv` not found"));
                }
                if (typeof key.key_ops !== "undefined" && (key.key_ops.length !== 1 || key.key_ops[0] !== "deriveBits")) {
                    reject(new Error("Invalid key: `key_ops` should be ['deriveBits']"));
                }
                resolve((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64UrlToBytes"])(key.priv));
            }
            if (typeof key.priv !== "undefined") {
                reject(new Error("Invalid key: `priv` should not be set"));
            }
            if (typeof key.pub === "undefined") {
                reject(new Error("Invalid key: `pub` not found"));
            }
            if (typeof key.key_ops !== "undefined" && key.key_ops.length > 0) {
                reject(new Error("Invalid key: `key_ops` should not be set"));
            }
            resolve((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$utils$2f$misc$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["base64UrlToBytes"])(key.pub));
        });
    }
    constructor(){
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "name", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: ""
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "auth", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "_prim", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
        Object.defineProperty(this, "_api", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
    }
}
class MlKem512 extends MlKemBase {
    constructor(){
        super();
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].MlKem512
        });
        Object.defineProperty(this, "name", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: "ML-KEM-512"
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 768
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 800
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 64
        });
        Object.defineProperty(this, "auth", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "_prim", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
        this._prim = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem512$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKem512"]();
    }
}
class MlKem768 extends MlKemBase {
    constructor(){
        super();
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].MlKem768
        });
        Object.defineProperty(this, "name", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: "ML-KEM-768"
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 1088
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 1184
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 64
        });
        Object.defineProperty(this, "auth", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "_prim", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
        this._prim = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem768$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKem768"]();
    }
}
class MlKem1024 extends MlKemBase {
    constructor(){
        super();
        Object.defineProperty(this, "id", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$common$2f$esm$2f$src$2f$identifiers$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["KemId"].MlKem1024
        });
        Object.defineProperty(this, "name", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: "ML-KEM-1024"
        });
        Object.defineProperty(this, "secretSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 32
        });
        Object.defineProperty(this, "encSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 1568
        });
        Object.defineProperty(this, "publicKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 1568
        });
        Object.defineProperty(this, "privateKeySize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 64
        });
        Object.defineProperty(this, "auth", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "_prim", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: undefined
        });
        this._prim = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$mlkem$2f$esm$2f$src$2f$mlKem1024$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MlKem1024"]();
    }
}
}),
"[project]/node_modules/@hpke/ml-kem/esm/mod.js [app-client] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$hpke$2f$ml$2d$kem$2f$esm$2f$src$2f$mlKem$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@hpke/ml-kem/esm/src/mlKem.js [app-client] (ecmascript)");
;
}),
"[project]/node_modules/next/navigation.js [app-client] (ecmascript)", ((__turbopack_context__, module, exports) => {

module.exports = __turbopack_context__.r("[project]/node_modules/next/dist/client/components/navigation.js [app-client] (ecmascript)");
}),
]);

//# sourceMappingURL=node_modules_74aeebf7._.js.map